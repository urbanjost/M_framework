<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="M_units module">
    
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>M_units.f90 &ndash; M_units</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">M_units </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>M_units.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="95.9% of total for source files.">637 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/M_units.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">M_units.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_units.html">M_units</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_units.f90.html#src">M_units.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <hr>
<p>()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</p>
<hr>
      <br>
    
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_units.html">M_units</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_units.f90.html#src">M_units.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt;</span>
<a name="ln-2"></a><span class="c">!!##NAME</span>
<a name="ln-3"></a><span class="c">!!    M_units(3fm) - [M_units::INTRO] convert between various physical units</span>
<a name="ln-4"></a><span class="c">!!    (LICENSE:MIT)</span>
<a name="ln-5"></a><span class="c">!!</span>
<a name="ln-6"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7"></a><span class="c">!!</span>
<a name="ln-8"></a><span class="c">!!</span>
<a name="ln-9"></a><span class="c">!!    procedure definitions:</span>
<a name="ln-10"></a><span class="c">!!</span>
<a name="ln-11"></a><span class="c">!!       elemental real function c2f(celsius)</span>
<a name="ln-12"></a><span class="c">!!       elemental real function f2c(fahrenheit)</span>
<a name="ln-13"></a><span class="c">!!</span>
<a name="ln-14"></a><span class="c">!!       elemental real|double function r2d(radians)</span>
<a name="ln-15"></a><span class="c">!!       elemental real|double function d2r(degrees)</span>
<a name="ln-16"></a><span class="c">!!</span>
<a name="ln-17"></a><span class="c">!!       elemental real function feet_to_meters(feet)</span>
<a name="ln-18"></a><span class="c">!!       elemental real function meters_to_feet(meters)</span>
<a name="ln-19"></a><span class="c">!!</span>
<a name="ln-20"></a><span class="c">!!       elemental real function sind(angle_in_degrees)</span>
<a name="ln-21"></a><span class="c">!!       elemental real function cosd(angle_in_degrees)</span>
<a name="ln-22"></a><span class="c">!!       elemental real function tand(angle_in_degrees)</span>
<a name="ln-23"></a><span class="c">!!       elemental real function asind(x)</span>
<a name="ln-24"></a><span class="c">!!       elemental real function acosd(x)</span>
<a name="ln-25"></a><span class="c">!!       elemental real function atand(x)</span>
<a name="ln-26"></a><span class="c">!!       elemental real function atan2d(x,y)</span>
<a name="ln-27"></a><span class="c">!!</span>
<a name="ln-28"></a><span class="c">!!       elemental double function norm_angle_rad(radians)</span>
<a name="ln-29"></a><span class="c">!!       elemental real|double function norm_angle_deg(radians)</span>
<a name="ln-30"></a><span class="c">!!</span>
<a name="ln-31"></a><span class="c">!!       subroutine cartesian_to_spherical(x,y,z,radius,inclination,azimuth)</span>
<a name="ln-32"></a><span class="c">!!       subroutine spherical_to_cartesian(radius,inclination,azimuth,x,y,z)</span>
<a name="ln-33"></a><span class="c">!!       subroutine cartesian_to_polar(x,y,radius,inclination)</span>
<a name="ln-34"></a><span class="c">!!       subroutine polar_to_cartesian(radius,inclination,x,y)</span>
<a name="ln-35"></a><span class="c">!!</span>
<a name="ln-36"></a><span class="c">!!##CONSTANTS SYNOPSIS</span>
<a name="ln-37"></a><span class="c">!!</span>
<a name="ln-38"></a><span class="c">!!       function nan()</span>
<a name="ln-39"></a><span class="c">!!       function inf()</span>
<a name="ln-40"></a><span class="c">!!       function is_nan()</span>
<a name="ln-41"></a><span class="c">!!       function is_even()</span>
<a name="ln-42"></a><span class="c">!!</span>
<a name="ln-43"></a><span class="c">!!   Simple constants:</span>
<a name="ln-44"></a><span class="c">!!</span>
<a name="ln-45"></a><span class="c">!!     e,gamma,euler,golden_ratio,pi</span>
<a name="ln-46"></a><span class="c">!!     deg_per_rad, rad_per_deg</span>
<a name="ln-47"></a><span class="c">!!     c__m_per_sec, c__ft_per_sec</span>
<a name="ln-48"></a><span class="c">!!</span>
<a name="ln-49"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-50"></a><span class="c">!!</span>
<a name="ln-51"></a><span class="c">!!    M_units(3fm) is a Fortran module that collects together basic</span>
<a name="ln-52"></a><span class="c">!!    procedures that are used to convert between various physical units</span>
<a name="ln-53"></a><span class="c">!!    and common named constants.</span>
<a name="ln-54"></a><span class="c">!!</span>
<a name="ln-55"></a><span class="c">!!    The input values may be any standard scalar value supported by</span>
<a name="ln-56"></a><span class="c">!!    the anyscalar_to_real(3f) function (real,integer,doubleprecision) within</span>
<a name="ln-57"></a><span class="c">!!    the range allowed by the function.</span>
<a name="ln-58"></a><span class="c">!!</span>
<a name="ln-59"></a><span class="c">!!##PROCEDURES</span>
<a name="ln-60"></a><span class="c">!!</span>
<a name="ln-61"></a><span class="c">!!    Angular Units</span>
<a name="ln-62"></a><span class="c">!!</span>
<a name="ln-63"></a><span class="c">!!     o d2r:  Convert degrees to radians</span>
<a name="ln-64"></a><span class="c">!!     o r2d:  Convert radians to degrees</span>
<a name="ln-65"></a><span class="c">!!</span>
<a name="ln-66"></a><span class="c">!!    Temperature</span>
<a name="ln-67"></a><span class="c">!!</span>
<a name="ln-68"></a><span class="c">!!     o c2f:  Convert Celsius to Fahrenheit</span>
<a name="ln-69"></a><span class="c">!!     o f2c:  Convert Fahrenheit to Celsius</span>
<a name="ln-70"></a><span class="c">!!</span>
<a name="ln-71"></a><span class="c">!!    Distance</span>
<a name="ln-72"></a><span class="c">!!</span>
<a name="ln-73"></a><span class="c">!!     o feet_to_meters:  Convert feet to meters</span>
<a name="ln-74"></a><span class="c">!!     o meters_to_feet:  Convert meters to feet</span>
<a name="ln-75"></a><span class="c">!!</span>
<a name="ln-76"></a><span class="c">!!    REAL trig functions where input is in angular degrees instead of radians</span>
<a name="ln-77"></a><span class="c">!!</span>
<a name="ln-78"></a><span class="c">!!     o elemental real function sind(angle_in_degrees)</span>
<a name="ln-79"></a><span class="c">!!     o elemental real function cosd(angle_in_degrees)</span>
<a name="ln-80"></a><span class="c">!!     o elemental real function tand(angle_in_degrees)</span>
<a name="ln-81"></a><span class="c">!!     o elemental real function asind(x)</span>
<a name="ln-82"></a><span class="c">!!     o elemental real function acosd(x)</span>
<a name="ln-83"></a><span class="c">!!     o elemental real function atand(x)</span>
<a name="ln-84"></a><span class="c">!!     o elemental real function atan2d(x,y)</span>
<a name="ln-85"></a><span class="c">!!</span>
<a name="ln-86"></a><span class="c">!!    Normalize angles into specific ranges</span>
<a name="ln-87"></a><span class="c">!!</span>
<a name="ln-88"></a><span class="c">!!     o elemental double function norm_angle_rad(angle_in_radians)</span>
<a name="ln-89"></a><span class="c">!!     o elemental real|double function norm_angle_deg(angle_in_degrees)</span>
<a name="ln-90"></a><span class="c">!!</span>
<a name="ln-91"></a><span class="c">!!    Coordinates</span>
<a name="ln-92"></a><span class="c">!!</span>
<a name="ln-93"></a><span class="c">!!     o cartesian_to_spherical:  Convert cartesian coordinates to spherical</span>
<a name="ln-94"></a><span class="c">!!     o spherical:  Convert spherical coordinates to cartesian</span>
<a name="ln-95"></a><span class="c">!!     o cartesian_to_polar:  Convert cartesian coordinates to polar</span>
<a name="ln-96"></a><span class="c">!!     o polar:  Convert polar coordinates to cartesian</span>
<a name="ln-97"></a><span class="c">!!</span>
<a name="ln-98"></a><span class="c">!!   Note that your compiler is less likely to inline small procedures in a</span>
<a name="ln-99"></a><span class="c">!!   module than it would statement functions or CONTAINED functions.</span>
<a name="ln-100"></a><span class="c">!!</span>
<a name="ln-101"></a><span class="c">!!##CONSTANTS</span>
<a name="ln-102"></a><span class="c">!!</span>
<a name="ln-103"></a><span class="c">!!   &quot;c__m_per_sec&quot;   Speed of light in a vacuum</span>
<a name="ln-104"></a><span class="c">!!   &quot;c__ft_per_sec&quot;  Speed of light in a vacuum</span>
<a name="ln-105"></a><span class="c">!!   &quot;deg_per_rad&quot;</span>
<a name="ln-106"></a><span class="c">!!   &quot;rad_per_deg&quot;</span>
<a name="ln-107"></a><span class="c">!!   &quot;e&quot;              The base of the natural logarithm system. &quot;e&quot;</span>
<a name="ln-108"></a><span class="c">!!                    was named in honor of Euler, but is known as Napier&#39;s constant.</span>
<a name="ln-109"></a><span class="c">!!   &quot;euler&quot;</span>
<a name="ln-110"></a><span class="c">!!   &quot;gamma&quot;          The Euler-Mascheroni constant is often denoted by</span>
<a name="ln-111"></a><span class="c">!!                    a lower-case Gamma.</span>
<a name="ln-112"></a><span class="c">!!   &quot;golden_ratio&quot;</span>
<a name="ln-113"></a><span class="c">!!</span>
<a name="ln-114"></a><span class="c">!!   &quot;pi&quot;             The ratio of the circumference of a circle to the diameter of the circle</span>
<a name="ln-115"></a><span class="c">!!</span>
<a name="ln-116"></a><span class="c">!!##NOTES</span>
<a name="ln-117"></a><span class="c">!!</span>
<a name="ln-118"></a><span class="c">!!   Gamma is defined as</span>
<a name="ln-119"></a><span class="c">!!</span>
<a name="ln-120"></a><span class="c">!!    Gamma = limit ( M -&gt; Infinity ) ( Sum ( 1 &lt;= N &lt;= M ) 1 / N ) - Log ( M )</span>
<a name="ln-121"></a><span class="c">!!</span>
<a name="ln-122"></a><span class="c">!!##EXAMPLES</span>
<a name="ln-123"></a><span class="c">!!</span>
<a name="ln-124"></a><span class="c">!!   Simple usage example:</span>
<a name="ln-125"></a><span class="c">!!</span>
<a name="ln-126"></a><span class="c">!!    program demo_M_units</span>
<a name="ln-127"></a><span class="c">!!    use M_units, only : r2d, d2r</span>
<a name="ln-128"></a><span class="c">!!    use M_units, only : f2c, c2f</span>
<a name="ln-129"></a><span class="c">!!    use M_units, only : sind, cosd, tand</span>
<a name="ln-130"></a><span class="c">!!    use M_units, only : asind, acosd, atand, atan2d</span>
<a name="ln-131"></a><span class="c">!!    !!</span>
<a name="ln-132"></a><span class="c">!!    use M_units, only : pi8=&gt;pi</span>
<a name="ln-133"></a><span class="c">!!    use M_units, only : e,euler,golden_ratio,deg_per_rad,rad_per_deg</span>
<a name="ln-134"></a><span class="c">!!    use M_units, only : c__m_per_sec, c__ft_per_sec</span>
<a name="ln-135"></a><span class="c">!!    !!</span>
<a name="ln-136"></a><span class="c">!!    implicit none</span>
<a name="ln-137"></a><span class="c">!!    real pi</span>
<a name="ln-138"></a><span class="c">!!    pi=pi8</span>
<a name="ln-139"></a><span class="c">!!    write(*,*)r2d([0.0,PI/4.0,PI/2.0,3.0*PI/2.0,PI])</span>
<a name="ln-140"></a><span class="c">!!    write(*,*)d2r([0.0,45.0,90.0,135.0,180.0])</span>
<a name="ln-141"></a><span class="c">!!    write(*,*)f2c([-40.0,32.0,212.0])</span>
<a name="ln-142"></a><span class="c">!!    write(*,*)c2f([-40.0,0.0,100.0])</span>
<a name="ln-143"></a><span class="c">!!    write(*,*)PI</span>
<a name="ln-144"></a><span class="c">!!    write(*,*)E</span>
<a name="ln-145"></a><span class="c">!!    !!</span>
<a name="ln-146"></a><span class="c">!!    write(*,101) &quot;Napier&#39;s constant (e) is about &quot;,e</span>
<a name="ln-147"></a><span class="c">!!    write(*,101) &quot;The Euler-Mascheroni constant (euler or gamma) is about &quot;,euler</span>
<a name="ln-148"></a><span class="c">!!    write(*,101) &quot;pi (pi) is about &quot;,pi8</span>
<a name="ln-149"></a><span class="c">!!    write(*,101) &quot;The Golden Ratio (golden_ratio) is about &quot;,golden_ratio</span>
<a name="ln-150"></a><span class="c">!!    write(*,101) &quot;Deg_Per_Rad is about &quot;,Deg_Per_Rad</span>
<a name="ln-151"></a><span class="c">!!    write(*,101) &quot;Rad_Per_Deg is about &quot;,Rad_Per_Deg</span>
<a name="ln-152"></a><span class="c">!!    !!</span>
<a name="ln-153"></a><span class="c">!!    write(*,101) &quot;Speed of light in a vacuum (m/sec)       &quot;, c__m_per_sec</span>
<a name="ln-154"></a><span class="c">!!    write(*,101) &quot;Speed of light in a vacuum (ft/sec)      &quot;, c__ft_per_sec</span>
<a name="ln-155"></a><span class="c">!!    !!</span>
<a name="ln-156"></a><span class="c">!!    101 format(a,t57,g0)</span>
<a name="ln-157"></a><span class="c">!!    !!</span>
<a name="ln-158"></a><span class="c">!!    end program demo_M_units</span>
<a name="ln-159"></a><span class="c">!!</span>
<a name="ln-160"></a><span class="c">!!   Results:</span>
<a name="ln-161"></a><span class="c">!!</span>
<a name="ln-162"></a><span class="c">!!    &gt;   0.00000000       45.0000000       90.0000000       270.000000       180.000000</span>
<a name="ln-163"></a><span class="c">!!    &gt;   0.00000000      0.785398185       1.57079637       2.35619450       3.14159274</span>
<a name="ln-164"></a><span class="c">!!    &gt;  -40.0000000       0.00000000       100.000000</span>
<a name="ln-165"></a><span class="c">!!    &gt;  -40.0000000       32.0000000       212.000000</span>
<a name="ln-166"></a><span class="c">!!    &gt;   3.14159274</span>
<a name="ln-167"></a><span class="c">!!    &gt;   2.7182818284590451</span>
<a name="ln-168"></a><span class="c">!!    &gt;Napier&#39;s constant (e) is about                          2.7182818284590451</span>
<a name="ln-169"></a><span class="c">!!    &gt;The Euler-Mascheroni constant (euler or gamma) is about 0.57721566490153287</span>
<a name="ln-170"></a><span class="c">!!    &gt;pi (pi) is about                                        3.1415926535897931</span>
<a name="ln-171"></a><span class="c">!!    &gt;The Golden Ratio (golden_ratio) is about                1.6180339887498949</span>
<a name="ln-172"></a><span class="c">!!    &gt;Deg_Per_Rad is about                                    57.295779513082323</span>
<a name="ln-173"></a><span class="c">!!    &gt;Rad_Per_Deg is about                                    0.17453292519943295E-001</span>
<a name="ln-174"></a><span class="c">!!    &gt;Speed of light in a vacuum (m/sec)                      299792458.00000000</span>
<a name="ln-175"></a><span class="c">!!    &gt;Speed of light in a vacuum (ft/sec)                     983571056.00000000</span>
<a name="ln-176"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-177"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-178"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-179"></a><span class="k">module </span><span class="n">M_units</span>
<a name="ln-180"></a><span class="k">use </span><span class="n">M_anything</span><span class="p">,</span><span class="k">only</span> <span class="p">:</span> <span class="n">anyscalar_to_real</span><span class="p">,</span> <span class="n">anyscalar_to_double</span>
<a name="ln-181"></a><span class="k">implicit none</span>                        <span class="c">! require all variables to be declared</span>
<a name="ln-182"></a><span class="k">private</span>
<a name="ln-183"></a><span class="c">!  common trigonometric functions using degrees instead of radians for units</span>
<a name="ln-184"></a>      <span class="k">public </span><span class="n">sind</span>
<a name="ln-185"></a>      <span class="k">public </span><span class="n">cosd</span>
<a name="ln-186"></a>      <span class="k">public </span><span class="n">tand</span>
<a name="ln-187"></a>      <span class="k">public </span><span class="n">asind</span>
<a name="ln-188"></a>      <span class="k">public </span><span class="n">acosd</span>
<a name="ln-189"></a>      <span class="k">public </span><span class="n">atand</span>
<a name="ln-190"></a>      <span class="k">public </span><span class="n">atan2d</span>
<a name="ln-191"></a><span class="c">!  normalize angles</span>
<a name="ln-192"></a>      <span class="k">public </span><span class="n">norm_angle_rad</span>
<a name="ln-193"></a>      <span class="k">public </span><span class="n">norm_angle_deg</span>
<a name="ln-194"></a><span class="c">!  convert between degrees and radians</span>
<a name="ln-195"></a>      <span class="k">public </span><span class="n">d2r</span>
<a name="ln-196"></a>      <span class="k">public </span><span class="n">r2d</span>
<a name="ln-197"></a><span class="c">!  distance</span>
<a name="ln-198"></a>      <span class="k">public </span><span class="n">feet_to_meters</span>
<a name="ln-199"></a>      <span class="k">public </span><span class="n">meters_to_feet</span>
<a name="ln-200"></a><span class="c">!  weight</span>
<a name="ln-201"></a>      <span class="k">public </span><span class="n">pounds_to_kilograms</span>
<a name="ln-202"></a><span class="c">!  convert between Celsius and Fahrenheit</span>
<a name="ln-203"></a>      <span class="k">public </span><span class="n">f2c</span>
<a name="ln-204"></a>      <span class="k">public </span><span class="n">c2f</span>
<a name="ln-205"></a><span class="c">!  convert between coordinate systems</span>
<a name="ln-206"></a>      <span class="k">public </span><span class="n">cartesian_to_spherical</span>
<a name="ln-207"></a>      <span class="k">public </span><span class="n">spherical_to_cartesian</span>
<a name="ln-208"></a>      <span class="k">public </span><span class="n">cartesian_to_polar</span>
<a name="ln-209"></a>      <span class="k">public </span><span class="n">polar_to_cartesian</span>
<a name="ln-210"></a><span class="c">!  tables</span>
<a name="ln-211"></a>      <span class="k">public </span><span class="n">symbol2atomnum</span> <span class="c">! return atomic number given element symbol name</span>
<a name="ln-212"></a>      <span class="k">public </span><span class="n">atomnum2symbol</span> <span class="c">! return element symbol given atomic number</span>
<a name="ln-213"></a>
<a name="ln-214"></a>      <span class="k">public </span><span class="n">test_suite_M_units</span>
<a name="ln-215"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-216"></a>      <span class="k">public </span><span class="n">is_even</span>
<a name="ln-217"></a>      <span class="k">public </span><span class="n">is_nan</span>
<a name="ln-218"></a>      <span class="k">public </span><span class="n">inf</span>
<a name="ln-219"></a>      <span class="k">interface </span><span class="n">inf</span>
<a name="ln-220"></a>         <span class="k">module procedure </span><span class="n">inf32</span><span class="p">,</span> <span class="n">inf64</span><span class="p">,</span> <span class="n">inf128</span>
<a name="ln-221"></a>      <span class="k">end interface </span><span class="n">inf</span>
<a name="ln-222"></a>
<a name="ln-223"></a>      <span class="k">public </span><span class="n">nan</span>
<a name="ln-224"></a>      <span class="k">interface </span><span class="n">nan</span>
<a name="ln-225"></a>         <span class="k">module procedure </span><span class="n">nan32</span><span class="p">,</span> <span class="n">nan64</span><span class="p">,</span> <span class="n">nan128</span>
<a name="ln-226"></a>      <span class="k">end interface </span><span class="n">nan</span>
<a name="ln-227"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-228"></a><span class="c">!  constants</span>
<a name="ln-229"></a>
<a name="ln-230"></a><span class="n">doubleprecision</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">eighth_circle_rad_d</span>  <span class="o">=</span> <span class="nb">atan</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">)</span>            <span class="c">! pi/4</span>
<a name="ln-231"></a><span class="n">doubleprecision</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">quarter_circle_rad_d</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">eighth_circle_rad_d</span>  <span class="c">! pi/2</span>
<a name="ln-232"></a><span class="n">doubleprecision</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">half_circle_rad_d</span>    <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">eighth_circle_rad_d</span>  <span class="c">! pi</span>
<a name="ln-233"></a><span class="n">doubleprecision</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">circle_rad_d</span>         <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="n">eighth_circle_rad_d</span>  <span class="c">! 2pi</span>
<a name="ln-234"></a>
<a name="ln-235"></a><span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">eighth_circle_rad_r</span>  <span class="o">=</span> <span class="nb">atan</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>              <span class="c">! pi/4</span>
<a name="ln-236"></a><span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">quarter_circle_rad_r</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">eighth_circle_rad_r</span>  <span class="c">! pi/2</span>
<a name="ln-237"></a><span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">half_circle_rad_r</span>    <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">eighth_circle_rad_r</span>  <span class="c">! pi</span>
<a name="ln-238"></a><span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">circle_rad_r</span>         <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="n">eighth_circle_rad_r</span>  <span class="c">! 2pi</span>
<a name="ln-239"></a>
<a name="ln-240"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-241"></a><span class="kt">integer</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">DP</span> <span class="o">=</span> <span class="nb">selected_real_kind</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-242"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">DP</span><span class="p">),</span> <span class="k">public</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span>              <span class="p">&amp;</span>
<a name="ln-243"></a><span class="c">!---------------------!------------------------------------------------------------</span>
<a name="ln-244"></a>                      <span class="c">! velocity of light in a vacuum</span>
<a name="ln-245"></a>   <span class="n">c__m_per_sec</span>       <span class="o">=</span> <span class="mf">2.99792458d+8</span><span class="p">,</span>                                            <span class="p">&amp;</span> <span class="c">! m/sec</span>
<a name="ln-246"></a>   <span class="n">c__ft_per_sec</span>      <span class="o">=</span> <span class="mf">9.83571056d+8</span><span class="p">,</span>                                            <span class="p">&amp;</span> <span class="c">! ft/sec</span>
<a name="ln-247"></a><span class="c">!---------------------!------------------------------------------------------------</span>
<a name="ln-248"></a>                      <span class="c">! &quot;e&quot; is the base of the natural logarithm system.</span>
<a name="ln-249"></a>                      <span class="c">! &quot;e&quot; was named in honor of Euler, but is known as Napier&#39;s constant.</span>
<a name="ln-250"></a>   <span class="n">e</span>                  <span class="o">=</span> <span class="mf">2.71828182845904523536028747135266249775724709369995d+00</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-251"></a><span class="c">!---------------------!------------------------------------------------------------</span>
<a name="ln-252"></a>   <span class="n">euler</span>              <span class="o">=</span> <span class="mf">0.577215664901532860606512090082402431042d+00</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-253"></a><span class="c">!---------------------!------------------------------------------------------------</span>
<a name="ln-254"></a>                      <span class="c">! The Euler-Mascheroni constant is often denoted by a lower-case Gamma.  Gamma is defined as</span>
<a name="ln-255"></a>                      <span class="c">! Gamma = limit ( M -&gt; Infinity ) ( Sum ( 1 &lt;= N &lt;= M ) 1 / N ) - Log ( M )</span>
<a name="ln-256"></a>   <span class="nb">gamma</span>              <span class="o">=</span> <span class="mf">0.577215664901532860606512090082402431042d+00</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-257"></a><span class="c">!---------------------!------------------------------------------------------------</span>
<a name="ln-258"></a>   <span class="n">pi</span>                 <span class="o">=</span> <span class="mf">3.14159265358979323846264338327950288419716939937510d0</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-259"></a><span class="c">!---------------------!------------------------------------------------------------</span>
<a name="ln-260"></a>                      <span class="c">! for two values A+B is to A as A is to B</span>
<a name="ln-261"></a>   <span class="n">Golden_Ratio</span>       <span class="o">=</span> <span class="mf">1.6180339887498948482045868_DP</span><span class="p">,</span>                           <span class="p">&amp;</span>
<a name="ln-262"></a><span class="c">!---------------------!------------------------------------------------------------</span>
<a name="ln-263"></a>   <span class="n">Deg_Per_Rad</span>        <span class="o">=</span> <span class="mi">5</span><span class="mf">7.2957795130823208767981548_DP</span><span class="p">,</span>                          <span class="p">&amp;</span>
<a name="ln-264"></a>   <span class="n">Rad_Per_Deg</span>        <span class="o">=</span> <span class="mf">0.01745329251994329576923691_DP</span><span class="p">,</span>                          <span class="p">&amp;</span>
<a name="ln-265"></a>   <span class="n">degrees_to_radians</span> <span class="o">=</span> <span class="n">PI</span> <span class="o">/</span> <span class="mi">18</span><span class="mf">0.0D+00</span><span class="p">,</span>                                           <span class="p">&amp;</span>
<a name="ln-266"></a><span class="c">!---------------------!------------------------------------------------------------</span>
<a name="ln-267"></a>   <span class="k">end</span><span class="o">=</span><span class="mi">99999</span>    <span class="c">! END OF CONSTANTS</span>
<a name="ln-268"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-269"></a>
<a name="ln-270"></a>   <span class="k">interface </span><span class="n">norm_angle_deg</span>                                  <span class="c">! a Generic Interface in a module with PRIVATE specific procedures</span>
<a name="ln-271"></a>      <span class="k">module procedure </span><span class="n">norm_angle_deg_real</span><span class="p">,</span> <span class="n">norm_angle_deg_double</span>
<a name="ln-272"></a>      <span class="k">module procedure </span><span class="n">norm_angle_deg_integer</span>
<a name="ln-273"></a>   <span class="k">end interface</span>
<a name="ln-274"></a>
<a name="ln-275"></a><span class="k">   interface </span><span class="n">r2d</span>
<a name="ln-276"></a>      <span class="k">module procedure </span><span class="n">r2d_d</span><span class="p">,</span> <span class="n">r2d_r</span><span class="p">,</span> <span class="n">r2d_i</span>
<a name="ln-277"></a>   <span class="k">end interface</span>
<a name="ln-278"></a>
<a name="ln-279"></a><span class="k">   interface </span><span class="n">d2r</span>
<a name="ln-280"></a>      <span class="k">module procedure </span><span class="n">d2r_d</span>
<a name="ln-281"></a>      <span class="k">module procedure </span><span class="n">d2r_r</span>
<a name="ln-282"></a>      <span class="k">module procedure </span><span class="n">d2r_i</span>
<a name="ln-283"></a>   <span class="k">end interface</span>
<a name="ln-284"></a>
<a name="ln-285"></a><span class="k">contains</span>
<a name="ln-286"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-287"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-288"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-289"></a><span class="c">!&gt;</span>
<a name="ln-290"></a><span class="c">!!##NAME</span>
<a name="ln-291"></a><span class="c">!!    c2f(3f) - [M_units:TEMPERATURE] convert Celsius to Fahrenheit</span>
<a name="ln-292"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-293"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-294"></a><span class="c">!!</span>
<a name="ln-295"></a><span class="c">!!    elemental real function c2f(celsius)</span>
<a name="ln-296"></a><span class="c">!!</span>
<a name="ln-297"></a><span class="c">!!     class(*),intent(in) :: celsius</span>
<a name="ln-298"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-299"></a><span class="c">!!    Converts Celsius temperatures to Fahrenheit using the formula:</span>
<a name="ln-300"></a><span class="c">!!</span>
<a name="ln-301"></a><span class="c">!!     fahrenheit=(celsius+40.0)*9.0/5.0 - 40.0</span>
<a name="ln-302"></a><span class="c">!!##OPTIONS</span>
<a name="ln-303"></a><span class="c">!!    celsius    any standard scalar value supported by anyscalar_to_real(3f).</span>
<a name="ln-304"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-305"></a><span class="c">!!</span>
<a name="ln-306"></a><span class="c">!!   Sample program</span>
<a name="ln-307"></a><span class="c">!!</span>
<a name="ln-308"></a><span class="c">!!    program demo_c2f</span>
<a name="ln-309"></a><span class="c">!!    use M_units, only : c2f</span>
<a name="ln-310"></a><span class="c">!!    implicit none</span>
<a name="ln-311"></a><span class="c">!!       write(*,*)&#39;With REAL array input    &#39;, c2f([ -40.0, 0.0, 100.0 ])</span>
<a name="ln-312"></a><span class="c">!!       write(*,*)&#39;With INTEGER array input &#39;, c2f([ -40,   0,   100   ])</span>
<a name="ln-313"></a><span class="c">!!       write(*,*)&#39;With DOUBLEPRECISION     &#39;, c2f(-40.0d0),c2f(0.0d0),c2f(100.0d0)</span>
<a name="ln-314"></a><span class="c">!!    end program demo_c2f</span>
<a name="ln-315"></a><span class="c">!!</span>
<a name="ln-316"></a><span class="c">!!   Results</span>
<a name="ln-317"></a><span class="c">!!</span>
<a name="ln-318"></a><span class="c">!!    With REAL array input      -40.0000000       32.0000000       212.000000</span>
<a name="ln-319"></a><span class="c">!!    With INTEGER array input   -40.0000000       32.0000000       212.000000</span>
<a name="ln-320"></a><span class="c">!!    With DOUBLEPRECISION       -40.0000000       32.0000000       212.000000</span>
<a name="ln-321"></a><span class="c">!!##AUTHOR</span>
<a name="ln-322"></a><span class="c">!!    John S. Urban</span>
<a name="ln-323"></a><span class="c">!!##LICENSE</span>
<a name="ln-324"></a><span class="c">!!    Public Domain</span>
<a name="ln-325"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-326"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">c2f</span><span class="p">(</span><span class="n">celsius</span><span class="p">)</span>
<a name="ln-327"></a><span class="c">! ident_1=&quot;@(#)M_units::c2f(3f): Convert celsius to fahrenheit&quot;</span>
<a name="ln-328"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">celsius</span>        <span class="c">! celsius value to convert to fahrenheit</span>
<a name="ln-329"></a>   <span class="kt">real</span>                       <span class="kd">::</span> <span class="n">celsius_local</span>
<a name="ln-330"></a>   <span class="n">celsius_local</span><span class="o">=</span><span class="n">anyscalar_to_real</span><span class="p">(</span><span class="n">celsius</span><span class="p">)</span>
<a name="ln-331"></a>   <span class="n">c2f</span><span class="o">=</span><span class="p">(</span><span class="n">celsius_local</span><span class="o">+</span><span class="mi">4</span><span class="mf">0.0</span><span class="p">)</span><span class="o">*</span><span class="mf">9.0</span><span class="o">/</span><span class="mf">5.0</span> <span class="o">-</span> <span class="mi">4</span><span class="mf">0.0</span>         <span class="c">! do the conversion</span>
<a name="ln-332"></a><span class="k">end function </span><span class="n">c2f</span>
<a name="ln-333"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-334"></a><span class="c">!&gt;</span>
<a name="ln-335"></a><span class="c">!!##NAME</span>
<a name="ln-336"></a><span class="c">!!    f2c(3f) - [M_units:TEMPERATURE] convert Fahrenheit to Celsius</span>
<a name="ln-337"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-338"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-339"></a><span class="c">!!</span>
<a name="ln-340"></a><span class="c">!!    elemental real function f2c(fahrenheit)</span>
<a name="ln-341"></a><span class="c">!!</span>
<a name="ln-342"></a><span class="c">!!     class(*),intent(in) :: fahrenheit</span>
<a name="ln-343"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-344"></a><span class="c">!!    Converts Fahrenheit temperatures to Celsius using the formula:</span>
<a name="ln-345"></a><span class="c">!!</span>
<a name="ln-346"></a><span class="c">!!     celsius=(fahrenheit+40.0)*5.0/9.0 - 40.0</span>
<a name="ln-347"></a><span class="c">!!##OPTIONS</span>
<a name="ln-348"></a><span class="c">!!    fahrenheit    any standard scalar value supported by anyscalar_to_real(3f).</span>
<a name="ln-349"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-350"></a><span class="c">!!</span>
<a name="ln-351"></a><span class="c">!!   Sample program</span>
<a name="ln-352"></a><span class="c">!!</span>
<a name="ln-353"></a><span class="c">!!    program demo_f2c</span>
<a name="ln-354"></a><span class="c">!!    use M_units, only :  f2c</span>
<a name="ln-355"></a><span class="c">!!    implicit none</span>
<a name="ln-356"></a><span class="c">!!       write(*,*)&#39;With REAL array input    &#39;, f2c([ -40.0,32.0, 212.0 ])</span>
<a name="ln-357"></a><span class="c">!!       write(*,*)&#39;With INTEGER array input &#39;, f2c([ -40,  32,   212   ])</span>
<a name="ln-358"></a><span class="c">!!       write(*,*)&#39;With DOUBLEPRECISION     &#39;, f2c(-40.0d0),f2c(32.0d0),f2c(212.0d0)</span>
<a name="ln-359"></a><span class="c">!!    end program demo_f2c</span>
<a name="ln-360"></a><span class="c">!!</span>
<a name="ln-361"></a><span class="c">!!   Results</span>
<a name="ln-362"></a><span class="c">!!</span>
<a name="ln-363"></a><span class="c">!!    With REAL array input      -40.0000000       0.00000000       100.000000</span>
<a name="ln-364"></a><span class="c">!!    With INTEGER array input   -40.0000000       0.00000000       100.000000</span>
<a name="ln-365"></a><span class="c">!!    With DOUBLEPRECISION       -40.0000000       0.00000000       100.000000</span>
<a name="ln-366"></a><span class="c">!!</span>
<a name="ln-367"></a><span class="c">!!##AUTHOR</span>
<a name="ln-368"></a><span class="c">!!    John S. Urban</span>
<a name="ln-369"></a><span class="c">!!##LICENSE</span>
<a name="ln-370"></a><span class="c">!!    Public Domain</span>
<a name="ln-371"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-372"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">f2c</span><span class="p">(</span><span class="n">fahrenheit</span><span class="p">)</span>
<a name="ln-373"></a><span class="c">! ident_2=&quot;@(#)M_units::f2c(3f): Convert fahrenheit to celsius&quot;</span>
<a name="ln-374"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">fahrenheit</span>     <span class="c">! input fahrenheit to convert to celsius</span>
<a name="ln-375"></a>   <span class="kt">real</span>                       <span class="kd">::</span> <span class="n">fahrenheit_local</span>
<a name="ln-376"></a>   <span class="n">fahrenheit_local</span><span class="o">=</span><span class="n">anyscalar_to_real</span><span class="p">(</span><span class="n">fahrenheit</span><span class="p">)</span>
<a name="ln-377"></a>   <span class="n">f2c</span><span class="o">=</span><span class="p">(</span><span class="n">fahrenheit_local</span><span class="o">+</span><span class="mi">4</span><span class="mf">0.0</span><span class="p">)</span><span class="o">*</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">9.0</span> <span class="o">-</span> <span class="mi">4</span><span class="mf">0.0</span>      <span class="c">! do the conversion</span>
<a name="ln-378"></a><span class="k">end function </span><span class="n">f2c</span>
<a name="ln-379"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-380"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-381"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-382"></a><span class="c">!&gt;</span>
<a name="ln-383"></a><span class="c">!!##NAME</span>
<a name="ln-384"></a><span class="c">!!    r2d(3f) - [M_units:TRIGONOMETRY] convert radians to degrees</span>
<a name="ln-385"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-386"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-387"></a><span class="c">!!</span>
<a name="ln-388"></a><span class="c">!!    elemental real function r2d(radians)</span>
<a name="ln-389"></a><span class="c">!!</span>
<a name="ln-390"></a><span class="c">!!     class(*),intent(in) :: degrees</span>
<a name="ln-391"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-392"></a><span class="c">!!    Converts radians to degrees using the formula:</span>
<a name="ln-393"></a><span class="c">!!</span>
<a name="ln-394"></a><span class="c">!!     degrees=real(radians * 180.d0 / acos(-1.0d0))</span>
<a name="ln-395"></a><span class="c">!!##OPTIONS</span>
<a name="ln-396"></a><span class="c">!!    radians    any standard scalar value supported by anyscalar_to_real(3f).</span>
<a name="ln-397"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-398"></a><span class="c">!!</span>
<a name="ln-399"></a><span class="c">!!   Sample program</span>
<a name="ln-400"></a><span class="c">!!</span>
<a name="ln-401"></a><span class="c">!!    program demo_r2d</span>
<a name="ln-402"></a><span class="c">!!    use M_units, only :  r2d</span>
<a name="ln-403"></a><span class="c">!!    use M_units, only : pi8=&gt;pi</span>
<a name="ln-404"></a><span class="c">!!    implicit none</span>
<a name="ln-405"></a><span class="c">!!    real :: pi=real(pi8)</span>
<a name="ln-406"></a><span class="c">!!       write(*,*)&#39;With REAL array input    &#39;, r2d([ 0.0, PI/4.0, PI/2.0, 3.0*PI/2.0, PI ])</span>
<a name="ln-407"></a><span class="c">!!       write(*,*)&#39;With INTEGER array input &#39;, r2d([0,1,2,3,4])</span>
<a name="ln-408"></a><span class="c">!!       write(*,*)&#39;With DOUBLEPRECISION     &#39;, r2d(0.0d0),r2d(PI/4.0d0),r2d(PI/2.0d0),r2d(3.0d0*PI/2.0d0),r2d(PI)</span>
<a name="ln-409"></a><span class="c">!!    end program demo_r2d</span>
<a name="ln-410"></a><span class="c">!!</span>
<a name="ln-411"></a><span class="c">!!   Results</span>
<a name="ln-412"></a><span class="c">!!</span>
<a name="ln-413"></a><span class="c">!!     With REAL array input       0.00000000       45.0000000       90.0000000       270.000000       180.000000</span>
<a name="ln-414"></a><span class="c">!!     With INTEGER array input    0.00000000       57.2957802       114.591560       171.887344       229.183121</span>
<a name="ln-415"></a><span class="c">!!     With DOUBLEPRECISION        0.00000000       45.0000000       90.0000000       270.000000       180.000000</span>
<a name="ln-416"></a><span class="c">!!##AUTHOR</span>
<a name="ln-417"></a><span class="c">!!    John S. Urban</span>
<a name="ln-418"></a><span class="c">!!##LICENSE</span>
<a name="ln-419"></a><span class="c">!!    Public Domain</span>
<a name="ln-420"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-421"></a><span class="k">elemental </span><span class="n">doubleprecision</span> <span class="k">function </span><span class="n">r2d_i</span><span class="p">(</span><span class="n">iradians</span><span class="p">)</span>
<a name="ln-422"></a>
<a name="ln-423"></a><span class="c">! ident_3=&quot;@(#)M_units::r2d_i(3f): Convert radians to degrees&quot;</span>
<a name="ln-424"></a>
<a name="ln-425"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">DEGREE</span><span class="o">=</span><span class="mf">0.017453292519943d0</span> <span class="c">! radians</span>
<a name="ln-426"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">iradians</span>        <span class="c">! input radians to convert to degrees</span>
<a name="ln-427"></a>   <span class="n">r2d_i</span><span class="o">=</span><span class="nb">dble</span><span class="p">(</span><span class="n">iradians</span><span class="p">)</span><span class="o">/</span><span class="n">DEGREE</span> <span class="c">! do the conversion</span>
<a name="ln-428"></a><span class="k">end function </span><span class="n">r2d_i</span>
<a name="ln-429"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-430"></a><span class="k">elemental </span><span class="n">doubleprecision</span> <span class="k">function </span><span class="n">r2d_d</span><span class="p">(</span><span class="n">radians</span><span class="p">)</span>
<a name="ln-431"></a>
<a name="ln-432"></a><span class="c">! ident_4=&quot;@(#)M_units::r2d_d(3f): Convert radians to degrees&quot;</span>
<a name="ln-433"></a>
<a name="ln-434"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">DEGREE</span><span class="o">=</span><span class="mf">0.017453292519943d0</span> <span class="c">! radians</span>
<a name="ln-435"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">radians</span>        <span class="c">! input radians to convert to degrees</span>
<a name="ln-436"></a>   <span class="n">r2d_d</span><span class="o">=</span><span class="n">radians</span> <span class="o">/</span> <span class="n">DEGREE</span> <span class="c">! do the conversion</span>
<a name="ln-437"></a><span class="k">end function </span><span class="n">r2d_d</span>
<a name="ln-438"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-439"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">r2d_r</span><span class="p">(</span><span class="n">radians</span><span class="p">)</span>
<a name="ln-440"></a>
<a name="ln-441"></a><span class="c">! ident_5=&quot;@(#)M_units::r2d_r(3f): Convert radians to degrees&quot;</span>
<a name="ln-442"></a>
<a name="ln-443"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">DEGREE</span><span class="o">=</span><span class="mf">0.017453292519943d0</span> <span class="c">! radians</span>
<a name="ln-444"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">radians</span>        <span class="c">! input radians to convert to degrees</span>
<a name="ln-445"></a>   <span class="n">r2d_r</span><span class="o">=</span><span class="n">radians</span> <span class="o">/</span> <span class="n">DEGREE</span> <span class="c">! do the conversion</span>
<a name="ln-446"></a><span class="k">end function </span><span class="n">r2d_r</span>
<a name="ln-447"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-448"></a><span class="c">!&gt;</span>
<a name="ln-449"></a><span class="c">!!##NAME</span>
<a name="ln-450"></a><span class="c">!!    d2r(3f) - [M_units:TRIGONOMETRY] convert degrees to radians</span>
<a name="ln-451"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-452"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-453"></a><span class="c">!!</span>
<a name="ln-454"></a><span class="c">!!    elemental real function d2r(degrees)</span>
<a name="ln-455"></a><span class="c">!!</span>
<a name="ln-456"></a><span class="c">!!     class(*),intent(in) :: radians</span>
<a name="ln-457"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-458"></a><span class="c">!!    Converts degrees to radians using the formula:</span>
<a name="ln-459"></a><span class="c">!!</span>
<a name="ln-460"></a><span class="c">!!     radians=real(degrees*acos(-1.0d0)/180.d0)</span>
<a name="ln-461"></a><span class="c">!!##OPTIONS</span>
<a name="ln-462"></a><span class="c">!!    degrees    any standard scalar value supported by anyscalar_to_real(3f).</span>
<a name="ln-463"></a><span class="c">!!               This includes REAL, INTEGER, DOUBLEPRECISION, ... .</span>
<a name="ln-464"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-465"></a><span class="c">!!</span>
<a name="ln-466"></a><span class="c">!!   Sample program</span>
<a name="ln-467"></a><span class="c">!!</span>
<a name="ln-468"></a><span class="c">!!    program demo_d2r</span>
<a name="ln-469"></a><span class="c">!!    use M_units, only :  d2r</span>
<a name="ln-470"></a><span class="c">!!    implicit none</span>
<a name="ln-471"></a><span class="c">!!       write(*,*)&#39;With REAL array input    &#39;, d2r([0.0,45.0,90.0,135.0,180.0])</span>
<a name="ln-472"></a><span class="c">!!       write(*,*)&#39;With INTEGER array input &#39;, d2r([0,  45,  90,  135,  180  ])</span>
<a name="ln-473"></a><span class="c">!!       write(*,*)&#39;With DOUBLEPRECISION     &#39;, &amp;</span>
<a name="ln-474"></a><span class="c">!!       &amp; d2r(0.0d0),d2r(45.0d0),d2r(90.0d0),d2r(135.0d0),d2r(180.0d0)</span>
<a name="ln-475"></a><span class="c">!!    end program demo_d2r</span>
<a name="ln-476"></a><span class="c">!!</span>
<a name="ln-477"></a><span class="c">!!   Results</span>
<a name="ln-478"></a><span class="c">!!</span>
<a name="ln-479"></a><span class="c">!!    With REAL array input    0.00000 0.785398185 1.57079637 2.35619450 3.14159274</span>
<a name="ln-480"></a><span class="c">!!    With INTEGER array input 0.00000 0.785398185 1.57079637 2.35619450 3.14159274</span>
<a name="ln-481"></a><span class="c">!!    With DOUBLEPRECISION     0.00000 0.785398185 1.57079637 2.35619450 3.14159274</span>
<a name="ln-482"></a><span class="c">!!</span>
<a name="ln-483"></a><span class="c">!!##AUTHOR</span>
<a name="ln-484"></a><span class="c">!!    John S. Urban</span>
<a name="ln-485"></a><span class="c">!!##LICENSE</span>
<a name="ln-486"></a><span class="c">!!    Public Domain</span>
<a name="ln-487"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-488"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">d2r_r</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span>
<a name="ln-489"></a>
<a name="ln-490"></a><span class="c">! ident_6=&quot;@(#)M_units::d2r_r(3f): Convert degrees to radians&quot;</span>
<a name="ln-491"></a>
<a name="ln-492"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">RADIAN</span><span class="o">=</span><span class="mi">5</span><span class="mf">7.2957795131d0</span> <span class="c">! degrees</span>
<a name="ln-493"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">degrees</span>                <span class="c">! input degrees to convert to radians</span>
<a name="ln-494"></a>   <span class="n">d2r_r</span><span class="o">=</span><span class="nb">dble</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span><span class="o">/</span><span class="n">RADIAN</span>                       <span class="c">! do the unit conversion</span>
<a name="ln-495"></a><span class="k">end function </span><span class="n">d2r_r</span>
<a name="ln-496"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-497"></a><span class="k">elemental </span><span class="n">doubleprecision</span> <span class="k">function </span><span class="n">d2r_d</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span>
<a name="ln-498"></a>
<a name="ln-499"></a><span class="c">! ident_7=&quot;@(#)M_units::d2r_d(3f): Convert degrees to radians&quot;</span>
<a name="ln-500"></a>
<a name="ln-501"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">RADIAN</span><span class="o">=</span><span class="mi">5</span><span class="mf">7.2957795131d0</span> <span class="c">! degrees</span>
<a name="ln-502"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">degrees</span>               <span class="c">! input degrees to convert to radians</span>
<a name="ln-503"></a>   <span class="n">d2r_d</span><span class="o">=</span><span class="n">degrees</span><span class="o">/</span><span class="n">RADIAN</span>                             <span class="c">! do the unit conversion</span>
<a name="ln-504"></a><span class="k">end function </span><span class="n">d2r_d</span>
<a name="ln-505"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-506"></a><span class="k">elemental </span><span class="n">doubleprecision</span> <span class="k">function </span><span class="n">d2r_i</span><span class="p">(</span><span class="n">idegrees</span><span class="p">)</span>
<a name="ln-507"></a>
<a name="ln-508"></a><span class="c">! ident_8=&quot;@(#)M_units::d2r_i(3f): Convert degrees to radians&quot;</span>
<a name="ln-509"></a>
<a name="ln-510"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">RADIAN</span><span class="o">=</span><span class="mi">5</span><span class="mf">7.2957795131d0</span> <span class="c">! degrees</span>
<a name="ln-511"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">idegrees</span>                      <span class="c">! input degrees to convert to radians</span>
<a name="ln-512"></a>   <span class="n">d2r_i</span><span class="o">=</span><span class="nb">dble</span><span class="p">(</span><span class="n">idegrees</span><span class="p">)</span><span class="o">/</span><span class="n">RADIAN</span>                      <span class="c">! do the unit conversion</span>
<a name="ln-513"></a><span class="k">end function </span><span class="n">d2r_i</span>
<a name="ln-514"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-515"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-516"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-517"></a><span class="c">!&gt;</span>
<a name="ln-518"></a><span class="c">!!##NAME</span>
<a name="ln-519"></a><span class="c">!!    sind(3f) - [M_units:TRIGONOMETRY] calculate sine of value in degrees</span>
<a name="ln-520"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-521"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-522"></a><span class="c">!!</span>
<a name="ln-523"></a><span class="c">!!    elemental real function sind(degrees)</span>
<a name="ln-524"></a><span class="c">!!</span>
<a name="ln-525"></a><span class="c">!!     class(*),intent(in) :: degrees</span>
<a name="ln-526"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-527"></a><span class="c">!!    Calculate sine of input value in degrees</span>
<a name="ln-528"></a><span class="c">!!</span>
<a name="ln-529"></a><span class="c">!!##OPTIONS</span>
<a name="ln-530"></a><span class="c">!!    degrees    any standard scalar value supported by anyscalar_to_double(3f)</span>
<a name="ln-531"></a><span class="c">!!</span>
<a name="ln-532"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-533"></a><span class="c">!!</span>
<a name="ln-534"></a><span class="c">!!   Sample program</span>
<a name="ln-535"></a><span class="c">!!</span>
<a name="ln-536"></a><span class="c">!!    program demo_sind</span>
<a name="ln-537"></a><span class="c">!!    use M_units, only :  sind</span>
<a name="ln-538"></a><span class="c">!!    implicit none</span>
<a name="ln-539"></a><span class="c">!!       write(*,*)&#39;With REAL array input    &#39;, sind([ 0.0, 15.0, 30.0, 45.0, &amp;</span>
<a name="ln-540"></a><span class="c">!!                                            &amp; 60.0, 75.0, 90.0, 180.0, 270.0 ])</span>
<a name="ln-541"></a><span class="c">!!       write(*,*)&#39;With INTEGER array input &#39;, sind([0,15,30,45,60,75,90,180,270])</span>
<a name="ln-542"></a><span class="c">!!       write(*,*)&#39;With DOUBLEPRECISION     &#39;,           &amp;</span>
<a name="ln-543"></a><span class="c">!!          &amp; sind(0.0d0),sind(15.0d0),sind(90.0/3.0d0),  &amp;</span>
<a name="ln-544"></a><span class="c">!!          &amp; sind(90.0/2.0d0),sind(60.0d0),sind(75.0d0), &amp;</span>
<a name="ln-545"></a><span class="c">!!          &amp; sind(90.0d0),sind(180.0d0),sind(270.0d0)</span>
<a name="ln-546"></a><span class="c">!!    end program demo_sind</span>
<a name="ln-547"></a><span class="c">!!</span>
<a name="ln-548"></a><span class="c">!!   Results</span>
<a name="ln-549"></a><span class="c">!!</span>
<a name="ln-550"></a><span class="c">!!    With REAL array input      0.00000000      0.258819044      0.500000000</span>
<a name="ln-551"></a><span class="c">!!                               0.707106829     0.866025448      0.965925813</span>
<a name="ln-552"></a><span class="c">!!                               1.00000000     -8.74227766E-08  -1.00000000</span>
<a name="ln-553"></a><span class="c">!!    With INTEGER array input   0.00000000      0.258819044      0.500000000</span>
<a name="ln-554"></a><span class="c">!!                               0.707106829     0.866025448      0.965925813</span>
<a name="ln-555"></a><span class="c">!!                               1.00000000      -8.74227766E-08  -1.00000000</span>
<a name="ln-556"></a><span class="c">!!    With DOUBLEPRECISION       0.00000000      0.258819044      0.500000000</span>
<a name="ln-557"></a><span class="c">!!                               0.707106829     0.866025448      0.965925813</span>
<a name="ln-558"></a><span class="c">!!                               1.00000000      -8.74227766E-08  -1.00000000</span>
<a name="ln-559"></a><span class="c">!!</span>
<a name="ln-560"></a><span class="c">!!##AUTHOR</span>
<a name="ln-561"></a><span class="c">!!    John S. Urban</span>
<a name="ln-562"></a><span class="c">!!##LICENSE</span>
<a name="ln-563"></a><span class="c">!!    Public Domain</span>
<a name="ln-564"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-565"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">sind</span><span class="p">(</span><span class="n">angle_in_degrees</span><span class="p">)</span>
<a name="ln-566"></a>
<a name="ln-567"></a><span class="c">! ident_9=&quot;@(#)M_units::sind(3f): sin(3f) with degrees as input instead of radians&quot;</span>
<a name="ln-568"></a>
<a name="ln-569"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">angle_in_degrees</span>
<a name="ln-570"></a><span class="kt">real</span>                 <span class="kd">::</span> <span class="n">angle_in_degrees_local</span>
<a name="ln-571"></a>   <span class="n">angle_in_degrees_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">angle_in_degrees</span><span class="p">)</span>
<a name="ln-572"></a>   <span class="n">sind</span><span class="o">=</span><span class="nb">sin</span><span class="p">(</span><span class="n">angle_in_degrees_local</span><span class="o">*</span><span class="n">degrees_to_radians</span><span class="p">)</span>
<a name="ln-573"></a><span class="k">end function </span><span class="n">sind</span>
<a name="ln-574"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-575"></a><span class="c">!&gt;</span>
<a name="ln-576"></a><span class="c">!!##NAME</span>
<a name="ln-577"></a><span class="c">!!    cosd(3f) - [M_units:TRIGONOMETRY] calculate cosine of value in degrees</span>
<a name="ln-578"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-579"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-580"></a><span class="c">!!</span>
<a name="ln-581"></a><span class="c">!!    elemental real function cosd(degrees)</span>
<a name="ln-582"></a><span class="c">!!</span>
<a name="ln-583"></a><span class="c">!!     class(*),intent(in) :: degrees</span>
<a name="ln-584"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-585"></a><span class="c">!!    Calculate cosine of input value in degrees</span>
<a name="ln-586"></a><span class="c">!!</span>
<a name="ln-587"></a><span class="c">!!##OPTIONS</span>
<a name="ln-588"></a><span class="c">!!    degrees    any standard scalar value supported by anyscalar_to_double(3f).</span>
<a name="ln-589"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-590"></a><span class="c">!!</span>
<a name="ln-591"></a><span class="c">!!   Sample program</span>
<a name="ln-592"></a><span class="c">!!</span>
<a name="ln-593"></a><span class="c">!!    program demo_cosd</span>
<a name="ln-594"></a><span class="c">!!    use M_units, only :  cosd</span>
<a name="ln-595"></a><span class="c">!!    implicit none</span>
<a name="ln-596"></a><span class="c">!!       write(*,*)&#39;With REAL array input    &#39;, &amp;</span>
<a name="ln-597"></a><span class="c">!!       &amp; cosd([ 0.0, 15.0, 30.0, 45.0, 60.0, 75.0, 90.0, 180.0, 270.0 ])</span>
<a name="ln-598"></a><span class="c">!!       write(*,*)&#39;With INTEGER array input &#39;,  &amp;</span>
<a name="ln-599"></a><span class="c">!!       &amp; cosd([0,15,30,45,60,75,90,180,270])</span>
<a name="ln-600"></a><span class="c">!!       write(*,*)&#39;With DOUBLEPRECISION     &#39;,        &amp;</span>
<a name="ln-601"></a><span class="c">!!       &amp; cosd(0.0d0),cosd(15.0d0),cosd(90.0/3.0d0),  &amp;</span>
<a name="ln-602"></a><span class="c">!!       &amp; cosd(90.0/2.0d0),cosd(60.0d0),cosd(75.0d0), &amp;</span>
<a name="ln-603"></a><span class="c">!!       &amp; cosd(90.0d0),cosd(180.0d0),cosd(270.0d0)</span>
<a name="ln-604"></a><span class="c">!!    end program demo_cosd</span>
<a name="ln-605"></a><span class="c">!!</span>
<a name="ln-606"></a><span class="c">!!   Results</span>
<a name="ln-607"></a><span class="c">!!</span>
<a name="ln-608"></a><span class="c">!!     With REAL array input      1.00000000       0.965925813   0.866025448</span>
<a name="ln-609"></a><span class="c">!!                                0.707106769      0.499999970   0.258819073</span>
<a name="ln-610"></a><span class="c">!!                               -4.37113883E-08  -1.00000000    1.19248806E-08</span>
<a name="ln-611"></a><span class="c">!!     With INTEGER array input   1.00000000       0.965925813   0.866025448</span>
<a name="ln-612"></a><span class="c">!!                                0.707106769      0.499999970   0.258819073</span>
<a name="ln-613"></a><span class="c">!!                               -4.37113883E-08  -1.00000000    1.19248806E-08</span>
<a name="ln-614"></a><span class="c">!!     With DOUBLEPRECISION       1.00000000       0.965925813   0.866025448</span>
<a name="ln-615"></a><span class="c">!!                                0.707106769      0.499999970   0.258819073</span>
<a name="ln-616"></a><span class="c">!!                               -4.37113883E-08  -1.00000000    1.19248806E-08</span>
<a name="ln-617"></a><span class="c">!!</span>
<a name="ln-618"></a><span class="c">!!##AUTHOR</span>
<a name="ln-619"></a><span class="c">!!    John S. Urban</span>
<a name="ln-620"></a><span class="c">!!##LICENSE</span>
<a name="ln-621"></a><span class="c">!!    Public Domain</span>
<a name="ln-622"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-623"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">cosd</span><span class="p">(</span><span class="n">angle_in_degrees</span><span class="p">)</span>
<a name="ln-624"></a>
<a name="ln-625"></a><span class="c">! ident_10=&quot;@(#)M_units::cosd(3f): cos(3f) with degrees as input instead of radians&quot;</span>
<a name="ln-626"></a>
<a name="ln-627"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">angle_in_degrees</span>
<a name="ln-628"></a><span class="kt">real</span>                <span class="kd">::</span> <span class="n">angle_in_degrees_local</span>
<a name="ln-629"></a>   <span class="n">angle_in_degrees_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">angle_in_degrees</span><span class="p">)</span>
<a name="ln-630"></a>   <span class="n">cosd</span><span class="o">=</span><span class="nb">cos</span><span class="p">(</span><span class="n">angle_in_degrees_local</span><span class="o">*</span><span class="n">degrees_to_radians</span><span class="p">)</span>
<a name="ln-631"></a><span class="k">end function </span><span class="n">cosd</span>
<a name="ln-632"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-633"></a><span class="c">!&gt;</span>
<a name="ln-634"></a><span class="c">!!##NAME</span>
<a name="ln-635"></a><span class="c">!!    tand(3f) - [M_units:TRIGONOMETRY] calculate tangent of value in degrees</span>
<a name="ln-636"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-637"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-638"></a><span class="c">!!</span>
<a name="ln-639"></a><span class="c">!! elemental real function tand(degrees)</span>
<a name="ln-640"></a><span class="c">!!</span>
<a name="ln-641"></a><span class="c">!!     class(*),intent(in) :: degrees</span>
<a name="ln-642"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-643"></a><span class="c">!!    Calculate tangent of input value in degrees</span>
<a name="ln-644"></a><span class="c">!!</span>
<a name="ln-645"></a><span class="c">!!##OPTIONS</span>
<a name="ln-646"></a><span class="c">!!    degrees    any standard scalar value supported by anyscalar_to_double(3f).</span>
<a name="ln-647"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-648"></a><span class="c">!!</span>
<a name="ln-649"></a><span class="c">!!   Sample program</span>
<a name="ln-650"></a><span class="c">!!</span>
<a name="ln-651"></a><span class="c">!!    program demo_tand</span>
<a name="ln-652"></a><span class="c">!!    use M_units, only :  tand</span>
<a name="ln-653"></a><span class="c">!!    implicit none</span>
<a name="ln-654"></a><span class="c">!!       write(*,*)&#39;With REAL array input    &#39;, &amp;</span>
<a name="ln-655"></a><span class="c">!!         &amp; tand([ 0.0, 15.0, 30.0, 45.0, 60.0, 75.0, 90.0, 180.0, 270.0 ])</span>
<a name="ln-656"></a><span class="c">!!       write(*,*)&#39;With INTEGER array input &#39;, &amp;</span>
<a name="ln-657"></a><span class="c">!!         &amp; tand([0,15,30,45,60,75,90,180,270])</span>
<a name="ln-658"></a><span class="c">!!       write(*,*)&#39;With DOUBLEPRECISION     &#39;, &amp;</span>
<a name="ln-659"></a><span class="c">!!         &amp; tand(0.0d0),tand(15.0d0),tand(90.0/3.0d0),tand(90.0/2.0d0),&amp;</span>
<a name="ln-660"></a><span class="c">!!         &amp; tand(60.0d0),tand(75.0d0),&amp;</span>
<a name="ln-661"></a><span class="c">!!         &amp; tand(90.0d0),tand(180.0d0),tand(270.0d0)</span>
<a name="ln-662"></a><span class="c">!!    end program demo_tand</span>
<a name="ln-663"></a><span class="c">!!   Results:</span>
<a name="ln-664"></a><span class="c">!!</span>
<a name="ln-665"></a><span class="c">!!    With REAL array input    0.00000000   0.267949194   0.577350259</span>
<a name="ln-666"></a><span class="c">!!    1.00000000    1.73205078    3.73205090    1.63312395E+16</span>
<a name="ln-667"></a><span class="c">!!    -1.22464685E-16  5.44374649E+15</span>
<a name="ln-668"></a><span class="c">!!    With INTEGER array input  0.00000000   0.267949194   0.577350259</span>
<a name="ln-669"></a><span class="c">!!    1.00000000    1.73205078    3.73205090    1.63312395E+16</span>
<a name="ln-670"></a><span class="c">!!    -1.22464685E-16  5.44374649E+15</span>
<a name="ln-671"></a><span class="c">!!    With DOUBLEPRECISION    0.00000000   0.267949194   0.577350259</span>
<a name="ln-672"></a><span class="c">!!    1.00000000    1.73205078    3.73205090    1.63312395E+16</span>
<a name="ln-673"></a><span class="c">!!    -1.22464685E-16  5.44374649E+15</span>
<a name="ln-674"></a><span class="c">!!</span>
<a name="ln-675"></a><span class="c">!!   Results</span>
<a name="ln-676"></a><span class="c">!!</span>
<a name="ln-677"></a><span class="c">!!##AUTHOR</span>
<a name="ln-678"></a><span class="c">!!    John S. Urban</span>
<a name="ln-679"></a><span class="c">!!##LICENSE</span>
<a name="ln-680"></a><span class="c">!!    Public Domain</span>
<a name="ln-681"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-682"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">tand</span><span class="p">(</span><span class="n">angle_in_degrees</span><span class="p">)</span>
<a name="ln-683"></a>
<a name="ln-684"></a><span class="c">! ident_11=&quot;@(#)M_units::tand(3f): tan(3f) with degrees as input instead of radians&quot;</span>
<a name="ln-685"></a>
<a name="ln-686"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">angle_in_degrees</span>
<a name="ln-687"></a><span class="kt">real</span>                <span class="kd">::</span> <span class="n">angle_in_degrees_local</span>
<a name="ln-688"></a>   <span class="n">angle_in_degrees_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">angle_in_degrees</span><span class="p">)</span>
<a name="ln-689"></a>   <span class="n">tand</span><span class="o">=</span><span class="nb">tan</span><span class="p">(</span><span class="n">angle_in_degrees_local</span><span class="o">*</span><span class="n">degrees_to_radians</span><span class="p">)</span>
<a name="ln-690"></a><span class="k">end function </span><span class="n">tand</span>
<a name="ln-691"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-692"></a><span class="c">!&gt;</span>
<a name="ln-693"></a><span class="c">!!##NAME</span>
<a name="ln-694"></a><span class="c">!!    asind(3f) - [M_units:TRIGONOMETRY] calculate arcsine of value in degrees</span>
<a name="ln-695"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-696"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-697"></a><span class="c">!!</span>
<a name="ln-698"></a><span class="c">!!    elemental real function asind(value)</span>
<a name="ln-699"></a><span class="c">!!</span>
<a name="ln-700"></a><span class="c">!!     class(*),intent(in) :: value</span>
<a name="ln-701"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-702"></a><span class="c">!!    Calculate arcsine of input value in degrees. It converts the input</span>
<a name="ln-703"></a><span class="c">!!    value to radians from degrees and calls asin(3f).</span>
<a name="ln-704"></a><span class="c">!!</span>
<a name="ln-705"></a><span class="c">!!##OPTIONS</span>
<a name="ln-706"></a><span class="c">!!    value    any standard scalar value supported by anyscalar_to_double(3f)</span>
<a name="ln-707"></a><span class="c">!!</span>
<a name="ln-708"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-709"></a><span class="c">!!</span>
<a name="ln-710"></a><span class="c">!!   Sample program</span>
<a name="ln-711"></a><span class="c">!!</span>
<a name="ln-712"></a><span class="c">!!    program demo_asind</span>
<a name="ln-713"></a><span class="c">!!    use M_units, only :  asind</span>
<a name="ln-714"></a><span class="c">!!    implicit none</span>
<a name="ln-715"></a><span class="c">!!       write(*, *)asind([ 0.0, 0.258819044, 0.5, 0.707106829, 0.866025448,  &amp;</span>
<a name="ln-716"></a><span class="c">!!                       &amp; 0.965925813, 1.0, -8.74227766E-08, -1.0 ])</span>
<a name="ln-717"></a><span class="c">!!    end program demo_asind</span>
<a name="ln-718"></a><span class="c">!!</span>
<a name="ln-719"></a><span class="c">!!   Results</span>
<a name="ln-720"></a><span class="c">!!</span>
<a name="ln-721"></a><span class="c">!!       0.0 15.0  30.0 45.0000038  60.00 75.0 90.0 -5.00895612E-06  -90.0</span>
<a name="ln-722"></a><span class="c">!!</span>
<a name="ln-723"></a><span class="c">!!##AUTHOR</span>
<a name="ln-724"></a><span class="c">!!    John S. Urban</span>
<a name="ln-725"></a><span class="c">!!##LICENSE</span>
<a name="ln-726"></a><span class="c">!!    Public Domain</span>
<a name="ln-727"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-728"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">asind</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-729"></a>
<a name="ln-730"></a><span class="c">! ident_12=&quot;@(#)M_units::asind(3f): asin(3f) with degrees as output instead of radians&quot;</span>
<a name="ln-731"></a>
<a name="ln-732"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>
<a name="ln-733"></a><span class="kt">real</span>                <span class="kd">::</span> <span class="n">x_local</span>
<a name="ln-734"></a>   <span class="n">x_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-735"></a>   <span class="n">asind</span><span class="o">=</span><span class="nb">asin</span><span class="p">(</span><span class="n">x_local</span><span class="p">)</span><span class="o">/</span><span class="n">degrees_to_radians</span>
<a name="ln-736"></a><span class="k">end function </span><span class="n">asind</span>
<a name="ln-737"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-738"></a><span class="c">!&gt;</span>
<a name="ln-739"></a><span class="c">!!##NAME</span>
<a name="ln-740"></a><span class="c">!!    acosd(3f) - [M_units:TRIGONOMETRY] calculate arccosine of value in degrees</span>
<a name="ln-741"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-742"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-743"></a><span class="c">!!</span>
<a name="ln-744"></a><span class="c">!!    elemental real function acosd(value)</span>
<a name="ln-745"></a><span class="c">!!</span>
<a name="ln-746"></a><span class="c">!!     class(*),intent(in) :: value</span>
<a name="ln-747"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-748"></a><span class="c">!!    Calculate arcsine of input value in degrees. It converts the input value</span>
<a name="ln-749"></a><span class="c">!!    from degrees to radians and calls acos(3f).</span>
<a name="ln-750"></a><span class="c">!!</span>
<a name="ln-751"></a><span class="c">!!##OPTIONS</span>
<a name="ln-752"></a><span class="c">!!    value    any standard scalar value supported by anyscalar_to_double(3f)</span>
<a name="ln-753"></a><span class="c">!!</span>
<a name="ln-754"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-755"></a><span class="c">!!</span>
<a name="ln-756"></a><span class="c">!!   Sample program</span>
<a name="ln-757"></a><span class="c">!!</span>
<a name="ln-758"></a><span class="c">!!    program demo_acosd</span>
<a name="ln-759"></a><span class="c">!!    use M_units, only :  acosd, cosd</span>
<a name="ln-760"></a><span class="c">!!    implicit none</span>
<a name="ln-761"></a><span class="c">!!       write(*, *)       cosd(0.0),cosd(45.0),cosd(120.0),cosd(180.0),cosd(720.0)</span>
<a name="ln-762"></a><span class="c">!!       write(*, *)acosd([cosd(0.0),cosd(45.0),cosd(120.0),cosd(180.0),cosd(720.0) ])</span>
<a name="ln-763"></a><span class="c">!!    end program demo_acosd</span>
<a name="ln-764"></a><span class="c">!!</span>
<a name="ln-765"></a><span class="c">!!   Results</span>
<a name="ln-766"></a><span class="c">!!</span>
<a name="ln-767"></a><span class="c">!!       1.00000000      0.707106769     -0.500000000      -1.00000000       1.00000000</span>
<a name="ln-768"></a><span class="c">!!       0.00000000       45.0000000       120.000000       180.000000       0.00000000</span>
<a name="ln-769"></a><span class="c">!!</span>
<a name="ln-770"></a><span class="c">!!##AUTHOR</span>
<a name="ln-771"></a><span class="c">!!    John S. Urban</span>
<a name="ln-772"></a><span class="c">!!##LICENSE</span>
<a name="ln-773"></a><span class="c">!!    Public Domain</span>
<a name="ln-774"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-775"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">acosd</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-776"></a>
<a name="ln-777"></a><span class="c">! ident_13=&quot;@(#)M_units::acosd(3f): calculate arc-cos of angle in degrees&quot;</span>
<a name="ln-778"></a>
<a name="ln-779"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>
<a name="ln-780"></a><span class="kt">real</span>                <span class="kd">::</span> <span class="n">x_local</span>
<a name="ln-781"></a>   <span class="n">x_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-782"></a>   <span class="n">acosd</span><span class="o">=</span><span class="nb">acos</span><span class="p">(</span><span class="n">x_local</span><span class="p">)</span><span class="o">/</span><span class="n">degrees_to_radians</span>
<a name="ln-783"></a><span class="k">end function </span><span class="n">acosd</span>
<a name="ln-784"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-785"></a><span class="c">!&gt;</span>
<a name="ln-786"></a><span class="c">!!##NAME</span>
<a name="ln-787"></a><span class="c">!!    atand(3f) - [M_units:TRIGONOMETRY] calculate arctangent of value in degrees</span>
<a name="ln-788"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-789"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-790"></a><span class="c">!!</span>
<a name="ln-791"></a><span class="c">!!    elemental real function atand(value)</span>
<a name="ln-792"></a><span class="c">!!</span>
<a name="ln-793"></a><span class="c">!!     class(*),intent(in) :: value</span>
<a name="ln-794"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-795"></a><span class="c">!!    Calculate arctangent of input value in degrees. It calls atan(3f) and</span>
<a name="ln-796"></a><span class="c">!!    converts the output to degrees from radians.</span>
<a name="ln-797"></a><span class="c">!!</span>
<a name="ln-798"></a><span class="c">!!##OPTIONS</span>
<a name="ln-799"></a><span class="c">!!    value    any standard scalar value supported by anyscalar_to_double(3f)</span>
<a name="ln-800"></a><span class="c">!!</span>
<a name="ln-801"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-802"></a><span class="c">!!</span>
<a name="ln-803"></a><span class="c">!!</span>
<a name="ln-804"></a><span class="c">!!   Sample program:</span>
<a name="ln-805"></a><span class="c">!!</span>
<a name="ln-806"></a><span class="c">!!    program demo_atand</span>
<a name="ln-807"></a><span class="c">!!    use M_units, only :  atand, tand</span>
<a name="ln-808"></a><span class="c">!!    implicit none</span>
<a name="ln-809"></a><span class="c">!!       write(*, *)       tand(0.0),tand(45.0),tand(120.0),tand(180.0),tand(720.0)</span>
<a name="ln-810"></a><span class="c">!!       write(*, *)atand([tand(0.0),tand(45.0),tand(120.0),tand(180.0),tand(720.0) ])</span>
<a name="ln-811"></a><span class="c">!!    end program demo_atand</span>
<a name="ln-812"></a><span class="c">!!</span>
<a name="ln-813"></a><span class="c">!!   Results:</span>
<a name="ln-814"></a><span class="c">!!</span>
<a name="ln-815"></a><span class="c">!!       0.00000000       1.00000000      -1.73205078      -1.22464685E-16  -4.89858741E-16</span>
<a name="ln-816"></a><span class="c">!!       0.00000000       45.0000000      -60.0000000      -7.01670955E-15  -2.80668382E-14</span>
<a name="ln-817"></a><span class="c">!!</span>
<a name="ln-818"></a><span class="c">!!##AUTHOR</span>
<a name="ln-819"></a><span class="c">!!    John S. Urban</span>
<a name="ln-820"></a><span class="c">!!##LICENSE</span>
<a name="ln-821"></a><span class="c">!!    Public Domain</span>
<a name="ln-822"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-823"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">atand</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-824"></a>
<a name="ln-825"></a><span class="c">! ident_14=&quot;@(#)M_units::atand(3f): result is arc-tangent of angle in degrees&quot;</span>
<a name="ln-826"></a>
<a name="ln-827"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>
<a name="ln-828"></a><span class="kt">real</span>                <span class="kd">::</span> <span class="n">x_local</span>
<a name="ln-829"></a>   <span class="n">x_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-830"></a>   <span class="n">atand</span><span class="o">=</span><span class="nb">atan</span><span class="p">(</span><span class="n">x_local</span><span class="p">)</span><span class="o">/</span><span class="n">degrees_to_radians</span>
<a name="ln-831"></a><span class="k">end function </span><span class="n">atand</span>
<a name="ln-832"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-833"></a><span class="c">!&gt;</span>
<a name="ln-834"></a><span class="c">!!##NAME</span>
<a name="ln-835"></a><span class="c">!!    atan2d(3f) - [M_units:TRIGONOMETRY] calculate arctangent of the complex number X + i Y</span>
<a name="ln-836"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-837"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-838"></a><span class="c">!!</span>
<a name="ln-839"></a><span class="c">!!    elemental real function atan2d(x,y)</span>
<a name="ln-840"></a><span class="c">!!</span>
<a name="ln-841"></a><span class="c">!!     class(*),intent(in) :: x</span>
<a name="ln-842"></a><span class="c">!!     class(*),intent(in) :: y</span>
<a name="ln-843"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-844"></a><span class="c">!!    Calculate arctangent of arctangent of the complex number</span>
<a name="ln-845"></a><span class="c">!!</span>
<a name="ln-846"></a><span class="c">!!       X + i Y.</span>
<a name="ln-847"></a><span class="c">!!</span>
<a name="ln-848"></a><span class="c">!!    in degrees. It calls atan2(3f) and converts the output from radians to degrees.</span>
<a name="ln-849"></a><span class="c">!!</span>
<a name="ln-850"></a><span class="c">!!##OPTIONS</span>
<a name="ln-851"></a><span class="c">!!    X    any standard scalar value supported by anyscalar_to_double(3f)</span>
<a name="ln-852"></a><span class="c">!!    Y    any standard scalar value supported by anyscalar_to_double(3f)</span>
<a name="ln-853"></a><span class="c">!!</span>
<a name="ln-854"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-855"></a><span class="c">!!</span>
<a name="ln-856"></a><span class="c">!!        Sample program:</span>
<a name="ln-857"></a><span class="c">!!</span>
<a name="ln-858"></a><span class="c">!!           program demo_atan2d</span>
<a name="ln-859"></a><span class="c">!!           use M_units, only : atan2d</span>
<a name="ln-860"></a><span class="c">!!           real(4) :: x = 1.e0_4, y = 0.5e0_4</span>
<a name="ln-861"></a><span class="c">!!             write(*,*)atan2d(y,x)</span>
<a name="ln-862"></a><span class="c">!!           end program demo_atan2d</span>
<a name="ln-863"></a><span class="c">!!   Results:</span>
<a name="ln-864"></a><span class="c">!!</span>
<a name="ln-865"></a><span class="c">!!       26.5650501</span>
<a name="ln-866"></a><span class="c">!!</span>
<a name="ln-867"></a><span class="c">!!##AUTHOR</span>
<a name="ln-868"></a><span class="c">!!    John S. Urban</span>
<a name="ln-869"></a><span class="c">!!##LICENSE</span>
<a name="ln-870"></a><span class="c">!!    Public Domain</span>
<a name="ln-871"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-872"></a><span class="k">elemental </span><span class="kt">real </span><span class="k">function </span><span class="n">atan2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<a name="ln-873"></a>
<a name="ln-874"></a><span class="c">! ident_15=&quot;@(#)M_units::atan2d(3f): calculate arc-tangent of angle in degrees&quot;</span>
<a name="ln-875"></a>
<a name="ln-876"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>
<a name="ln-877"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">y</span>
<a name="ln-878"></a><span class="kt">real</span>                <span class="kd">::</span> <span class="n">x_local</span>
<a name="ln-879"></a><span class="kt">real</span>                <span class="kd">::</span> <span class="n">y_local</span>
<a name="ln-880"></a>   <span class="n">x_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-881"></a>   <span class="n">y_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="ln-882"></a>   <span class="n">atan2d</span><span class="o">=</span><span class="n">atan2</span><span class="p">(</span><span class="n">x_local</span><span class="p">,</span><span class="n">y_local</span><span class="p">)</span><span class="o">/</span><span class="n">degrees_to_radians</span>
<a name="ln-883"></a><span class="k">end function </span><span class="n">atan2d</span>
<a name="ln-884"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-885"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-886"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-887"></a><span class="c">!&gt;</span>
<a name="ln-888"></a><span class="c">!!##NAME</span>
<a name="ln-889"></a><span class="c">!!    feet_to_meters(3f) - [M_units:LENGTH] converts a measurement in feet to meters</span>
<a name="ln-890"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-891"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-892"></a><span class="c">!!</span>
<a name="ln-893"></a><span class="c">!!    elemental doubleprecision function feet_to_meters(feet)</span>
<a name="ln-894"></a><span class="c">!!</span>
<a name="ln-895"></a><span class="c">!!     class(*),intent(in) :: feet</span>
<a name="ln-896"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-897"></a><span class="c">!!    Converts feet to meters using the formula:</span>
<a name="ln-898"></a><span class="c">!!</span>
<a name="ln-899"></a><span class="c">!!     meters = 0.0254 * 12.0 * feet</span>
<a name="ln-900"></a><span class="c">!!##OPTIONS</span>
<a name="ln-901"></a><span class="c">!!    feet   any standard scalar value supported by anyscalar_to_real(3f).</span>
<a name="ln-902"></a><span class="c">!!           This at least includes REAL, INTEGER, and DOUBLEPRECISION.</span>
<a name="ln-903"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-904"></a><span class="c">!!</span>
<a name="ln-905"></a><span class="c">!!   Sample program</span>
<a name="ln-906"></a><span class="c">!!</span>
<a name="ln-907"></a><span class="c">!!    program demo_feet_to_meters</span>
<a name="ln-908"></a><span class="c">!!    use M_units, only : feet_to_meters</span>
<a name="ln-909"></a><span class="c">!!    implicit none</span>
<a name="ln-910"></a><span class="c">!!       write(*,*)&#39;With REAL array input    &#39;, &amp;</span>
<a name="ln-911"></a><span class="c">!!               &amp; feet_to_meters([ -1.0, 0.0, 1.0 ,1.0/12.0])</span>
<a name="ln-912"></a><span class="c">!!       write(*,*)&#39;With INTEGER array input &#39;, &amp;</span>
<a name="ln-913"></a><span class="c">!!               &amp; feet_to_meters([ -1,   0,   1   ])</span>
<a name="ln-914"></a><span class="c">!!       write(*,*)&#39;With DOUBLEPRECISION     &#39;, &amp;</span>
<a name="ln-915"></a><span class="c">!!               &amp; feet_to_meters(-1.0d0), &amp;</span>
<a name="ln-916"></a><span class="c">!!               &amp; feet_to_meters(0.0d0), &amp;</span>
<a name="ln-917"></a><span class="c">!!               &amp; feet_to_meters(1.0d0)</span>
<a name="ln-918"></a><span class="c">!!    end program demo_feet_to_meters</span>
<a name="ln-919"></a><span class="c">!!</span>
<a name="ln-920"></a><span class="c">!!   Results</span>
<a name="ln-921"></a><span class="c">!!</span>
<a name="ln-922"></a><span class="c">!!     With REAL array input     -0.304800004   0.00000000  0.304800004  2.54000016E-02</span>
<a name="ln-923"></a><span class="c">!!     With INTEGER array input  -0.304800004   0.00000000  0.304800004</span>
<a name="ln-924"></a><span class="c">!!     With DOUBLEPRECISION      -0.304800004   0.00000000  0.304800004</span>
<a name="ln-925"></a><span class="c">!!</span>
<a name="ln-926"></a><span class="c">!!##AUTHOR</span>
<a name="ln-927"></a><span class="c">!!    John S. Urban</span>
<a name="ln-928"></a><span class="c">!!##LICENSE</span>
<a name="ln-929"></a><span class="c">!!    Public Domain</span>
<a name="ln-930"></a><span class="k">elemental function </span><span class="n">feet_to_meters</span><span class="p">(</span><span class="n">feet</span><span class="p">)</span>
<a name="ln-931"></a><span class="c">! ident_16=&quot;@(#)M_units::feet_to_meters(3f): converts a measurement in feet to meters&quot;</span>
<a name="ln-932"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">feet</span>                           <span class="c">! the input length in feet.</span>
<a name="ln-933"></a><span class="n">doubleprecision</span>               <span class="kd">::</span> <span class="n">feet_to_meters</span>                 <span class="c">! OUTPUT, the corresponding length in meters.</span>
<a name="ln-934"></a><span class="n">doubleprecision</span>               <span class="kd">::</span> <span class="n">feet_local</span>
<a name="ln-935"></a>   <span class="n">feet_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">feet</span><span class="p">)</span>
<a name="ln-936"></a>   <span class="c">!!feet_to_meters = 0.0254 * 12.0 * feet_local</span>
<a name="ln-937"></a>   <span class="n">feet_to_meters</span> <span class="o">=</span> <span class="mf">0.3048d0</span> <span class="o">*</span> <span class="n">feet_local</span>
<a name="ln-938"></a>
<a name="ln-939"></a><span class="k">end function </span><span class="n">feet_to_meters</span>
<a name="ln-940"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-941"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-942"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-943"></a><span class="c">!&gt;</span>
<a name="ln-944"></a><span class="c">!!##NAME</span>
<a name="ln-945"></a><span class="c">!!    meters_to_feet(3f) - [M_units:LENGTH] converts a measurement in meters to feet</span>
<a name="ln-946"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-947"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-948"></a><span class="c">!!</span>
<a name="ln-949"></a><span class="c">!!    elemental real function meters_to_feet(meters)</span>
<a name="ln-950"></a><span class="c">!!</span>
<a name="ln-951"></a><span class="c">!!     class(*),intent(in) :: meters</span>
<a name="ln-952"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-953"></a><span class="c">!!    Converts feet to meters using the formula:</span>
<a name="ln-954"></a><span class="c">!!</span>
<a name="ln-955"></a><span class="c">!!     feet= meters/12.0/0.0254</span>
<a name="ln-956"></a><span class="c">!!##OPTIONS</span>
<a name="ln-957"></a><span class="c">!!    feet   any standard scalar value supported by anyscalar_to_real(3f).</span>
<a name="ln-958"></a><span class="c">!!           This at least includes REAL, INTEGER, and DOUBLEPRECISION.</span>
<a name="ln-959"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-960"></a><span class="c">!!</span>
<a name="ln-961"></a><span class="c">!!   Sample program</span>
<a name="ln-962"></a><span class="c">!!</span>
<a name="ln-963"></a><span class="c">!!    program demo_meters_to_feet</span>
<a name="ln-964"></a><span class="c">!!    use M_units, only : meters_to_feet</span>
<a name="ln-965"></a><span class="c">!!    implicit none</span>
<a name="ln-966"></a><span class="c">!!       write(*,*)&#39;With REAL array input    &#39;, meters_to_feet([ -1.0, 0.0, 1.0 ])</span>
<a name="ln-967"></a><span class="c">!!       write(*,*)&#39;With INTEGER array input &#39;, meters_to_feet([ -1,   0,   1   ])</span>
<a name="ln-968"></a><span class="c">!!       write(*,*)&#39;With DOUBLEPRECISION     &#39;, meters_to_feet(-1.0d0),meters_to_feet(0.0d0),meters_to_feet(1.0d0)</span>
<a name="ln-969"></a><span class="c">!!    end program demo_meters_to_feet</span>
<a name="ln-970"></a><span class="c">!!</span>
<a name="ln-971"></a><span class="c">!!   Results</span>
<a name="ln-972"></a><span class="c">!!</span>
<a name="ln-973"></a><span class="c">!!     With REAL array input      -3.28083992       0.00000000       3.28083992</span>
<a name="ln-974"></a><span class="c">!!     With INTEGER array input   -3.28083992       0.00000000       3.28083992</span>
<a name="ln-975"></a><span class="c">!!     With DOUBLEPRECISION       -3.28083992       0.00000000       3.28083992</span>
<a name="ln-976"></a><span class="c">!!</span>
<a name="ln-977"></a><span class="c">!!##AUTHOR</span>
<a name="ln-978"></a><span class="c">!!    John S. Urban</span>
<a name="ln-979"></a><span class="c">!!##LICENSE</span>
<a name="ln-980"></a><span class="c">!!    Public Domain</span>
<a name="ln-981"></a><span class="k">elemental function </span><span class="n">meters_to_feet</span><span class="p">(</span><span class="n">meters</span><span class="p">)</span>
<a name="ln-982"></a><span class="c">! ident_17=&quot;@(#)M_units::meters_to_feet(3f): converts a measurement in meters to feet&quot;</span>
<a name="ln-983"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">meters</span>                         <span class="c">! the input length in meters.</span>
<a name="ln-984"></a><span class="n">doubleprecision</span>               <span class="kd">::</span> <span class="n">meters_to_feet</span>                 <span class="c">! OUTPUT, the corresponding length in feet.</span>
<a name="ln-985"></a>   <span class="n">doubleprecision</span>            <span class="kd">::</span> <span class="n">meters_local</span>
<a name="ln-986"></a>   <span class="n">meters_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">meters</span><span class="p">)</span>
<a name="ln-987"></a>   <span class="n">meters_to_feet</span> <span class="o">=</span> <span class="n">meters_local</span><span class="o">/</span><span class="mi">1</span><span class="mf">2.0d0</span><span class="o">/</span><span class="mf">0.0254d0</span>
<a name="ln-988"></a><span class="k">end function </span><span class="n">meters_to_feet</span>
<a name="ln-989"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-990"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-991"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-992"></a><span class="c">!&gt;</span>
<a name="ln-993"></a><span class="c">!!##NAME</span>
<a name="ln-994"></a><span class="c">!!     cartesian_to_spherical(3f) - [M_units:TRIGONOMETRY] convert Cartesian coordinates to ISO polar coordinates</span>
<a name="ln-995"></a><span class="c">!!     (LICENSE:PD)</span>
<a name="ln-996"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-997"></a><span class="c">!!</span>
<a name="ln-998"></a><span class="c">!!    subroutine cartesian_to_spherical(x,y,z,radius,inclination,azimuth)</span>
<a name="ln-999"></a><span class="c">!!</span>
<a name="ln-1000"></a><span class="c">!!     real,intent(in)  :: x,y,z</span>
<a name="ln-1001"></a><span class="c">!!     real,intent(out) :: radius,inclination,azimuth</span>
<a name="ln-1002"></a><span class="c">!!</span>
<a name="ln-1003"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1004"></a><span class="c">!!</span>
<a name="ln-1005"></a><span class="c">!!     Convert a cartesian point &lt;X,Y,Z&gt; to ISO 8000-2:2009 polar coordinates &lt;radius,</span>
<a name="ln-1006"></a><span class="c">!!     inclination, azimuth&gt; with angles in radians using the formulas</span>
<a name="ln-1007"></a><span class="c">!!</span>
<a name="ln-1008"></a><span class="c">!!       radius=sqrt(x**2+y**2+z**2)</span>
<a name="ln-1009"></a><span class="c">!!       inclination=acos(z/radius)</span>
<a name="ln-1010"></a><span class="c">!!       azimuth=atan2(y,x)</span>
<a name="ln-1011"></a><span class="c">!!</span>
<a name="ln-1012"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1013"></a><span class="c">!!    X  The distance along the x-axis</span>
<a name="ln-1014"></a><span class="c">!!    Y  The distance along the y-axis</span>
<a name="ln-1015"></a><span class="c">!!    Z  The distance along the z-axis</span>
<a name="ln-1016"></a><span class="c">!!</span>
<a name="ln-1017"></a><span class="c">!!##RESULTS</span>
<a name="ln-1018"></a><span class="c">!!</span>
<a name="ln-1019"></a><span class="c">!!    RADIUS       The radial distance from the origin (O) to the point (P)</span>
<a name="ln-1020"></a><span class="c">!!    INCLINATION  The zenith angle in radians between the zenith reference direction</span>
<a name="ln-1021"></a><span class="c">!!                 (z-axis) and the line OP</span>
<a name="ln-1022"></a><span class="c">!!    AZIMUTH      The azimuth angle in radians between the azimuth reference direction</span>
<a name="ln-1023"></a><span class="c">!!                 (x-axis) and the orthogonal projection of the line OP of the</span>
<a name="ln-1024"></a><span class="c">!!                 reference plane (x-y plane).</span>
<a name="ln-1025"></a><span class="c">!!</span>
<a name="ln-1026"></a><span class="c">!!##EXAMPLES</span>
<a name="ln-1027"></a><span class="c">!!</span>
<a name="ln-1028"></a><span class="c">!!   examples of usage</span>
<a name="ln-1029"></a><span class="c">!!</span>
<a name="ln-1030"></a><span class="c">!!    program demo_cartesian_to_spherical</span>
<a name="ln-1031"></a><span class="c">!!    use M_units, only : cartesian_to_spherical</span>
<a name="ln-1032"></a><span class="c">!!    implicit none</span>
<a name="ln-1033"></a><span class="c">!!    real    :: x,y,z</span>
<a name="ln-1034"></a><span class="c">!!    real    :: r,i,a</span>
<a name="ln-1035"></a><span class="c">!!    integer :: ios</span>
<a name="ln-1036"></a><span class="c">!!    INFINITE: do</span>
<a name="ln-1037"></a><span class="c">!!       read(*,*,iostat=ios) x, y, z</span>
<a name="ln-1038"></a><span class="c">!!       if(ios.ne.0)exit INFINITE</span>
<a name="ln-1039"></a><span class="c">!!       call cartesian_to_spherical(x,y,z,r,i,a)</span>
<a name="ln-1040"></a><span class="c">!!       write(*,*)&#39;x=&#39;,x,&#39; y=&#39;,y,&#39; z=&#39;,z,&#39;radius=&#39;,r,&#39;inclination=&#39;,i,&#39;azimuth=&#39;,a</span>
<a name="ln-1041"></a><span class="c">!!    enddo INFINITE</span>
<a name="ln-1042"></a><span class="c">!!    end program demo_cartesian_to_spherical</span>
<a name="ln-1043"></a><span class="c">!!##AUTHOR</span>
<a name="ln-1044"></a><span class="c">!!    John S. Urban</span>
<a name="ln-1045"></a><span class="c">!!##LICENSE</span>
<a name="ln-1046"></a><span class="c">!!    Public Domain</span>
<a name="ln-1047"></a><span class="k">subroutine </span><span class="n">cartesian_to_spherical</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">azimuth</span><span class="p">)</span>
<a name="ln-1048"></a><span class="k">implicit none</span>
<a name="ln-1049"></a><span class="c">! ident_18=&quot;@(#)M_units::cartesian_to_spherical(3f): convert Cartesian coordinates to ISO polar coordinates&quot;</span>
<a name="ln-1050"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span>
<a name="ln-1051"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">azimuth</span>
<a name="ln-1052"></a>   <span class="n">radius</span><span class="o">=</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1053"></a>   <span class="k">if</span><span class="p">(</span><span class="n">radius</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1054"></a><span class="k">      </span><span class="n">inclination</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-1055"></a>      <span class="n">azimuth</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-1056"></a>   <span class="k">else</span>
<a name="ln-1057"></a><span class="k">      </span><span class="n">inclination</span><span class="o">=</span><span class="nb">acos</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">radius</span><span class="p">)</span>
<a name="ln-1058"></a>      <span class="n">azimuth</span><span class="o">=</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-1059"></a>   <span class="k">endif</span>
<a name="ln-1060"></a><span class="k">end subroutine </span><span class="n">cartesian_to_spherical</span>
<a name="ln-1061"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1062"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1063"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1064"></a><span class="c">!&gt;</span>
<a name="ln-1065"></a><span class="c">!!##NAME</span>
<a name="ln-1066"></a><span class="c">!!     spherical_to_cartesian(3f) - [M_units:TRIGONOMETRY] convert ISO polar coordinates to Cartesian coordinates</span>
<a name="ln-1067"></a><span class="c">!!     (LICENSE:PD)</span>
<a name="ln-1068"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1069"></a><span class="c">!!</span>
<a name="ln-1070"></a><span class="c">!!    subroutine spherical_to_cartesian(radius,inclination,azimuth,x,y,z)</span>
<a name="ln-1071"></a><span class="c">!!</span>
<a name="ln-1072"></a><span class="c">!!     real,intent(in) :: radius,inclination,azimuth</span>
<a name="ln-1073"></a><span class="c">!!     real,intent(out)  :: x,y,z</span>
<a name="ln-1074"></a><span class="c">!!</span>
<a name="ln-1075"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1076"></a><span class="c">!!</span>
<a name="ln-1077"></a><span class="c">!!     Convert ISO 8000-2:2009 polar coordinate &lt;radius, inclination, azimuth&gt; with</span>
<a name="ln-1078"></a><span class="c">!!     angles in radians to cartesian point &lt;X,Y,Z&gt; using the formulas</span>
<a name="ln-1079"></a><span class="c">!!</span>
<a name="ln-1080"></a><span class="c">!!       x=radius*sin(inclination)*cos(azimuth)</span>
<a name="ln-1081"></a><span class="c">!!       y=radius*sin(inclination)*sin(azimuth)</span>
<a name="ln-1082"></a><span class="c">!!       z=radius*cos(inclination)</span>
<a name="ln-1083"></a><span class="c">!!</span>
<a name="ln-1084"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1085"></a><span class="c">!!</span>
<a name="ln-1086"></a><span class="c">!!    RADIUS       The radial distance from the origin (O) to the point (P)</span>
<a name="ln-1087"></a><span class="c">!!    INCLINATION  The zenith angle in radians between the zenith reference direction</span>
<a name="ln-1088"></a><span class="c">!!                 (z-axis) and the line OP</span>
<a name="ln-1089"></a><span class="c">!!    AZIMUTH      The azimuth angle in radians between the azimuth reference direction</span>
<a name="ln-1090"></a><span class="c">!!                 (x-axis) and the orthogonal projection of the line OP of the</span>
<a name="ln-1091"></a><span class="c">!!                 reference plane (x-y plane).</span>
<a name="ln-1092"></a><span class="c">!!</span>
<a name="ln-1093"></a><span class="c">!!##RESULTS</span>
<a name="ln-1094"></a><span class="c">!!</span>
<a name="ln-1095"></a><span class="c">!!    X  The distance along the x-axis</span>
<a name="ln-1096"></a><span class="c">!!    Y  The distance along the y-axis</span>
<a name="ln-1097"></a><span class="c">!!    Z  The distance along the z-axis</span>
<a name="ln-1098"></a><span class="c">!!</span>
<a name="ln-1099"></a><span class="c">!!##EXAMPLES</span>
<a name="ln-1100"></a><span class="c">!!</span>
<a name="ln-1101"></a><span class="c">!!   examples of usage</span>
<a name="ln-1102"></a><span class="c">!!</span>
<a name="ln-1103"></a><span class="c">!!    program demo_spherical_to_cartesian</span>
<a name="ln-1104"></a><span class="c">!!    use M_units, only : spherical_to_cartesian</span>
<a name="ln-1105"></a><span class="c">!!    implicit none</span>
<a name="ln-1106"></a><span class="c">!!    real    :: x,y,z</span>
<a name="ln-1107"></a><span class="c">!!    real    :: r,i,a</span>
<a name="ln-1108"></a><span class="c">!!    integer :: ios</span>
<a name="ln-1109"></a><span class="c">!!    INFINITE: do</span>
<a name="ln-1110"></a><span class="c">!!       read(*,*,iostat=ios) x, y, z</span>
<a name="ln-1111"></a><span class="c">!!       if(ios.ne.0)exit INFINITE</span>
<a name="ln-1112"></a><span class="c">!!       call spherical_to_cartesian(r,i,a,x,y,z)</span>
<a name="ln-1113"></a><span class="c">!!       write(*,*)&#39;x=&#39;,x,&#39; y=&#39;,y,&#39; z=&#39;,z,&#39;radius=&#39;,r,&#39;inclination=&#39;,i,&#39;azimuth=&#39;,a</span>
<a name="ln-1114"></a><span class="c">!!    enddo INFINITE</span>
<a name="ln-1115"></a><span class="c">!!    end program demo_spherical_to_cartesian</span>
<a name="ln-1116"></a><span class="c">!!##AUTHOR</span>
<a name="ln-1117"></a><span class="c">!!    John S. Urban</span>
<a name="ln-1118"></a><span class="c">!!##LICENSE</span>
<a name="ln-1119"></a><span class="c">!!    Public Domain</span>
<a name="ln-1120"></a><span class="k">subroutine </span><span class="n">spherical_to_cartesian</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">azimuth</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
<a name="ln-1121"></a><span class="k">implicit none</span>
<a name="ln-1122"></a><span class="c">! ident_19=&quot;@(#)M_units::spherical_to_cartesian(3f): convert spherical coordinates to cartesian coordinates&quot;</span>
<a name="ln-1123"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">azimuth</span>
<a name="ln-1124"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span>
<a name="ln-1125"></a>   <span class="k">if</span><span class="p">(</span><span class="n">radius</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1126"></a><span class="k">      </span><span class="n">x</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-1127"></a>      <span class="n">y</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-1128"></a>      <span class="n">z</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-1129"></a>   <span class="k">else</span>
<a name="ln-1130"></a><span class="k">      </span><span class="n">x</span><span class="o">=</span><span class="n">radius</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">inclination</span><span class="p">)</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span>
<a name="ln-1131"></a>      <span class="n">y</span><span class="o">=</span><span class="n">radius</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">inclination</span><span class="p">)</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span>
<a name="ln-1132"></a>      <span class="n">z</span><span class="o">=</span><span class="n">radius</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">inclination</span><span class="p">)</span>
<a name="ln-1133"></a>   <span class="k">endif</span>
<a name="ln-1134"></a><span class="k">end subroutine </span><span class="n">spherical_to_cartesian</span>
<a name="ln-1135"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1136"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1137"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1138"></a><span class="c">!&gt;</span>
<a name="ln-1139"></a><span class="c">!!##NAME</span>
<a name="ln-1140"></a><span class="c">!!     cartesian_to_polar(3f) - [M_units:TRIGONOMETRY] convert Cartesian coordinates to polar coordinates</span>
<a name="ln-1141"></a><span class="c">!!     (LICENSE:PD)</span>
<a name="ln-1142"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1143"></a><span class="c">!!</span>
<a name="ln-1144"></a><span class="c">!!    subroutine cartesian_to_polar(x,y,radius,inclination)</span>
<a name="ln-1145"></a><span class="c">!!</span>
<a name="ln-1146"></a><span class="c">!!     real,intent(in)  :: y,z</span>
<a name="ln-1147"></a><span class="c">!!     real,intent(out) :: radius,inclination</span>
<a name="ln-1148"></a><span class="c">!!</span>
<a name="ln-1149"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1150"></a><span class="c">!!</span>
<a name="ln-1151"></a><span class="c">!!     Convert a cartesian point &lt;X,Y,Z&gt; to polar coordinates &lt;radius,</span>
<a name="ln-1152"></a><span class="c">!!     inclination&gt; with angles in radians using the formulas</span>
<a name="ln-1153"></a><span class="c">!!</span>
<a name="ln-1154"></a><span class="c">!!       radius=sqrt(x**2+y**2)</span>
<a name="ln-1155"></a><span class="c">!!       inclination=atan2(y,x)</span>
<a name="ln-1156"></a><span class="c">!!</span>
<a name="ln-1157"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1158"></a><span class="c">!!    X  The distance along the x-axis</span>
<a name="ln-1159"></a><span class="c">!!    Y  The distance along the y-axis</span>
<a name="ln-1160"></a><span class="c">!!</span>
<a name="ln-1161"></a><span class="c">!!##RESULTS</span>
<a name="ln-1162"></a><span class="c">!!</span>
<a name="ln-1163"></a><span class="c">!!    RADIUS       The radial distance from the origin (O) to the point (P)</span>
<a name="ln-1164"></a><span class="c">!!    INCLINATION  The inclination angle in radians between the inclination reference direction</span>
<a name="ln-1165"></a><span class="c">!!                 (x-axis) and the orthogonal projection of the line OP of the</span>
<a name="ln-1166"></a><span class="c">!!                 reference plane (x-y plane).</span>
<a name="ln-1167"></a><span class="c">!!</span>
<a name="ln-1168"></a><span class="c">!!##EXAMPLES</span>
<a name="ln-1169"></a><span class="c">!!</span>
<a name="ln-1170"></a><span class="c">!!   examples of usage</span>
<a name="ln-1171"></a><span class="c">!!</span>
<a name="ln-1172"></a><span class="c">!!    program demo_cartesian_to_polar</span>
<a name="ln-1173"></a><span class="c">!!    use M_units, only : cartesian_to_polar</span>
<a name="ln-1174"></a><span class="c">!!    implicit none</span>
<a name="ln-1175"></a><span class="c">!!    real    :: x,y</span>
<a name="ln-1176"></a><span class="c">!!    real    :: r,i</span>
<a name="ln-1177"></a><span class="c">!!    integer :: ios</span>
<a name="ln-1178"></a><span class="c">!!    INFINITE: do</span>
<a name="ln-1179"></a><span class="c">!!       read(*,*,iostat=ios) x, y</span>
<a name="ln-1180"></a><span class="c">!!       if(ios.ne.0)exit INFINITE</span>
<a name="ln-1181"></a><span class="c">!!       call cartesian_to_polar(x,y,r,i)</span>
<a name="ln-1182"></a><span class="c">!!       write(*,*)&#39;x=&#39;,x,&#39; y=&#39;,y,&#39;radius=&#39;,r,&#39;inclination=&#39;,i</span>
<a name="ln-1183"></a><span class="c">!!    enddo INFINITE</span>
<a name="ln-1184"></a><span class="c">!!    end program demo_cartesian_to_polar</span>
<a name="ln-1185"></a><span class="c">!!##AUTHOR</span>
<a name="ln-1186"></a><span class="c">!!    John S. Urban</span>
<a name="ln-1187"></a><span class="c">!!##LICENSE</span>
<a name="ln-1188"></a><span class="c">!!    Public Domain</span>
<a name="ln-1189"></a><span class="k">subroutine </span><span class="n">cartesian_to_polar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">)</span>
<a name="ln-1190"></a><span class="k">implicit none</span>
<a name="ln-1191"></a><span class="c">! ident_20=&quot;@(#)M_units::cartesian_to_polar(3f): convert Cartesian coordinates to polar coordinates&quot;</span>
<a name="ln-1192"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span>
<a name="ln-1193"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">radius</span><span class="p">,</span><span class="n">inclination</span>
<a name="ln-1194"></a>   <span class="n">radius</span><span class="o">=</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1195"></a>   <span class="k">if</span><span class="p">(</span><span class="n">radius</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1196"></a><span class="k">      </span><span class="n">inclination</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-1197"></a>   <span class="k">else</span>
<a name="ln-1198"></a><span class="k">      </span><span class="n">inclination</span><span class="o">=</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<a name="ln-1199"></a>   <span class="k">endif</span>
<a name="ln-1200"></a><span class="k">end subroutine </span><span class="n">cartesian_to_polar</span>
<a name="ln-1201"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1202"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1203"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1204"></a><span class="c">!&gt;</span>
<a name="ln-1205"></a><span class="c">!!##NAME</span>
<a name="ln-1206"></a><span class="c">!!     polar_to_cartesian(3f) - [M_units:TRIGONOMETRY] convert polar coordinates to Cartesian coordinates</span>
<a name="ln-1207"></a><span class="c">!!     (LICENSE:PD)</span>
<a name="ln-1208"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1209"></a><span class="c">!!</span>
<a name="ln-1210"></a><span class="c">!!    subroutine polar_to_cartesian(radius,inclination,x,y)</span>
<a name="ln-1211"></a><span class="c">!!</span>
<a name="ln-1212"></a><span class="c">!!     real,intent(in) :: radius,inclination</span>
<a name="ln-1213"></a><span class="c">!!     real,intent(out)  :: x,y</span>
<a name="ln-1214"></a><span class="c">!!</span>
<a name="ln-1215"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1216"></a><span class="c">!!</span>
<a name="ln-1217"></a><span class="c">!!     Convert polar coordinate &lt;radius, inclination &gt; with</span>
<a name="ln-1218"></a><span class="c">!!     angles in radians to cartesian point &lt;X,Y&gt; using the formulas</span>
<a name="ln-1219"></a><span class="c">!!</span>
<a name="ln-1220"></a><span class="c">!!       x=radius*cos(inclination)</span>
<a name="ln-1221"></a><span class="c">!!       y=radius*sin(inclination)</span>
<a name="ln-1222"></a><span class="c">!!</span>
<a name="ln-1223"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1224"></a><span class="c">!!</span>
<a name="ln-1225"></a><span class="c">!!    RADIUS       The radial distance from the origin (O) to the point (P)</span>
<a name="ln-1226"></a><span class="c">!!    INCLINATION  The INCLINATION angle in radians between the inclination reference direction</span>
<a name="ln-1227"></a><span class="c">!!                 (x-axis) and the orthogonal projection of the line OP of the</span>
<a name="ln-1228"></a><span class="c">!!                 reference plane (x-y plane).</span>
<a name="ln-1229"></a><span class="c">!!</span>
<a name="ln-1230"></a><span class="c">!!##RESULTS</span>
<a name="ln-1231"></a><span class="c">!!</span>
<a name="ln-1232"></a><span class="c">!!    X  The distance along the x-axis</span>
<a name="ln-1233"></a><span class="c">!!    Y  The distance along the y-axis</span>
<a name="ln-1234"></a><span class="c">!!</span>
<a name="ln-1235"></a><span class="c">!!##EXAMPLES</span>
<a name="ln-1236"></a><span class="c">!!</span>
<a name="ln-1237"></a><span class="c">!!   examples of usage</span>
<a name="ln-1238"></a><span class="c">!!</span>
<a name="ln-1239"></a><span class="c">!!    program demo_polar_to_cartesian</span>
<a name="ln-1240"></a><span class="c">!!    use M_units, only : polar_to_cartesian</span>
<a name="ln-1241"></a><span class="c">!!    implicit none</span>
<a name="ln-1242"></a><span class="c">!!    real    :: x,y</span>
<a name="ln-1243"></a><span class="c">!!    real    :: r,i</span>
<a name="ln-1244"></a><span class="c">!!    integer :: ios</span>
<a name="ln-1245"></a><span class="c">!!    INFINITE: do</span>
<a name="ln-1246"></a><span class="c">!!       write(*,&#39;(g0)&#39;,advance=&#39;no&#39;)&#39;Enter radius and inclination(in radians):&#39;</span>
<a name="ln-1247"></a><span class="c">!!       read(*,*,iostat=ios) r, i</span>
<a name="ln-1248"></a><span class="c">!!       if(ios.ne.0)exit INFINITE</span>
<a name="ln-1249"></a><span class="c">!!       call polar_to_cartesian(r,i,x,y)</span>
<a name="ln-1250"></a><span class="c">!!       write(*,*)&#39;x=&#39;,x,&#39; y=&#39;,y,&#39;radius=&#39;,r,&#39;inclination=&#39;,i</span>
<a name="ln-1251"></a><span class="c">!!    enddo INFINITE</span>
<a name="ln-1252"></a><span class="c">!!    end program demo_polar_to_cartesian</span>
<a name="ln-1253"></a><span class="c">!!##AUTHOR</span>
<a name="ln-1254"></a><span class="c">!!    John S. Urban</span>
<a name="ln-1255"></a><span class="c">!!##LICENSE</span>
<a name="ln-1256"></a><span class="c">!!    Public Domain</span>
<a name="ln-1257"></a><span class="k">subroutine </span><span class="n">polar_to_cartesian</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<a name="ln-1258"></a><span class="k">implicit none</span>
<a name="ln-1259"></a><span class="c">! ident_21=&quot;@(#)M_units::polar_to_cartesian(3f): convert polar coordinates to cartesian coordinates&quot;</span>
<a name="ln-1260"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">radius</span><span class="p">,</span><span class="n">inclination</span>
<a name="ln-1261"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span>
<a name="ln-1262"></a>   <span class="k">if</span><span class="p">(</span><span class="n">radius</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1263"></a><span class="k">      </span><span class="n">x</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-1264"></a>      <span class="n">y</span><span class="o">=</span><span class="mf">0.0</span>
<a name="ln-1265"></a>   <span class="k">else</span>
<a name="ln-1266"></a><span class="k">      </span><span class="n">x</span><span class="o">=</span><span class="n">radius</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">inclination</span><span class="p">)</span>
<a name="ln-1267"></a>      <span class="n">y</span><span class="o">=</span><span class="n">radius</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">inclination</span><span class="p">)</span>
<a name="ln-1268"></a>   <span class="k">endif</span>
<a name="ln-1269"></a><span class="k">end subroutine </span><span class="n">polar_to_cartesian</span>
<a name="ln-1270"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1271"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1272"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1273"></a><span class="c">!&gt;</span>
<a name="ln-1274"></a><span class="c">!!##NAME</span>
<a name="ln-1275"></a><span class="c">!!    atomnum2symbol(3f) - [M_units:SYMBOLS] return element symbol given atomic number</span>
<a name="ln-1276"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1277"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1278"></a><span class="c">!!</span>
<a name="ln-1279"></a><span class="c">!!   subroutine atomnum2symbol(atomnum,symbol)</span>
<a name="ln-1280"></a><span class="c">!!</span>
<a name="ln-1281"></a><span class="c">!!    integer,intent(in)           :: atomnum</span>
<a name="ln-1282"></a><span class="c">!!    character(len=2),intent(out) :: symbol</span>
<a name="ln-1283"></a><span class="c">!!</span>
<a name="ln-1284"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1285"></a><span class="c">!!    Given an atomic number in the range of 1 to 109 return the corresponding element symbol name</span>
<a name="ln-1286"></a><span class="c">!!</span>
<a name="ln-1287"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1288"></a><span class="c">!!    atomnum    an atomic number from 1 to 109</span>
<a name="ln-1289"></a><span class="c">!!</span>
<a name="ln-1290"></a><span class="c">!!##RETURNS</span>
<a name="ln-1291"></a><span class="c">!!    symbol     two-character symbol name corresponding to atomic number ATOMNUM</span>
<a name="ln-1292"></a><span class="c">!!</span>
<a name="ln-1293"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1294"></a><span class="c">!!</span>
<a name="ln-1295"></a><span class="c">!!   Sample program</span>
<a name="ln-1296"></a><span class="c">!!</span>
<a name="ln-1297"></a><span class="c">!!    program demo_atomnum2symbol</span>
<a name="ln-1298"></a><span class="c">!!    use M_units, only :  atomnum2symbol</span>
<a name="ln-1299"></a><span class="c">!!    implicit none</span>
<a name="ln-1300"></a><span class="c">!!    character(len=2)  :: name</span>
<a name="ln-1301"></a><span class="c">!!    integer           :: i</span>
<a name="ln-1302"></a><span class="c">!!    do i=1,109</span>
<a name="ln-1303"></a><span class="c">!!       call atomnum2symbol(i,name)</span>
<a name="ln-1304"></a><span class="c">!!       write(*,*)i,name</span>
<a name="ln-1305"></a><span class="c">!!    enddo</span>
<a name="ln-1306"></a><span class="c">!!    end program demo_atomnum2symbol</span>
<a name="ln-1307"></a><span class="c">!!</span>
<a name="ln-1308"></a><span class="c">!!   Results:</span>
<a name="ln-1309"></a><span class="c">!!</span>
<a name="ln-1310"></a><span class="c">!!        &gt;   1 H</span>
<a name="ln-1311"></a><span class="c">!!        &gt;   2 He</span>
<a name="ln-1312"></a><span class="c">!!        &gt;   3 Li</span>
<a name="ln-1313"></a><span class="c">!!        &gt;   4 Be</span>
<a name="ln-1314"></a><span class="c">!!        &gt;   5 B</span>
<a name="ln-1315"></a><span class="c">!!        &gt;   6 C</span>
<a name="ln-1316"></a><span class="c">!!        &gt;   7 N</span>
<a name="ln-1317"></a><span class="c">!!        &gt;   8 O</span>
<a name="ln-1318"></a><span class="c">!!        &gt;   9 F</span>
<a name="ln-1319"></a><span class="c">!!        &gt;  10 Ne</span>
<a name="ln-1320"></a><span class="c">!!        &gt;  11 Na</span>
<a name="ln-1321"></a><span class="c">!!        &gt;  12 Mg</span>
<a name="ln-1322"></a><span class="c">!!        &gt;  13 Al</span>
<a name="ln-1323"></a><span class="c">!!        &gt;  14 Si</span>
<a name="ln-1324"></a><span class="c">!!        &gt;  15 P</span>
<a name="ln-1325"></a><span class="c">!!        &gt;  16 S</span>
<a name="ln-1326"></a><span class="c">!!        &gt;  17 Cl</span>
<a name="ln-1327"></a><span class="c">!!        &gt;  18 Ar</span>
<a name="ln-1328"></a><span class="c">!!        &gt;  19 K</span>
<a name="ln-1329"></a><span class="c">!!        &gt;  20 Ca</span>
<a name="ln-1330"></a><span class="c">!!        &gt;  21 Sc</span>
<a name="ln-1331"></a><span class="c">!!        &gt;  22 Ti</span>
<a name="ln-1332"></a><span class="c">!!        &gt;  23 V</span>
<a name="ln-1333"></a><span class="c">!!        &gt;  24 Cr</span>
<a name="ln-1334"></a><span class="c">!!        &gt;  25 Mn</span>
<a name="ln-1335"></a><span class="c">!!        &gt;  26 Fe</span>
<a name="ln-1336"></a><span class="c">!!        &gt;  27 Co</span>
<a name="ln-1337"></a><span class="c">!!        &gt;  28 Ni</span>
<a name="ln-1338"></a><span class="c">!!        &gt;  29 Cu</span>
<a name="ln-1339"></a><span class="c">!!        &gt;  30 Zn</span>
<a name="ln-1340"></a><span class="c">!!        &gt;  31 Ga</span>
<a name="ln-1341"></a><span class="c">!!        &gt;  32 Ge</span>
<a name="ln-1342"></a><span class="c">!!        &gt;  33 As</span>
<a name="ln-1343"></a><span class="c">!!        &gt;  34 Se</span>
<a name="ln-1344"></a><span class="c">!!        &gt;  35 Br</span>
<a name="ln-1345"></a><span class="c">!!        &gt;  36 Kr</span>
<a name="ln-1346"></a><span class="c">!!        &gt;  37 Rb</span>
<a name="ln-1347"></a><span class="c">!!        &gt;  38 Sr</span>
<a name="ln-1348"></a><span class="c">!!        &gt;  39 Y</span>
<a name="ln-1349"></a><span class="c">!!        &gt;  40 Zr</span>
<a name="ln-1350"></a><span class="c">!!        &gt;  41 Nb</span>
<a name="ln-1351"></a><span class="c">!!        &gt;  42 Mo</span>
<a name="ln-1352"></a><span class="c">!!        &gt;  43 Tc</span>
<a name="ln-1353"></a><span class="c">!!        &gt;  44 Ru</span>
<a name="ln-1354"></a><span class="c">!!        &gt;  45 Rh</span>
<a name="ln-1355"></a><span class="c">!!        &gt;  46 Pd</span>
<a name="ln-1356"></a><span class="c">!!        &gt;  47 Ag</span>
<a name="ln-1357"></a><span class="c">!!        &gt;  48 Cd</span>
<a name="ln-1358"></a><span class="c">!!        &gt;  49 In</span>
<a name="ln-1359"></a><span class="c">!!        &gt;  50 Sn</span>
<a name="ln-1360"></a><span class="c">!!        &gt;  51 Sb</span>
<a name="ln-1361"></a><span class="c">!!        &gt;  52 Te</span>
<a name="ln-1362"></a><span class="c">!!        &gt;  53 I</span>
<a name="ln-1363"></a><span class="c">!!        &gt;  54 Xe</span>
<a name="ln-1364"></a><span class="c">!!        &gt;  55 Cs</span>
<a name="ln-1365"></a><span class="c">!!        &gt;  56 Ba</span>
<a name="ln-1366"></a><span class="c">!!        &gt;  57 La</span>
<a name="ln-1367"></a><span class="c">!!        &gt;  58 Ce</span>
<a name="ln-1368"></a><span class="c">!!        &gt;  59 Pr</span>
<a name="ln-1369"></a><span class="c">!!        &gt;  60 Nd</span>
<a name="ln-1370"></a><span class="c">!!        &gt;  61 Pm</span>
<a name="ln-1371"></a><span class="c">!!        &gt;  62 Sm</span>
<a name="ln-1372"></a><span class="c">!!        &gt;  63 Eu</span>
<a name="ln-1373"></a><span class="c">!!        &gt;  64 Gd</span>
<a name="ln-1374"></a><span class="c">!!        &gt;  65 Tb</span>
<a name="ln-1375"></a><span class="c">!!        &gt;  66 Dy</span>
<a name="ln-1376"></a><span class="c">!!        &gt;  67 Ho</span>
<a name="ln-1377"></a><span class="c">!!        &gt;  68 Er</span>
<a name="ln-1378"></a><span class="c">!!        &gt;  69 Tm</span>
<a name="ln-1379"></a><span class="c">!!        &gt;  70 Yb</span>
<a name="ln-1380"></a><span class="c">!!        &gt;  71 Lu</span>
<a name="ln-1381"></a><span class="c">!!        &gt;  72 Hf</span>
<a name="ln-1382"></a><span class="c">!!        &gt;  73 Ta</span>
<a name="ln-1383"></a><span class="c">!!        &gt;  74 W</span>
<a name="ln-1384"></a><span class="c">!!        &gt;  75 Re</span>
<a name="ln-1385"></a><span class="c">!!        &gt;  76 Os</span>
<a name="ln-1386"></a><span class="c">!!        &gt;  77 Ir</span>
<a name="ln-1387"></a><span class="c">!!        &gt;  78 Pt</span>
<a name="ln-1388"></a><span class="c">!!        &gt;  79 Au</span>
<a name="ln-1389"></a><span class="c">!!        &gt;  80 Hg</span>
<a name="ln-1390"></a><span class="c">!!        &gt;  81 Tl</span>
<a name="ln-1391"></a><span class="c">!!        &gt;  82 Pb</span>
<a name="ln-1392"></a><span class="c">!!        &gt;  83 Bi</span>
<a name="ln-1393"></a><span class="c">!!        &gt;  84 Po</span>
<a name="ln-1394"></a><span class="c">!!        &gt;  85 At</span>
<a name="ln-1395"></a><span class="c">!!        &gt;  86 Rn</span>
<a name="ln-1396"></a><span class="c">!!        &gt;  87 Fr</span>
<a name="ln-1397"></a><span class="c">!!        &gt;  88 Ra</span>
<a name="ln-1398"></a><span class="c">!!        &gt;  89 Ac</span>
<a name="ln-1399"></a><span class="c">!!        &gt;  90 Th</span>
<a name="ln-1400"></a><span class="c">!!        &gt;  91 Pa</span>
<a name="ln-1401"></a><span class="c">!!        &gt;  92 U</span>
<a name="ln-1402"></a><span class="c">!!        &gt;  93 Np</span>
<a name="ln-1403"></a><span class="c">!!        &gt;  94 Pu</span>
<a name="ln-1404"></a><span class="c">!!        &gt;  95 Am</span>
<a name="ln-1405"></a><span class="c">!!        &gt;  96 Cm</span>
<a name="ln-1406"></a><span class="c">!!        &gt;  97 Bk</span>
<a name="ln-1407"></a><span class="c">!!        &gt;  98 Cf</span>
<a name="ln-1408"></a><span class="c">!!        &gt;  99 Es</span>
<a name="ln-1409"></a><span class="c">!!        &gt; 100 Fm</span>
<a name="ln-1410"></a><span class="c">!!        &gt; 101 Md</span>
<a name="ln-1411"></a><span class="c">!!        &gt; 102 No</span>
<a name="ln-1412"></a><span class="c">!!        &gt; 103 Lr</span>
<a name="ln-1413"></a><span class="c">!!        &gt; 104 Rf</span>
<a name="ln-1414"></a><span class="c">!!        &gt; 105 Db</span>
<a name="ln-1415"></a><span class="c">!!        &gt; 106 Sg</span>
<a name="ln-1416"></a><span class="c">!!        &gt; 107 Bh</span>
<a name="ln-1417"></a><span class="c">!!        &gt; 108 Hs</span>
<a name="ln-1418"></a><span class="c">!!        &gt; 109 Mt</span>
<a name="ln-1419"></a><span class="c">!!</span>
<a name="ln-1420"></a><span class="c">!!##AUTHOR</span>
<a name="ln-1421"></a><span class="c">!!    John S. Urban</span>
<a name="ln-1422"></a><span class="c">!!##LICENSE</span>
<a name="ln-1423"></a><span class="c">!!    Public Domain</span>
<a name="ln-1424"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1425"></a><span class="k">subroutine </span><span class="n">atomnum2symbol</span><span class="p">(</span><span class="n">atomnum</span><span class="p">,</span><span class="n">symbol</span><span class="p">)</span>
<a name="ln-1426"></a><span class="k">implicit none</span>
<a name="ln-1427"></a><span class="c">! ident_22=&quot;@(#)M_units::atomnum2symbol(3f): return element symbol given atomic number&quot;</span>
<a name="ln-1428"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">atomnum</span>
<a name="ln-1429"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">symbol</span>
<a name="ln-1430"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>            <span class="kd">::</span> <span class="n">nelements</span><span class="o">=</span><span class="mi">109</span>
<a name="ln-1431"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="k">save</span>        <span class="kd">::</span> <span class="n">symbols</span><span class="p">(</span><span class="n">nelements</span><span class="p">)</span>
<a name="ln-1432"></a>
<a name="ln-1433"></a><span class="k">data </span><span class="n">symbols</span><span class="o">/</span>                                                 <span class="p">&amp;</span>
<a name="ln-1434"></a><span class="p">&amp;</span> <span class="s1">&#39;H &#39;</span><span class="p">,</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;Be&#39;</span><span class="p">,</span> <span class="s1">&#39;B &#39;</span><span class="p">,</span> <span class="s1">&#39;C &#39;</span><span class="p">,</span> <span class="s1">&#39;N &#39;</span><span class="p">,</span> <span class="s1">&#39;O &#39;</span><span class="p">,</span> <span class="s1">&#39;F &#39;</span><span class="p">,</span> <span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1435"></a><span class="p">&amp;</span> <span class="s1">&#39;Na&#39;</span><span class="p">,</span> <span class="s1">&#39;Mg&#39;</span><span class="p">,</span> <span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="s1">&#39;Si&#39;</span><span class="p">,</span> <span class="s1">&#39;P &#39;</span><span class="p">,</span> <span class="s1">&#39;S &#39;</span><span class="p">,</span> <span class="s1">&#39;Cl&#39;</span><span class="p">,</span> <span class="s1">&#39;Ar&#39;</span><span class="p">,</span> <span class="s1">&#39;K &#39;</span><span class="p">,</span> <span class="s1">&#39;Ca&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1436"></a><span class="p">&amp;</span> <span class="s1">&#39;Sc&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti&#39;</span><span class="p">,</span> <span class="s1">&#39;V &#39;</span><span class="p">,</span> <span class="s1">&#39;Cr&#39;</span><span class="p">,</span> <span class="s1">&#39;Mn&#39;</span><span class="p">,</span> <span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;Co&#39;</span><span class="p">,</span> <span class="s1">&#39;Ni&#39;</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="s1">&#39;Zn&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1437"></a><span class="p">&amp;</span> <span class="s1">&#39;Ga&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge&#39;</span><span class="p">,</span> <span class="s1">&#39;As&#39;</span><span class="p">,</span> <span class="s1">&#39;Se&#39;</span><span class="p">,</span> <span class="s1">&#39;Br&#39;</span><span class="p">,</span> <span class="s1">&#39;Kr&#39;</span><span class="p">,</span> <span class="s1">&#39;Rb&#39;</span><span class="p">,</span> <span class="s1">&#39;Sr&#39;</span><span class="p">,</span> <span class="s1">&#39;Y &#39;</span><span class="p">,</span> <span class="s1">&#39;Zr&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1438"></a><span class="p">&amp;</span> <span class="s1">&#39;Nb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo&#39;</span><span class="p">,</span> <span class="s1">&#39;Tc&#39;</span><span class="p">,</span> <span class="s1">&#39;Ru&#39;</span><span class="p">,</span> <span class="s1">&#39;Rh&#39;</span><span class="p">,</span> <span class="s1">&#39;Pd&#39;</span><span class="p">,</span> <span class="s1">&#39;Ag&#39;</span><span class="p">,</span> <span class="s1">&#39;Cd&#39;</span><span class="p">,</span> <span class="s1">&#39;In&#39;</span><span class="p">,</span> <span class="s1">&#39;Sn&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1439"></a><span class="p">&amp;</span> <span class="s1">&#39;Sb&#39;</span><span class="p">,</span> <span class="s1">&#39;Te&#39;</span><span class="p">,</span> <span class="s1">&#39;I &#39;</span><span class="p">,</span> <span class="s1">&#39;Xe&#39;</span><span class="p">,</span> <span class="s1">&#39;Cs&#39;</span><span class="p">,</span> <span class="s1">&#39;Ba&#39;</span><span class="p">,</span> <span class="s1">&#39;La&#39;</span><span class="p">,</span> <span class="s1">&#39;Ce&#39;</span><span class="p">,</span> <span class="s1">&#39;Pr&#39;</span><span class="p">,</span> <span class="s1">&#39;Nd&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1440"></a><span class="p">&amp;</span> <span class="s1">&#39;Pm&#39;</span><span class="p">,</span> <span class="s1">&#39;Sm&#39;</span><span class="p">,</span> <span class="s1">&#39;Eu&#39;</span><span class="p">,</span> <span class="s1">&#39;Gd&#39;</span><span class="p">,</span> <span class="s1">&#39;Tb&#39;</span><span class="p">,</span> <span class="s1">&#39;Dy&#39;</span><span class="p">,</span> <span class="s1">&#39;Ho&#39;</span><span class="p">,</span> <span class="s1">&#39;Er&#39;</span><span class="p">,</span> <span class="s1">&#39;Tm&#39;</span><span class="p">,</span> <span class="s1">&#39;Yb&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1441"></a><span class="p">&amp;</span> <span class="s1">&#39;Lu&#39;</span><span class="p">,</span> <span class="s1">&#39;Hf&#39;</span><span class="p">,</span> <span class="s1">&#39;Ta&#39;</span><span class="p">,</span> <span class="s1">&#39;W &#39;</span><span class="p">,</span> <span class="s1">&#39;Re&#39;</span><span class="p">,</span> <span class="s1">&#39;Os&#39;</span><span class="p">,</span> <span class="s1">&#39;Ir&#39;</span><span class="p">,</span> <span class="s1">&#39;Pt&#39;</span><span class="p">,</span> <span class="s1">&#39;Au&#39;</span><span class="p">,</span> <span class="s1">&#39;Hg&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1442"></a><span class="p">&amp;</span> <span class="s1">&#39;Tl&#39;</span><span class="p">,</span> <span class="s1">&#39;Pb&#39;</span><span class="p">,</span> <span class="s1">&#39;Bi&#39;</span><span class="p">,</span> <span class="s1">&#39;Po&#39;</span><span class="p">,</span> <span class="s1">&#39;At&#39;</span><span class="p">,</span> <span class="s1">&#39;Rn&#39;</span><span class="p">,</span> <span class="s1">&#39;Fr&#39;</span><span class="p">,</span> <span class="s1">&#39;Ra&#39;</span><span class="p">,</span> <span class="s1">&#39;Ac&#39;</span><span class="p">,</span> <span class="s1">&#39;Th&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1443"></a><span class="p">&amp;</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;U &#39;</span><span class="p">,</span> <span class="s1">&#39;Np&#39;</span><span class="p">,</span> <span class="s1">&#39;Pu&#39;</span><span class="p">,</span> <span class="s1">&#39;Am&#39;</span><span class="p">,</span> <span class="s1">&#39;Cm&#39;</span><span class="p">,</span> <span class="s1">&#39;Bk&#39;</span><span class="p">,</span> <span class="s1">&#39;Cf&#39;</span><span class="p">,</span> <span class="s1">&#39;Es&#39;</span><span class="p">,</span> <span class="s1">&#39;Fm&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1444"></a><span class="p">&amp;</span> <span class="s1">&#39;Md&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Lr&#39;</span><span class="p">,</span> <span class="s1">&#39;Rf&#39;</span><span class="p">,</span> <span class="s1">&#39;Db&#39;</span><span class="p">,</span> <span class="s1">&#39;Sg&#39;</span><span class="p">,</span> <span class="s1">&#39;Bh&#39;</span><span class="p">,</span> <span class="s1">&#39;Hs&#39;</span><span class="p">,</span> <span class="s1">&#39;Mt&#39;</span><span class="o">/</span>
<a name="ln-1445"></a>
<a name="ln-1446"></a>   <span class="k">if</span><span class="p">(</span><span class="n">atomnum</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">1.</span><span class="nb">or</span><span class="p">.</span><span class="n">atomnum</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">nelements</span><span class="p">)</span><span class="k">then</span>
<a name="ln-1447"></a><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;*atomnum2symbol* atomic number out of range (1 to 109) &#39;</span><span class="p">,</span><span class="n">atomnum</span>
<a name="ln-1448"></a>      <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;  &#39;</span>
<a name="ln-1449"></a>   <span class="k">else</span>
<a name="ln-1450"></a><span class="k">      </span><span class="n">symbol</span><span class="o">=</span><span class="n">symbols</span><span class="p">(</span><span class="n">atomnum</span><span class="p">)</span>
<a name="ln-1451"></a>   <span class="k">endif</span>
<a name="ln-1452"></a><span class="k">end subroutine </span><span class="n">atomnum2symbol</span>
<a name="ln-1453"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1454"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1455"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1456"></a><span class="c">!&gt;</span>
<a name="ln-1457"></a><span class="c">!!##NAME</span>
<a name="ln-1458"></a><span class="c">!!    symbol2atomnum(3f) - [M_units:SYMBOLS] return atomic number given element symbol name</span>
<a name="ln-1459"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1460"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1461"></a><span class="c">!!</span>
<a name="ln-1462"></a><span class="c">!!   subroutine symbol2atomnum(symbol,atomnum)</span>
<a name="ln-1463"></a><span class="c">!!</span>
<a name="ln-1464"></a><span class="c">!!    character(len=2),intent(in) :: symbol</span>
<a name="ln-1465"></a><span class="c">!!    integer,intent(out)         :: atomnum</span>
<a name="ln-1466"></a><span class="c">!!</span>
<a name="ln-1467"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1468"></a><span class="c">!!    Given a two-character element symbol name return the corresponding atomic number</span>
<a name="ln-1469"></a><span class="c">!!</span>
<a name="ln-1470"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1471"></a><span class="c">!!    symbol     two-character symbol name corresponding to atomic number ATOMNUM</span>
<a name="ln-1472"></a><span class="c">!!</span>
<a name="ln-1473"></a><span class="c">!!##RETURNS</span>
<a name="ln-1474"></a><span class="c">!!    atomnum    an atomic number from 1 to 109</span>
<a name="ln-1475"></a><span class="c">!!</span>
<a name="ln-1476"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1477"></a><span class="c">!!</span>
<a name="ln-1478"></a><span class="c">!!   Sample program</span>
<a name="ln-1479"></a><span class="c">!!</span>
<a name="ln-1480"></a><span class="c">!!    program demo_symbol2atomnum</span>
<a name="ln-1481"></a><span class="c">!!    use M_units, only :  symbol2atomnum</span>
<a name="ln-1482"></a><span class="c">!!    implicit none</span>
<a name="ln-1483"></a><span class="c">!!    integer           :: atomnum</span>
<a name="ln-1484"></a><span class="c">!!    character(len=2)  :: name</span>
<a name="ln-1485"></a><span class="c">!!    name=&#39;Ne&#39;</span>
<a name="ln-1486"></a><span class="c">!!    call symbol2atomnum(name,atomnum)</span>
<a name="ln-1487"></a><span class="c">!!    write(*,*)atomnum,name</span>
<a name="ln-1488"></a><span class="c">!!    end program demo_symbol2atomnum</span>
<a name="ln-1489"></a><span class="c">!!</span>
<a name="ln-1490"></a><span class="c">!!   Results:</span>
<a name="ln-1491"></a><span class="c">!!</span>
<a name="ln-1492"></a><span class="c">!!    10 Ne</span>
<a name="ln-1493"></a><span class="c">!!</span>
<a name="ln-1494"></a><span class="c">!!##AUTHOR</span>
<a name="ln-1495"></a><span class="c">!!    John S. Urban</span>
<a name="ln-1496"></a><span class="c">!!##LICENSE</span>
<a name="ln-1497"></a><span class="c">!!    Public Domain</span>
<a name="ln-1498"></a><span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="ln-1499"></a><span class="k">subroutine </span><span class="n">symbol2atomnum</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span><span class="n">atomnum</span><span class="p">)</span>
<a name="ln-1500"></a><span class="k">implicit none</span>
<a name="ln-1501"></a><span class="c">! ident_23=&quot;@(#)M_units::symbol2atomnum(3f): return atomic number given element symbol name&quot;</span>
<a name="ln-1502"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">symbol</span>
<a name="ln-1503"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">atomnum</span>
<a name="ln-1504"></a><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span>           <span class="kd">::</span> <span class="n">nelements</span><span class="o">=</span><span class="mi">109</span>
<a name="ln-1505"></a><span class="kt">integer</span>                     <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1506"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="k">save</span>       <span class="kd">::</span> <span class="n">symbols</span><span class="p">(</span><span class="n">nelements</span><span class="p">)</span>
<a name="ln-1507"></a>
<a name="ln-1508"></a><span class="k">data </span><span class="n">symbols</span><span class="o">/</span>                                                 <span class="p">&amp;</span>
<a name="ln-1509"></a><span class="p">&amp;</span> <span class="s1">&#39;H &#39;</span><span class="p">,</span> <span class="s1">&#39;He&#39;</span><span class="p">,</span> <span class="s1">&#39;Li&#39;</span><span class="p">,</span> <span class="s1">&#39;Be&#39;</span><span class="p">,</span> <span class="s1">&#39;B &#39;</span><span class="p">,</span> <span class="s1">&#39;C &#39;</span><span class="p">,</span> <span class="s1">&#39;N &#39;</span><span class="p">,</span> <span class="s1">&#39;O &#39;</span><span class="p">,</span> <span class="s1">&#39;F &#39;</span><span class="p">,</span> <span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1510"></a><span class="p">&amp;</span> <span class="s1">&#39;Na&#39;</span><span class="p">,</span> <span class="s1">&#39;Mg&#39;</span><span class="p">,</span> <span class="s1">&#39;Al&#39;</span><span class="p">,</span> <span class="s1">&#39;Si&#39;</span><span class="p">,</span> <span class="s1">&#39;P &#39;</span><span class="p">,</span> <span class="s1">&#39;S &#39;</span><span class="p">,</span> <span class="s1">&#39;Cl&#39;</span><span class="p">,</span> <span class="s1">&#39;Ar&#39;</span><span class="p">,</span> <span class="s1">&#39;K &#39;</span><span class="p">,</span> <span class="s1">&#39;Ca&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1511"></a><span class="p">&amp;</span> <span class="s1">&#39;Sc&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti&#39;</span><span class="p">,</span> <span class="s1">&#39;V &#39;</span><span class="p">,</span> <span class="s1">&#39;Cr&#39;</span><span class="p">,</span> <span class="s1">&#39;Mn&#39;</span><span class="p">,</span> <span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;Co&#39;</span><span class="p">,</span> <span class="s1">&#39;Ni&#39;</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="s1">&#39;Zn&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1512"></a><span class="p">&amp;</span> <span class="s1">&#39;Ga&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge&#39;</span><span class="p">,</span> <span class="s1">&#39;As&#39;</span><span class="p">,</span> <span class="s1">&#39;Se&#39;</span><span class="p">,</span> <span class="s1">&#39;Br&#39;</span><span class="p">,</span> <span class="s1">&#39;Kr&#39;</span><span class="p">,</span> <span class="s1">&#39;Rb&#39;</span><span class="p">,</span> <span class="s1">&#39;Sr&#39;</span><span class="p">,</span> <span class="s1">&#39;Y &#39;</span><span class="p">,</span> <span class="s1">&#39;Zr&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1513"></a><span class="p">&amp;</span> <span class="s1">&#39;Nb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo&#39;</span><span class="p">,</span> <span class="s1">&#39;Tc&#39;</span><span class="p">,</span> <span class="s1">&#39;Ru&#39;</span><span class="p">,</span> <span class="s1">&#39;Rh&#39;</span><span class="p">,</span> <span class="s1">&#39;Pd&#39;</span><span class="p">,</span> <span class="s1">&#39;Ag&#39;</span><span class="p">,</span> <span class="s1">&#39;Cd&#39;</span><span class="p">,</span> <span class="s1">&#39;In&#39;</span><span class="p">,</span> <span class="s1">&#39;Sn&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1514"></a><span class="p">&amp;</span> <span class="s1">&#39;Sb&#39;</span><span class="p">,</span> <span class="s1">&#39;Te&#39;</span><span class="p">,</span> <span class="s1">&#39;I &#39;</span><span class="p">,</span> <span class="s1">&#39;Xe&#39;</span><span class="p">,</span> <span class="s1">&#39;Cs&#39;</span><span class="p">,</span> <span class="s1">&#39;Ba&#39;</span><span class="p">,</span> <span class="s1">&#39;La&#39;</span><span class="p">,</span> <span class="s1">&#39;Ce&#39;</span><span class="p">,</span> <span class="s1">&#39;Pr&#39;</span><span class="p">,</span> <span class="s1">&#39;Nd&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1515"></a><span class="p">&amp;</span> <span class="s1">&#39;Pm&#39;</span><span class="p">,</span> <span class="s1">&#39;Sm&#39;</span><span class="p">,</span> <span class="s1">&#39;Eu&#39;</span><span class="p">,</span> <span class="s1">&#39;Gd&#39;</span><span class="p">,</span> <span class="s1">&#39;Tb&#39;</span><span class="p">,</span> <span class="s1">&#39;Dy&#39;</span><span class="p">,</span> <span class="s1">&#39;Ho&#39;</span><span class="p">,</span> <span class="s1">&#39;Er&#39;</span><span class="p">,</span> <span class="s1">&#39;Tm&#39;</span><span class="p">,</span> <span class="s1">&#39;Yb&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1516"></a><span class="p">&amp;</span> <span class="s1">&#39;Lu&#39;</span><span class="p">,</span> <span class="s1">&#39;Hf&#39;</span><span class="p">,</span> <span class="s1">&#39;Ta&#39;</span><span class="p">,</span> <span class="s1">&#39;W &#39;</span><span class="p">,</span> <span class="s1">&#39;Re&#39;</span><span class="p">,</span> <span class="s1">&#39;Os&#39;</span><span class="p">,</span> <span class="s1">&#39;Ir&#39;</span><span class="p">,</span> <span class="s1">&#39;Pt&#39;</span><span class="p">,</span> <span class="s1">&#39;Au&#39;</span><span class="p">,</span> <span class="s1">&#39;Hg&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1517"></a><span class="p">&amp;</span> <span class="s1">&#39;Tl&#39;</span><span class="p">,</span> <span class="s1">&#39;Pb&#39;</span><span class="p">,</span> <span class="s1">&#39;Bi&#39;</span><span class="p">,</span> <span class="s1">&#39;Po&#39;</span><span class="p">,</span> <span class="s1">&#39;At&#39;</span><span class="p">,</span> <span class="s1">&#39;Rn&#39;</span><span class="p">,</span> <span class="s1">&#39;Fr&#39;</span><span class="p">,</span> <span class="s1">&#39;Ra&#39;</span><span class="p">,</span> <span class="s1">&#39;Ac&#39;</span><span class="p">,</span> <span class="s1">&#39;Th&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1518"></a><span class="p">&amp;</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;U &#39;</span><span class="p">,</span> <span class="s1">&#39;Np&#39;</span><span class="p">,</span> <span class="s1">&#39;Pu&#39;</span><span class="p">,</span> <span class="s1">&#39;Am&#39;</span><span class="p">,</span> <span class="s1">&#39;Cm&#39;</span><span class="p">,</span> <span class="s1">&#39;Bk&#39;</span><span class="p">,</span> <span class="s1">&#39;Cf&#39;</span><span class="p">,</span> <span class="s1">&#39;Es&#39;</span><span class="p">,</span> <span class="s1">&#39;Fm&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1519"></a><span class="p">&amp;</span> <span class="s1">&#39;Md&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Lr&#39;</span><span class="p">,</span> <span class="s1">&#39;Rf&#39;</span><span class="p">,</span> <span class="s1">&#39;Db&#39;</span><span class="p">,</span> <span class="s1">&#39;Sg&#39;</span><span class="p">,</span> <span class="s1">&#39;Bh&#39;</span><span class="p">,</span> <span class="s1">&#39;Hs&#39;</span><span class="p">,</span> <span class="s1">&#39;Mt&#39;</span><span class="o">/</span>
<a name="ln-1520"></a>
<a name="ln-1521"></a><span class="n">FINDIT</span><span class="p">:</span> <span class="k">block</span>
<a name="ln-1522"></a><span class="k">   do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nelements</span>
<a name="ln-1523"></a>      <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">symbols</span><span class="p">(</span><span class="n">i</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">symbols</span><span class="p">(</span><span class="n">i</span><span class="p">)(</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-1524"></a><span class="k">         </span><span class="n">atomnum</span><span class="o">=</span><span class="n">i</span>
<a name="ln-1525"></a>         <span class="k">exit </span><span class="n">FINDIT</span>
<a name="ln-1526"></a>      <span class="k">endif</span>
<a name="ln-1527"></a><span class="k">   enddo</span>
<a name="ln-1528"></a><span class="k">   write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;*symbol2atomnum* error: symbol not found :&#39;</span><span class="p">,</span><span class="n">symbol</span>
<a name="ln-1529"></a>   <span class="n">atomnum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-1530"></a><span class="k">endblock </span><span class="n">FINDIT</span>
<a name="ln-1531"></a><span class="k">end subroutine </span><span class="n">symbol2atomnum</span>
<a name="ln-1532"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1533"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1534"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-1535"></a><span class="c">!&gt;</span>
<a name="ln-1536"></a><span class="c">!!##NAME</span>
<a name="ln-1537"></a><span class="c">!!    pounds_to_kilograms(3f) - [M_units:MASS] - converts a measurement in pounds-mass to kilograms.</span>
<a name="ln-1538"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1539"></a><span class="c">!!</span>
<a name="ln-1540"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1541"></a><span class="c">!!</span>
<a name="ln-1542"></a><span class="c">!!    elemental function pounds_to_kilograms ( pounds )</span>
<a name="ln-1543"></a><span class="c">!!</span>
<a name="ln-1544"></a><span class="c">!!     class(*),intent(in) ::  pounds</span>
<a name="ln-1545"></a><span class="c">!!     doubleprecision     :: pounds_to_kilograms</span>
<a name="ln-1546"></a><span class="c">!!</span>
<a name="ln-1547"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1548"></a><span class="c">!!    Converts pounds-mass to kilograms using the formula:</span>
<a name="ln-1549"></a><span class="c">!!</span>
<a name="ln-1550"></a><span class="c">!!       kilograms = 0.45359237 * pounds</span>
<a name="ln-1551"></a><span class="c">!!</span>
<a name="ln-1552"></a><span class="c">!!    The pound (or more properly pound-mass) is a unit of mass used in the</span>
<a name="ln-1553"></a><span class="c">!!    Imperial, United States Customary, and other systems of measurement. A</span>
<a name="ln-1554"></a><span class="c">!!    number of different definitions have been used; the most common today</span>
<a name="ln-1555"></a><span class="c">!!    is the international avoirdupois pound, which is legally defined as</span>
<a name="ln-1556"></a><span class="c">!!    exactly 0.45359237 kilograms. The international standard symbol for</span>
<a name="ln-1557"></a><span class="c">!!    the avoirdupois pound is lb (from the Roman &quot;libra&quot;); an alternative</span>
<a name="ln-1558"></a><span class="c">!!    symbol is lbm).</span>
<a name="ln-1559"></a><span class="c">!!</span>
<a name="ln-1560"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1561"></a><span class="c">!!    POUNDS  The weight in pounds.</span>
<a name="ln-1562"></a><span class="c">!!            POUNDS may be any standard scalar value supported by anyscalar_to_double(3f).</span>
<a name="ln-1563"></a><span class="c">!!            This at least includes REAL, INTEGER, and DOUBLEPRECISION.</span>
<a name="ln-1564"></a><span class="c">!!##RETURN</span>
<a name="ln-1565"></a><span class="c">!!    POUNDS_TO_KILOGRAMS   the corresponding weight in kilograms.</span>
<a name="ln-1566"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1567"></a><span class="c">!!</span>
<a name="ln-1568"></a><span class="c">!!   Sample program</span>
<a name="ln-1569"></a><span class="c">!!</span>
<a name="ln-1570"></a><span class="c">!!    program demo_pounds_to_kilograms</span>
<a name="ln-1571"></a><span class="c">!!    use M_units, only : pounds_to_kilograms</span>
<a name="ln-1572"></a><span class="c">!!    implicit none</span>
<a name="ln-1573"></a><span class="c">!!       write(*,*)&#39;REAL            &#39;, pounds_to_kilograms(1.0)</span>
<a name="ln-1574"></a><span class="c">!!       write(*,*)&#39;INTEGER array   &#39;, pounds_to_kilograms([ 0, 1, 100, 200 ])</span>
<a name="ln-1575"></a><span class="c">!!       write(*,*)&#39;DOUBLEPRECISION &#39;, pounds_to_kilograms(1.0d0)</span>
<a name="ln-1576"></a><span class="c">!!    end program demo_pounds_to_kilograms</span>
<a name="ln-1577"></a><span class="c">!!</span>
<a name="ln-1578"></a><span class="c">!!   Typical Results</span>
<a name="ln-1579"></a><span class="c">!!</span>
<a name="ln-1580"></a><span class="c">!!     REAL              0.45359237000000002</span>
<a name="ln-1581"></a><span class="c">!!     INTEGER array     0.0000000000000000    0.45359237000000002</span>
<a name="ln-1582"></a><span class="c">!!                      45.359237000000000    90.718474000000001</span>
<a name="ln-1583"></a><span class="c">!!     DOUBLEPRECISION   0.45359237000000002</span>
<a name="ln-1584"></a><span class="c">!!</span>
<a name="ln-1585"></a><span class="c">!!##AUTHOR</span>
<a name="ln-1586"></a><span class="c">!!    John S. Urban</span>
<a name="ln-1587"></a><span class="c">!!##LICENSE</span>
<a name="ln-1588"></a><span class="c">!!    Public Domain</span>
<a name="ln-1589"></a><span class="k">elemental function </span><span class="n">pounds_to_kilograms</span> <span class="p">(</span> <span class="n">pounds</span> <span class="p">)</span>
<a name="ln-1590"></a><span class="c">! ident_24=&quot;@(#)M_units::pounds_to_kilograms(3f): converts a measurement in pounds to kilograms.&quot;</span>
<a name="ln-1591"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pounds</span>
<a name="ln-1592"></a>   <span class="n">doubleprecision</span>  <span class="kd">::</span> <span class="n">pounds_to_kilograms</span>
<a name="ln-1593"></a>   <span class="n">doubleprecision</span>  <span class="kd">::</span> <span class="n">pounds_local</span>
<a name="ln-1594"></a>   <span class="n">pounds_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">pounds</span><span class="p">)</span>
<a name="ln-1595"></a>   <span class="n">pounds_to_kilograms</span> <span class="o">=</span> <span class="mf">0.45359237d0</span> <span class="o">*</span> <span class="n">pounds_local</span>
<a name="ln-1596"></a><span class="k">end function </span><span class="n">pounds_to_kilograms</span>
<a name="ln-1597"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1598"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1599"></a><span class="c">!==================================================================================================================================!</span>
<a name="ln-1600"></a><span class="c">!&gt;</span>
<a name="ln-1601"></a><span class="c">!!##NAME</span>
<a name="ln-1602"></a><span class="c">!!    norm_angle_rad(3f) - [M_units:TRIGONOMETRY] Return input angle given in radians as angle between 0 and 2pi</span>
<a name="ln-1603"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1604"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1605"></a><span class="c">!!</span>
<a name="ln-1606"></a><span class="c">!!    elemental function norm_angle_rad(ang) result(rev)</span>
<a name="ln-1607"></a><span class="c">!!</span>
<a name="ln-1608"></a><span class="c">!!    class(*), intent(in) :: ang</span>
<a name="ln-1609"></a><span class="c">!!    doubleprecision      :: rev</span>
<a name="ln-1610"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1611"></a><span class="c">!!    Given an input angle specified in radians, normalize the value to fall in the</span>
<a name="ln-1612"></a><span class="c">!!    range 0 to 2*pi radians.</span>
<a name="ln-1613"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1614"></a><span class="c">!!    ang  Input angle (radians). May be INTEGER, REAL, or DOUBLEPRECISION</span>
<a name="ln-1615"></a><span class="c">!!##RESULTS</span>
<a name="ln-1616"></a><span class="c">!!    rev  Return input angle (radians) normalized to range 0&gt;= REV &lt;=2*pi radians</span>
<a name="ln-1617"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1618"></a><span class="c">!!</span>
<a name="ln-1619"></a><span class="c">!!   Sample program:</span>
<a name="ln-1620"></a><span class="c">!!</span>
<a name="ln-1621"></a><span class="c">!!    program demo_norm_angle_rad</span>
<a name="ln-1622"></a><span class="c">!!    use M_units, only : norm_angle_rad</span>
<a name="ln-1623"></a><span class="c">!!    implicit none</span>
<a name="ln-1624"></a><span class="c">!!    real,parameter :: PI=4*atan(1.0)</span>
<a name="ln-1625"></a><span class="c">!!    real           :: val</span>
<a name="ln-1626"></a><span class="c">!!    integer        :: i</span>
<a name="ln-1627"></a><span class="c">!!    do i=-2,2</span>
<a name="ln-1628"></a><span class="c">!!       val=i*2*pi;   write(*,*)val,norm_angle_rad(val)</span>
<a name="ln-1629"></a><span class="c">!!       val=i*pi;     write(*,*)val,norm_angle_rad(val)</span>
<a name="ln-1630"></a><span class="c">!!       write(*,*)</span>
<a name="ln-1631"></a><span class="c">!!    enddo</span>
<a name="ln-1632"></a><span class="c">!!    write(*,*)norm_angle_rad([-PI/8.0,-PI/4.0,-PI/2.0,-PI,-0.0,PI/8.0,PI/4.0,PI/2.0,PI,0.0])</span>
<a name="ln-1633"></a><span class="c">!!    end program demo_norm_angle_rad</span>
<a name="ln-1634"></a><span class="c">!!</span>
<a name="ln-1635"></a><span class="c">!!   Results:</span>
<a name="ln-1636"></a><span class="c">!!</span>
<a name="ln-1637"></a><span class="c">!!##AUTHOR</span>
<a name="ln-1638"></a><span class="c">!!    John S. Urban</span>
<a name="ln-1639"></a><span class="c">!!##LICENSE</span>
<a name="ln-1640"></a><span class="c">!!    Public Domain</span>
<a name="ln-1641"></a><span class="k">elemental function </span><span class="n">norm_angle_rad</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
<a name="ln-1642"></a>
<a name="ln-1643"></a><span class="c">! ident_25=&quot;@(#)M_units::norm_angle_rad(3fp): Return input angle (given in radians) as doubleprecision angle between 0 and 2pi radians&quot;</span>
<a name="ln-1644"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ang</span>
<a name="ln-1645"></a><span class="n">doubleprecision</span>      <span class="kd">::</span> <span class="n">ang_local</span>
<a name="ln-1646"></a><span class="n">doubleprecision</span>      <span class="kd">::</span> <span class="n">norm_angle_rad</span>
<a name="ln-1647"></a>   <span class="n">ang_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
<a name="ln-1648"></a>   <span class="n">norm_angle_rad</span> <span class="o">=</span> <span class="n">ang_local</span> <span class="o">-</span> <span class="nb">dble</span><span class="p">(</span><span class="nb">floor</span><span class="p">(</span><span class="n">ang_local</span><span class="o">/</span><span class="n">circle_rad_d</span><span class="p">))</span> <span class="o">*</span> <span class="n">circle_rad_d</span>
<a name="ln-1649"></a><span class="k">end function </span><span class="n">norm_angle_rad</span>
<a name="ln-1650"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1651"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-1652"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1653"></a><span class="c">!&gt;</span>
<a name="ln-1654"></a><span class="c">!!##NAME</span>
<a name="ln-1655"></a><span class="c">!!    norm_angle_deg(3f) - [M_units:TRIGONOMETRY] Return input angle given in degrees as angle between 0 and 360</span>
<a name="ln-1656"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1657"></a><span class="c">!!</span>
<a name="ln-1658"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1659"></a><span class="c">!!</span>
<a name="ln-1660"></a><span class="c">!!    elemental function norm_angle_deg(ang) result(rev)</span>
<a name="ln-1661"></a><span class="c">!!</span>
<a name="ln-1662"></a><span class="c">!!     doubleprecision, intent(in) :: ang</span>
<a name="ln-1663"></a><span class="c">!!     doubleprecision             :: rev</span>
<a name="ln-1664"></a><span class="c">!!        or</span>
<a name="ln-1665"></a><span class="c">!!     real, intent(in) :: ang</span>
<a name="ln-1666"></a><span class="c">!!     real             :: rev</span>
<a name="ln-1667"></a><span class="c">!!        or</span>
<a name="ln-1668"></a><span class="c">!!     integer, intent(in) :: ang</span>
<a name="ln-1669"></a><span class="c">!!     integer             :: rev</span>
<a name="ln-1670"></a><span class="c">!!</span>
<a name="ln-1671"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1672"></a><span class="c">!!    Given an input angle in degrees, normalize the value to fall in the</span>
<a name="ln-1673"></a><span class="c">!!    range 0 to 360 degrees.</span>
<a name="ln-1674"></a><span class="c">!!</span>
<a name="ln-1675"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1676"></a><span class="c">!!    ang  Input angle (degrees)</span>
<a name="ln-1677"></a><span class="c">!!</span>
<a name="ln-1678"></a><span class="c">!!##RESULTS</span>
<a name="ln-1679"></a><span class="c">!!    rev  Return input angle (degrees) normalized to range 0 to 360 degrees</span>
<a name="ln-1680"></a><span class="c">!!</span>
<a name="ln-1681"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1682"></a><span class="c">!!</span>
<a name="ln-1683"></a><span class="c">!!   Sample program:</span>
<a name="ln-1684"></a><span class="c">!!</span>
<a name="ln-1685"></a><span class="c">!!    program demo_norm_angle_deg</span>
<a name="ln-1686"></a><span class="c">!!    use M_units, only : norm_angle_deg</span>
<a name="ln-1687"></a><span class="c">!!    implicit none</span>
<a name="ln-1688"></a><span class="c">!!    real,parameter :: PI=360</span>
<a name="ln-1689"></a><span class="c">!!    real           :: val</span>
<a name="ln-1690"></a><span class="c">!!    integer        :: i</span>
<a name="ln-1691"></a><span class="c">!!    do i=-2,2</span>
<a name="ln-1692"></a><span class="c">!!       val=i*2*pi;   write(*,*)val,norm_angle_deg(val)</span>
<a name="ln-1693"></a><span class="c">!!       val=i*pi;     write(*,*)val,norm_angle_deg(val)</span>
<a name="ln-1694"></a><span class="c">!!       val=i*pi/2;   write(*,*)val,norm_angle_deg(val)</span>
<a name="ln-1695"></a><span class="c">!!       write(*,*)</span>
<a name="ln-1696"></a><span class="c">!!    enddo</span>
<a name="ln-1697"></a><span class="c">!!    end program demo_norm_angle_deg</span>
<a name="ln-1698"></a><span class="c">!!</span>
<a name="ln-1699"></a><span class="c">!!   Results:</span>
<a name="ln-1700"></a><span class="c">!!</span>
<a name="ln-1701"></a><span class="c">!!      -1440.00000       0.00000000</span>
<a name="ln-1702"></a><span class="c">!!      -720.000000       0.00000000</span>
<a name="ln-1703"></a><span class="c">!!      -360.000000       0.00000000</span>
<a name="ln-1704"></a><span class="c">!!</span>
<a name="ln-1705"></a><span class="c">!!      -720.000000       0.00000000</span>
<a name="ln-1706"></a><span class="c">!!      -360.000000       0.00000000</span>
<a name="ln-1707"></a><span class="c">!!      -180.000000       180.000000</span>
<a name="ln-1708"></a><span class="c">!!</span>
<a name="ln-1709"></a><span class="c">!!       0.00000000       0.00000000</span>
<a name="ln-1710"></a><span class="c">!!       0.00000000       0.00000000</span>
<a name="ln-1711"></a><span class="c">!!       0.00000000       0.00000000</span>
<a name="ln-1712"></a><span class="c">!!</span>
<a name="ln-1713"></a><span class="c">!!       720.000000       0.00000000</span>
<a name="ln-1714"></a><span class="c">!!       360.000000       0.00000000</span>
<a name="ln-1715"></a><span class="c">!!       180.000000       180.000000</span>
<a name="ln-1716"></a><span class="c">!!</span>
<a name="ln-1717"></a><span class="c">!!       1440.00000       0.00000000</span>
<a name="ln-1718"></a><span class="c">!!       720.000000       0.00000000</span>
<a name="ln-1719"></a><span class="c">!!       360.000000       0.00000000</span>
<a name="ln-1720"></a><span class="c">!!</span>
<a name="ln-1721"></a><span class="c">!!##LICENSE</span>
<a name="ln-1722"></a><span class="c">!!    MIT License</span>
<a name="ln-1723"></a><span class="k">elemental function </span><span class="n">norm_angle_deg_class</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
<a name="ln-1724"></a>
<a name="ln-1725"></a><span class="c">! ident_26=&quot;@(#)M_units:: norm_angle_deg_class(3fp): Returns angle in degrees between 0 and 360&quot;</span>
<a name="ln-1726"></a>
<a name="ln-1727"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ang</span>
<a name="ln-1728"></a><span class="n">doubleprecision</span>     <span class="kd">::</span> <span class="n">ang_local</span>
<a name="ln-1729"></a><span class="n">doubleprecision</span>     <span class="kd">::</span> <span class="n">norm_angle_deg_class</span>
<a name="ln-1730"></a><span class="n">ang_local</span><span class="o">=</span><span class="n">anyscalar_to_double</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
<a name="ln-1731"></a>   <span class="n">norm_angle_deg_class</span> <span class="o">=</span> <span class="n">ang_local</span> <span class="o">-</span> <span class="nb">dble</span><span class="p">(</span><span class="nb">floor</span><span class="p">(</span><span class="n">ang_local</span><span class="o">/</span><span class="mi">36</span><span class="mf">0.d0</span><span class="p">))</span> <span class="o">*</span> <span class="mi">36</span><span class="mf">0.d0</span>
<a name="ln-1732"></a><span class="k">end function </span><span class="n">norm_angle_deg_class</span>
<a name="ln-1733"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1734"></a><span class="k">elemental function </span><span class="n">norm_angle_deg_double</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
<a name="ln-1735"></a>
<a name="ln-1736"></a><span class="c">! ident_27=&quot;@(#)M_units:: norm_angle_deg_double(3fp): Returns angle in degrees between 0 and 360&quot;</span>
<a name="ln-1737"></a>
<a name="ln-1738"></a><span class="n">doubleprecision</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ang</span>
<a name="ln-1739"></a><span class="n">doubleprecision</span>            <span class="kd">::</span> <span class="n">norm_angle_deg_double</span>
<a name="ln-1740"></a>   <span class="n">norm_angle_deg_double</span> <span class="o">=</span> <span class="n">norm_angle_deg_class</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
<a name="ln-1741"></a><span class="k">end function </span><span class="n">norm_angle_deg_double</span>
<a name="ln-1742"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1743"></a><span class="k">elemental function </span><span class="n">norm_angle_deg_real</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a><span class="c">! ident_28=&quot;@(#)M_units:: norm_angle_deg_real(3fp): Returns angle in degrees between 0 and 360&quot;</span>
<a name="ln-1746"></a>
<a name="ln-1747"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ang</span>
<a name="ln-1748"></a><span class="kt">real</span>            <span class="kd">::</span> <span class="n">norm_angle_deg_real</span>
<a name="ln-1749"></a>   <span class="n">norm_angle_deg_real</span> <span class="o">=</span> <span class="n">norm_angle_deg_class</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
<a name="ln-1750"></a><span class="k">end function </span><span class="n">norm_angle_deg_real</span>
<a name="ln-1751"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1752"></a><span class="k">elemental function </span><span class="n">norm_angle_deg_integer</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
<a name="ln-1753"></a>
<a name="ln-1754"></a><span class="c">! ident_29=&quot;@(#)M_units:: norm_angle_deg_integer(3fp): Returns angle in degrees between 0 and 360&quot;</span>
<a name="ln-1755"></a>
<a name="ln-1756"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ang</span>
<a name="ln-1757"></a><span class="kt">integer</span>            <span class="kd">::</span> <span class="n">norm_angle_deg_integer</span>
<a name="ln-1758"></a>   <span class="n">norm_angle_deg_integer</span> <span class="o">=</span> <span class="n">norm_angle_deg_class</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
<a name="ln-1759"></a><span class="k">end function </span><span class="n">norm_angle_deg_integer</span>
<a name="ln-1760"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1761"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-1762"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1763"></a><span class="c">!&gt;</span>
<a name="ln-1764"></a><span class="c">!!##NAME</span>
<a name="ln-1765"></a><span class="c">!!    inf(3f) - [M_units] return an inf (Infinity)</span>
<a name="ln-1766"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1767"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1768"></a><span class="c">!!</span>
<a name="ln-1769"></a><span class="c">!!    function inf(value)</span>
<a name="ln-1770"></a><span class="c">!!    use,intrinsic :: iso_fortran_env, only: real32, real64, real128</span>
<a name="ln-1771"></a><span class="c">!!    real(kind=real32|real64|real128) :: inf</span>
<a name="ln-1772"></a><span class="c">!!    real(kind=real32|real64|real128) :: value</span>
<a name="ln-1773"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1774"></a><span class="c">!!    Return an inf (Infinity) value. The type returned will be the same</span>
<a name="ln-1775"></a><span class="c">!!    kind as the passed value.</span>
<a name="ln-1776"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1777"></a><span class="c">!!    value  A real value whose kind is used to define the kind of the</span>
<a name="ln-1778"></a><span class="c">!!           returned value.</span>
<a name="ln-1779"></a><span class="c">!!##RETURNS</span>
<a name="ln-1780"></a><span class="c">!!    inf    returns an inf value (&quot;Infinity&quot;) on platforms that support</span>
<a name="ln-1781"></a><span class="c">!!           inf values. The kind is determined by the kind of the input</span>
<a name="ln-1782"></a><span class="c">!!           value.</span>
<a name="ln-1783"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1784"></a><span class="c">!!</span>
<a name="ln-1785"></a><span class="c">!!    Sample program</span>
<a name="ln-1786"></a><span class="c">!!</span>
<a name="ln-1787"></a><span class="c">!!      program demo_inf</span>
<a name="ln-1788"></a><span class="c">!!      use,intrinsic :: iso_fortran_env, only: real32, real64, real128</span>
<a name="ln-1789"></a><span class="c">!!      use M_units, only : inf</span>
<a name="ln-1790"></a><span class="c">!!      implicit none</span>
<a name="ln-1791"></a><span class="c">!!      real(kind=real32)  :: r32</span>
<a name="ln-1792"></a><span class="c">!!      real(kind=real64)  :: r64</span>
<a name="ln-1793"></a><span class="c">!!      real(kind=real128) :: r128</span>
<a name="ln-1794"></a><span class="c">!!      character(len=256) :: message</span>
<a name="ln-1795"></a><span class="c">!!      integer            :: ios</span>
<a name="ln-1796"></a><span class="c">!!         r32=inf(0.0_real32)</span>
<a name="ln-1797"></a><span class="c">!!         r64=inf(0.0_real64)</span>
<a name="ln-1798"></a><span class="c">!!         r128=inf(0.0_real128)</span>
<a name="ln-1799"></a><span class="c">!!         write(*,*,iomsg=message,iostat=ios)r32,r64,r128</span>
<a name="ln-1800"></a><span class="c">!!         if(ios.ne.0)write(*,*)trim(message)</span>
<a name="ln-1801"></a><span class="c">!!         write(*,&#39;(z0)&#39;,iomsg=message,iostat=ios)r32,r64,r128</span>
<a name="ln-1802"></a><span class="c">!!         if(ios.ne.0)write(*,*)trim(message)</span>
<a name="ln-1803"></a><span class="c">!!         write(*,&#39;(g0)&#39;,iomsg=message,iostat=ios)r32,r64,r128</span>
<a name="ln-1804"></a><span class="c">!!         if(ios.ne.0)write(*,*)trim(message)</span>
<a name="ln-1805"></a><span class="c">!!         write(*,&#39;(f3.1)&#39;,iomsg=message,iostat=ios)r32,r64,r128</span>
<a name="ln-1806"></a><span class="c">!!         if(ios.ne.0)write(*,*)trim(message)</span>
<a name="ln-1807"></a><span class="c">!!         write(*,&#39;(f2.1)&#39;,iomsg=message,iostat=ios)r32,r64,r128</span>
<a name="ln-1808"></a><span class="c">!!         if(ios.ne.0)write(*,*)trim(message)</span>
<a name="ln-1809"></a><span class="c">!!      end program demo_inf</span>
<a name="ln-1810"></a><span class="c">!!   Results:</span>
<a name="ln-1811"></a><span class="c">!!</span>
<a name="ln-1812"></a><span class="c">!!     Infinity Infinity Infinity</span>
<a name="ln-1813"></a><span class="c">!!    7F800000</span>
<a name="ln-1814"></a><span class="c">!!    7FF0000000000000</span>
<a name="ln-1815"></a><span class="c">!!    7FFF0000000000000000000000000000</span>
<a name="ln-1816"></a><span class="c">!!    Inf</span>
<a name="ln-1817"></a><span class="c">!!    Inf</span>
<a name="ln-1818"></a><span class="c">!!    Inf</span>
<a name="ln-1819"></a><span class="c">!!    Inf</span>
<a name="ln-1820"></a><span class="c">!!    Inf</span>
<a name="ln-1821"></a><span class="c">!!    Inf</span>
<a name="ln-1822"></a><span class="c">!!    **</span>
<a name="ln-1823"></a><span class="c">!!    **</span>
<a name="ln-1824"></a><span class="c">!!    **</span>
<a name="ln-1825"></a><span class="c">!!</span>
<a name="ln-1826"></a><span class="c">!!##AUTHOR</span>
<a name="ln-1827"></a><span class="c">!!    John S. Urban</span>
<a name="ln-1828"></a><span class="c">!!##LICENSE</span>
<a name="ln-1829"></a><span class="c">!!    Public Domain</span>
<a name="ln-1830"></a><span class="k">function </span><span class="n">inf32</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
<a name="ln-1831"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span> <span class="n">real32</span>
<a name="ln-1832"></a><span class="k">implicit none</span>
<a name="ln-1833"></a>
<a name="ln-1834"></a><span class="c">! ident_30=&quot;@(#)M_units:: inf32(3fp): Returns an inf (Infinity) of type real32&quot;</span>
<a name="ln-1835"></a>
<a name="ln-1836"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="k">save</span> <span class="kd">::</span> <span class="n">STRING</span><span class="o">=</span><span class="s1">&#39;inf&#39;</span>
<a name="ln-1837"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">inf32</span><span class="p">,</span><span class="k">value</span>
<a name="ln-1838"></a><span class="k">   read</span><span class="p">(</span><span class="n">STRING</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">inf32</span>
<a name="ln-1839"></a><span class="k">end function </span><span class="n">inf32</span>
<a name="ln-1840"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1841"></a><span class="k">function </span><span class="n">inf64</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
<a name="ln-1842"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span> <span class="n">real64</span>
<a name="ln-1843"></a><span class="k">implicit none</span>
<a name="ln-1844"></a>
<a name="ln-1845"></a><span class="c">! ident_31=&quot;@(#)M_units:: inf64(3fp): Returns an inf (Infinity) of type real64&quot;</span>
<a name="ln-1846"></a>
<a name="ln-1847"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="k">save</span> <span class="kd">::</span> <span class="n">STRING</span><span class="o">=</span><span class="s1">&#39;inf&#39;</span>
<a name="ln-1848"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">inf64</span><span class="p">,</span><span class="k">value</span>
<a name="ln-1849"></a><span class="k">   read</span><span class="p">(</span><span class="n">STRING</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">inf64</span>
<a name="ln-1850"></a><span class="k">end function </span><span class="n">inf64</span>
<a name="ln-1851"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1852"></a><span class="k">function </span><span class="n">inf128</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
<a name="ln-1853"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span> <span class="n">real128</span>
<a name="ln-1854"></a><span class="k">implicit none</span>
<a name="ln-1855"></a>
<a name="ln-1856"></a><span class="c">! ident_32=&quot;@(#)M_units:: inf128(3fp): Returns an inf (Infinity) of type real128&quot;</span>
<a name="ln-1857"></a>
<a name="ln-1858"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="k">save</span> <span class="kd">::</span> <span class="n">STRING</span><span class="o">=</span><span class="s1">&#39;inf&#39;</span>
<a name="ln-1859"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">)</span> <span class="kd">::</span> <span class="n">inf128</span><span class="p">,</span><span class="k">value</span>
<a name="ln-1860"></a><span class="k">   read</span><span class="p">(</span><span class="n">STRING</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">inf128</span>
<a name="ln-1861"></a><span class="k">end function </span><span class="n">inf128</span>
<a name="ln-1862"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1863"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-1864"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1865"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1866"></a><span class="c">!&gt;</span>
<a name="ln-1867"></a><span class="c">!!##NAME</span>
<a name="ln-1868"></a><span class="c">!!    nan(3f) - [M_units] return a NaN (Not a number)</span>
<a name="ln-1869"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1870"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1871"></a><span class="c">!!</span>
<a name="ln-1872"></a><span class="c">!!    function nan(value)</span>
<a name="ln-1873"></a><span class="c">!!    use,intrinsic :: iso_fortran_env, only: real32, real64, real128</span>
<a name="ln-1874"></a><span class="c">!!    real(kind=real32|real64|real128) :: nan</span>
<a name="ln-1875"></a><span class="c">!!    real(kind=real32|real64|real128) :: value</span>
<a name="ln-1876"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1877"></a><span class="c">!!    Return a NaN (Not a number) value. The type returned will be the same</span>
<a name="ln-1878"></a><span class="c">!!    kind as the passed value.</span>
<a name="ln-1879"></a><span class="c">!!</span>
<a name="ln-1880"></a><span class="c">!!    At some point, the IEEE interface should work, with something like</span>
<a name="ln-1881"></a><span class="c">!!</span>
<a name="ln-1882"></a><span class="c">!!     use,intrinsic :: ieee_arithmetic, only : ieee_value, ieee_quiet_nan</span>
<a name="ln-1883"></a><span class="c">!!     use,intrinsic :: ieee_arithmetic, only : ieee_support_nan</span>
<a name="ln-1884"></a><span class="c">!!</span>
<a name="ln-1885"></a><span class="c">!!     if(IEEE_SUPPORT_NAN(x))then        ! Are IEEE NaNs supported?</span>
<a name="ln-1886"></a><span class="c">!!        x=IEEE_VALUE(x,ieee_quiet_nan)  ! Generate an IEEE value.</span>
<a name="ln-1887"></a><span class="c">!!     endif</span>
<a name="ln-1888"></a><span class="c">!!</span>
<a name="ln-1889"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1890"></a><span class="c">!!    value  A real value whose kind is used to define the kind of the</span>
<a name="ln-1891"></a><span class="c">!!           returned value.</span>
<a name="ln-1892"></a><span class="c">!!##RETURNS</span>
<a name="ln-1893"></a><span class="c">!!    nan    returns a Nan value (&quot;Not a number&quot;) on platforms that support</span>
<a name="ln-1894"></a><span class="c">!!           NaN values. The kind is determined by the kind of the input</span>
<a name="ln-1895"></a><span class="c">!!           value.</span>
<a name="ln-1896"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1897"></a><span class="c">!!</span>
<a name="ln-1898"></a><span class="c">!!   Sample program</span>
<a name="ln-1899"></a><span class="c">!!</span>
<a name="ln-1900"></a><span class="c">!!    program demo_nan</span>
<a name="ln-1901"></a><span class="c">!!    use,intrinsic :: iso_fortran_env, only: real32, real64, real128</span>
<a name="ln-1902"></a><span class="c">!!    use M_units, only : nan</span>
<a name="ln-1903"></a><span class="c">!!    implicit none</span>
<a name="ln-1904"></a><span class="c">!!    real(kind=real32)  :: r32</span>
<a name="ln-1905"></a><span class="c">!!    real(kind=real64)  :: r64</span>
<a name="ln-1906"></a><span class="c">!!    real(kind=real128) :: r128</span>
<a name="ln-1907"></a><span class="c">!!    character(len=256) :: message</span>
<a name="ln-1908"></a><span class="c">!!    integer            :: ios</span>
<a name="ln-1909"></a><span class="c">!!</span>
<a name="ln-1910"></a><span class="c">!!       r32=nan(0.0_real32)</span>
<a name="ln-1911"></a><span class="c">!!       r64=nan(0.0_real64)</span>
<a name="ln-1912"></a><span class="c">!!       r128=nan(0.0_real128)</span>
<a name="ln-1913"></a><span class="c">!!</span>
<a name="ln-1914"></a><span class="c">!!       ! examples printing the NaN values</span>
<a name="ln-1915"></a><span class="c">!!       ! list directed format</span>
<a name="ln-1916"></a><span class="c">!!       write(*,*,iomsg=message,iostat=ios)r32,r64,r128</span>
<a name="ln-1917"></a><span class="c">!!       if(ios.ne.0)write(*,*)trim(message)</span>
<a name="ln-1918"></a><span class="c">!!       ! hexadecimal format to show different kinds</span>
<a name="ln-1919"></a><span class="c">!!       write(*,&#39;(*(z0,1x))&#39;,iomsg=message,iostat=ios)r32,r64,r128</span>
<a name="ln-1920"></a><span class="c">!!       if(ios.ne.0)write(*,*)trim(message)</span>
<a name="ln-1921"></a><span class="c">!!       ! G0 format</span>
<a name="ln-1922"></a><span class="c">!!       write(*,&#39;(*(g0,1x))&#39;,iomsg=message,iostat=ios)r32,r64,r128</span>
<a name="ln-1923"></a><span class="c">!!       if(ios.ne.0)write(*,*)trim(message)</span>
<a name="ln-1924"></a><span class="c">!!       ! if a specific numeric field is used</span>
<a name="ln-1925"></a><span class="c">!!       write(*,&#39;(*(f3.1,1x))&#39;,iomsg=message,iostat=ios)r32,r64,r128</span>
<a name="ln-1926"></a><span class="c">!!       if(ios.ne.0)write(*,*)trim(message)</span>
<a name="ln-1927"></a><span class="c">!!       ! if format is less than three characters</span>
<a name="ln-1928"></a><span class="c">!!       write(*,&#39;(*(f2.1,1x))&#39;,iomsg=message,iostat=ios)r32,r64,r128</span>
<a name="ln-1929"></a><span class="c">!!       if(ios.ne.0)write(*,*)trim(message)</span>
<a name="ln-1930"></a><span class="c">!!</span>
<a name="ln-1931"></a><span class="c">!!       ! an option to terminate a program when a NaN is encountered</span>
<a name="ln-1932"></a><span class="c">!!       ! (if X is NaN the comparison with 0. is always false.)</span>
<a name="ln-1933"></a><span class="c">!!       if (.not.(r32&lt;=0.0) .and. .not.(r32&gt;=0.0))then</span>
<a name="ln-1934"></a><span class="c">!!          write(*,*)&#39;found nan&#39;</span>
<a name="ln-1935"></a><span class="c">!!          stop</span>
<a name="ln-1936"></a><span class="c">!!       endif</span>
<a name="ln-1937"></a><span class="c">!!</span>
<a name="ln-1938"></a><span class="c">!!       ALT1: block</span>
<a name="ln-1939"></a><span class="c">!!          integer :: x = 2143289344</span>
<a name="ln-1940"></a><span class="c">!!          print *, transfer(x, 1.0)    ! prints &quot;nan&quot; on i686</span>
<a name="ln-1941"></a><span class="c">!!       endblock ALT1</span>
<a name="ln-1942"></a><span class="c">!!</span>
<a name="ln-1943"></a><span class="c">!!    end program demo_nan</span>
<a name="ln-1944"></a><span class="c">!!</span>
<a name="ln-1945"></a><span class="c">!!   Results:</span>
<a name="ln-1946"></a><span class="c">!!</span>
<a name="ln-1947"></a><span class="c">!!    NaN      NaN              NaN</span>
<a name="ln-1948"></a><span class="c">!!    7FC00000 7FF8000000000000 7FFF8000000000000000000000000000</span>
<a name="ln-1949"></a><span class="c">!!    NaN NaN NaN</span>
<a name="ln-1950"></a><span class="c">!!    NaN NaN NaN</span>
<a name="ln-1951"></a><span class="c">!!    ** ** **</span>
<a name="ln-1952"></a><span class="c">!!     found nan</span>
<a name="ln-1953"></a><span class="c">!!</span>
<a name="ln-1954"></a><span class="c">!!##SEE ALSO</span>
<a name="ln-1955"></a><span class="c">!!      IS_NAN(3f)</span>
<a name="ln-1956"></a><span class="c">!!##AUTHOR</span>
<a name="ln-1957"></a><span class="c">!!    John S. Urban</span>
<a name="ln-1958"></a><span class="c">!!##LICENSE</span>
<a name="ln-1959"></a><span class="c">!!    Public Domain</span>
<a name="ln-1960"></a><span class="k">function </span><span class="n">nan32</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
<a name="ln-1961"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span> <span class="n">real32</span>
<a name="ln-1962"></a><span class="k">implicit none</span>
<a name="ln-1963"></a>
<a name="ln-1964"></a><span class="c">! ident_33=&quot;@(#)M_units:: nan32(3fp): Returns a NAN (Not a number) of type real32&quot;</span>
<a name="ln-1965"></a>
<a name="ln-1966"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="k">save</span> <span class="kd">::</span> <span class="n">STRING</span><span class="o">=</span><span class="s1">&#39;NaN&#39;</span>
<a name="ln-1967"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nan32</span><span class="p">,</span><span class="k">value</span>
<a name="ln-1968"></a><span class="k">   read</span><span class="p">(</span><span class="n">STRING</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">nan32</span>
<a name="ln-1969"></a>   <span class="c">! (if X is NaN the comparison with 0. is always false.)</span>
<a name="ln-1970"></a>   <span class="c">!if ( (nan32&lt;=0.0_real32) .or. (nan32&gt;=0.0_real32) )then</span>
<a name="ln-1971"></a>   <span class="c">!   write(*,*)&#39;nan(3f) did not produce a nan&#39;</span>
<a name="ln-1972"></a>   <span class="c">!   stop</span>
<a name="ln-1973"></a>   <span class="c">!endif</span>
<a name="ln-1974"></a><span class="k">end function </span><span class="n">nan32</span>
<a name="ln-1975"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1976"></a><span class="k">function </span><span class="n">nan64</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
<a name="ln-1977"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span> <span class="n">real64</span>
<a name="ln-1978"></a><span class="k">implicit none</span>
<a name="ln-1979"></a>
<a name="ln-1980"></a><span class="c">! ident_34=&quot;@(#)M_units:: nan64(3fp): Returns a NAN (Not a number) of type real64&quot;</span>
<a name="ln-1981"></a>
<a name="ln-1982"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="k">save</span> <span class="kd">::</span> <span class="n">STRING</span><span class="o">=</span><span class="s1">&#39;NaN&#39;</span>
<a name="ln-1983"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nan64</span><span class="p">,</span><span class="k">value</span>
<a name="ln-1984"></a><span class="k">   read</span><span class="p">(</span><span class="n">STRING</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">nan64</span>
<a name="ln-1985"></a>   <span class="c">! (if X is NaN the comparison with 0. is always false.)</span>
<a name="ln-1986"></a>   <span class="c">!if ( (nan64&lt;=0.0_real64) .or. (nan64&gt;=0.0_real64) )then</span>
<a name="ln-1987"></a>   <span class="c">!   write(*,*)&#39;nan(3f) did not produce a nan&#39;</span>
<a name="ln-1988"></a>   <span class="c">!   stop</span>
<a name="ln-1989"></a>   <span class="c">!endif</span>
<a name="ln-1990"></a><span class="k">end function </span><span class="n">nan64</span>
<a name="ln-1991"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-1992"></a><span class="k">function </span><span class="n">nan128</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
<a name="ln-1993"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span> <span class="n">real128</span>
<a name="ln-1994"></a><span class="k">implicit none</span>
<a name="ln-1995"></a>
<a name="ln-1996"></a><span class="c">!$@(#) M_units:: nan128(3fp): Returns a NAN (Not a number) of type real128</span>
<a name="ln-1997"></a>
<a name="ln-1998"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="k">save</span> <span class="kd">::</span> <span class="n">STRING</span><span class="o">=</span><span class="s1">&#39;NaN&#39;</span>
<a name="ln-1999"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nan128</span><span class="p">,</span><span class="k">value</span>
<a name="ln-2000"></a><span class="k">   read</span><span class="p">(</span><span class="n">STRING</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">nan128</span>
<a name="ln-2001"></a>   <span class="c">! (if X is NaN the comparison with 0. is always false.)</span>
<a name="ln-2002"></a>   <span class="c">!if ( (nan128&lt;=0.0_real128) .or. (nan128&gt;=0.0_real128) )then</span>
<a name="ln-2003"></a>   <span class="c">!   write(*,*)&#39;nan(3f) did not produce a nan&#39;</span>
<a name="ln-2004"></a>   <span class="c">!   stop</span>
<a name="ln-2005"></a>   <span class="c">!endif</span>
<a name="ln-2006"></a><span class="k">end function </span><span class="n">nan128</span>
<a name="ln-2007"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2008"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-2009"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2010"></a><span class="c">!&gt;</span>
<a name="ln-2011"></a><span class="c">!!##NAME</span>
<a name="ln-2012"></a><span class="c">!!    is_even(3f) - [M_units] determine if integer is even</span>
<a name="ln-2013"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2014"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2015"></a><span class="c">!!</span>
<a name="ln-2016"></a><span class="c">!!    elemental pure logical is_even(int)</span>
<a name="ln-2017"></a><span class="c">!!</span>
<a name="ln-2018"></a><span class="c">!!     integer(kind=int8|int16|int32|int64) :: int</span>
<a name="ln-2019"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2020"></a><span class="c">!!     Determine if an integer is even or not.</span>
<a name="ln-2021"></a><span class="c">!!##OPTIONS</span>
<a name="ln-2022"></a><span class="c">!!     int      The integer to test</span>
<a name="ln-2023"></a><span class="c">!!##RETURNS</span>
<a name="ln-2024"></a><span class="c">!!     is_even  logical value is .true. if the input value INT is even</span>
<a name="ln-2025"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2026"></a><span class="c">!!</span>
<a name="ln-2027"></a><span class="c">!!   simple example</span>
<a name="ln-2028"></a><span class="c">!!</span>
<a name="ln-2029"></a><span class="c">!!     program demo_is_even</span>
<a name="ln-2030"></a><span class="c">!!     use M_units, only : is_even</span>
<a name="ln-2031"></a><span class="c">!!        write(*,*)is_even(0)</span>
<a name="ln-2032"></a><span class="c">!!        write(*,*)is_even(-1)</span>
<a name="ln-2033"></a><span class="c">!!        write(*,*)is_even(-2)</span>
<a name="ln-2034"></a><span class="c">!!        write(*,*)is_even(+1)</span>
<a name="ln-2035"></a><span class="c">!!        write(*,*)is_even(+2)</span>
<a name="ln-2036"></a><span class="c">!!        write(*,*)is_even([10,11,17,19,22])</span>
<a name="ln-2037"></a><span class="c">!!        write(*,*)(is_even(i),i=-10,10)</span>
<a name="ln-2038"></a><span class="c">!!     end program demo_is_even</span>
<a name="ln-2039"></a><span class="c">!!   Expected output</span>
<a name="ln-2040"></a><span class="c">!!     T</span>
<a name="ln-2041"></a><span class="c">!!     F</span>
<a name="ln-2042"></a><span class="c">!!     T</span>
<a name="ln-2043"></a><span class="c">!!     F</span>
<a name="ln-2044"></a><span class="c">!!     T</span>
<a name="ln-2045"></a><span class="c">!!     T F F F T</span>
<a name="ln-2046"></a><span class="c">!!     T F T F T F T F T F T F T F T F T F T F T</span>
<a name="ln-2047"></a><span class="c">!!##LICENSE</span>
<a name="ln-2048"></a><span class="c">!!    Public Domain</span>
<a name="ln-2049"></a><span class="k">elemental pure function </span><span class="n">is_even</span><span class="p">(</span><span class="n">ival</span><span class="p">)</span>
<a name="ln-2050"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">int8</span><span class="p">,</span> <span class="n">int16</span><span class="p">,</span> <span class="n">int32</span><span class="p">,</span> <span class="n">int64</span>
<a name="ln-2051"></a>
<a name="ln-2052"></a><span class="c">! ident_35=&quot;@(#)M_units::is_even(3f): determine if integer is  even&quot;</span>
<a name="ln-2053"></a>
<a name="ln-2054"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ival</span>
<a name="ln-2055"></a><span class="kt">logical</span>             <span class="kd">::</span> <span class="n">is_even</span>
<a name="ln-2056"></a><span class="k">select type</span><span class="p">(</span><span class="n">ival</span><span class="p">)</span>
<a name="ln-2057"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">))</span>  <span class="p">;</span> <span class="n">is_even</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">ival</span><span class="p">,</span> <span class="mi">2_int8</span><span class="p">)</span>   <span class="o">==</span> <span class="mi">0_int8</span>
<a name="ln-2058"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">))</span> <span class="p">;</span> <span class="n">is_even</span> <span class="o">=</span> <span class="nb">iand</span><span class="p">(</span><span class="n">ival</span><span class="p">,</span> <span class="mi">1_int16</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0_int16</span>
<a name="ln-2059"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">))</span> <span class="p">;</span> <span class="n">is_even</span> <span class="o">=</span> <span class="nb">iand</span><span class="p">(</span><span class="n">ival</span><span class="p">,</span> <span class="mi">1_int32</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0_int32</span>
<a name="ln-2060"></a>   <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">))</span> <span class="p">;</span> <span class="n">is_even</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">ival</span><span class="p">,</span> <span class="mi">2_int64</span><span class="p">)</span>  <span class="o">==</span> <span class="mi">0_int64</span>
<a name="ln-2061"></a>   <span class="k">end select</span>
<a name="ln-2062"></a><span class="k">end function </span><span class="n">is_even</span>
<a name="ln-2063"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2064"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-2065"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2066"></a><span class="c">!&gt;</span>
<a name="ln-2067"></a><span class="c">!!##NAME</span>
<a name="ln-2068"></a><span class="c">!!    is_nan(3f) - [M_units] determine if integer is a Nan (Not a Number) value</span>
<a name="ln-2069"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2070"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2071"></a><span class="c">!!</span>
<a name="ln-2072"></a><span class="c">!!    elemental pure logical is_nan(value)</span>
<a name="ln-2073"></a><span class="c">!!</span>
<a name="ln-2074"></a><span class="c">!!     integer(kind=real32|real64|real128|complex) :: value</span>
<a name="ln-2075"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2076"></a><span class="c">!!     Determine if a real or complex value is a NaN (Not a Number) value</span>
<a name="ln-2077"></a><span class="c">!!##OPTIONS</span>
<a name="ln-2078"></a><span class="c">!!     value   The value to test</span>
<a name="ln-2079"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2080"></a><span class="c">!!</span>
<a name="ln-2081"></a><span class="c">!!   simple example</span>
<a name="ln-2082"></a><span class="c">!!</span>
<a name="ln-2083"></a><span class="c">!!     program demo_is_nan</span>
<a name="ln-2084"></a><span class="c">!!     use M_units, only : is_nan</span>
<a name="ln-2085"></a><span class="c">!!     real :: x</span>
<a name="ln-2086"></a><span class="c">!!     character(len=*),parameter   :: linei=&#39;Infinity&#39;</span>
<a name="ln-2087"></a><span class="c">!!     character(len=*),parameter   :: line=&#39;NaN&#39;</span>
<a name="ln-2088"></a><span class="c">!!     character(len=:),allocatable :: readable</span>
<a name="ln-2089"></a><span class="c">!!     real,parameter :: arr(*)=[-100.0,100.0,huge(0.0)]</span>
<a name="ln-2090"></a><span class="c">!!        readable=linei</span>
<a name="ln-2091"></a><span class="c">!!        read(readable,*)x</span>
<a name="ln-2092"></a><span class="c">!!        write(*,*)is_nan(x),x   ! note Infinity is not a Nan</span>
<a name="ln-2093"></a><span class="c">!!        write(*,*)is_nan(-x),-x</span>
<a name="ln-2094"></a><span class="c">!!        readable=line</span>
<a name="ln-2095"></a><span class="c">!!        read(readable,*)x</span>
<a name="ln-2096"></a><span class="c">!!        write(*,*)is_nan(x),x</span>
<a name="ln-2097"></a><span class="c">!!        write(*,*)x==x,x  ! note Nan is never equal to another value</span>
<a name="ln-2098"></a><span class="c">!!        write(*,*)is_nan(arr),arr</span>
<a name="ln-2099"></a><span class="c">!!     end program demo_is_nan</span>
<a name="ln-2100"></a><span class="c">!!</span>
<a name="ln-2101"></a><span class="c">!!   Expected results</span>
<a name="ln-2102"></a><span class="c">!!</span>
<a name="ln-2103"></a><span class="c">!!     F         Infinity</span>
<a name="ln-2104"></a><span class="c">!!     F        -Infinity</span>
<a name="ln-2105"></a><span class="c">!!     T              NaN</span>
<a name="ln-2106"></a><span class="c">!!     F              NaN</span>
<a name="ln-2107"></a><span class="c">!!     F F F  -100.000000       100.000000       3.40282347E+38</span>
<a name="ln-2108"></a><span class="c">!!##AUTHOR</span>
<a name="ln-2109"></a><span class="c">!!    John S. Urban</span>
<a name="ln-2110"></a><span class="c">!!##LICENSE</span>
<a name="ln-2111"></a><span class="c">!!    Public Domain</span>
<a name="ln-2112"></a><span class="k">elemental pure function </span><span class="n">is_nan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-2113"></a><span class="c">!!use IEEE_EXCEPTIONS, only : ieee_support_nan ! is IEEE NaNs supported?</span>
<a name="ln-2114"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">IEEE_ARITHMETIC</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">IEEE_IS_NAN</span>       <span class="c">! Determine if value is IEEE Not-a-Number.</span>
<a name="ln-2115"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">int8</span><span class="p">,</span> <span class="n">int16</span><span class="p">,</span> <span class="n">int32</span><span class="p">,</span> <span class="n">int64</span><span class="p">,</span> <span class="n">real32</span><span class="p">,</span> <span class="n">real64</span><span class="p">,</span> <span class="n">real128</span>
<a name="ln-2116"></a>
<a name="ln-2117"></a><span class="c">! ident_36=&quot;@(#)M_units::is_nan(3f): determine if value is  IEEE Not-a-Number&quot;</span>
<a name="ln-2118"></a>
<a name="ln-2119"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>
<a name="ln-2120"></a><span class="kt">logical</span>             <span class="kd">::</span> <span class="n">is_nan</span>
<a name="ln-2121"></a>   <span class="k">select type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-2122"></a>      <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">));</span>      <span class="n">is_nan</span><span class="o">=</span><span class="n">ieee_is_nan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-2123"></a>      <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">));</span>      <span class="n">is_nan</span><span class="o">=</span><span class="n">ieee_is_nan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-2124"></a>      <span class="k">type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">));</span>     <span class="n">is_nan</span><span class="o">=</span><span class="n">ieee_is_nan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="ln-2125"></a>      <span class="k">type is</span> <span class="p">(</span><span class="kt">complex</span><span class="p">);</span>                <span class="n">is_nan</span><span class="o">=</span><span class="n">ieee_is_nan</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">x</span><span class="p">)).</span><span class="nb">and</span><span class="p">.</span><span class="n">ieee_is_nan</span><span class="p">(</span><span class="nb">aimag</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="ln-2126"></a>      <span class="c">!!type is (complex);                is_nan=ieee_is_nan(x%re).and.ieee_is_nan(x%im)</span>
<a name="ln-2127"></a>   <span class="k">end select</span>
<a name="ln-2128"></a><span class="k">end function </span><span class="n">is_nan</span>
<a name="ln-2129"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2130"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-2131"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2132"></a><span class="k">subroutine </span><span class="n">test_suite_M_units</span><span class="p">()</span>
<a name="ln-2133"></a><span class="k">use </span><span class="n">M_verify</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">unit_check_start</span><span class="p">,</span><span class="n">unit_check</span><span class="p">,</span><span class="n">unit_check_done</span><span class="p">,</span><span class="n">unit_check_good</span><span class="p">,</span><span class="n">unit_check_bad</span><span class="p">,</span><span class="n">unit_check_msg</span>
<a name="ln-2134"></a><span class="k">use </span><span class="n">M_verify</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">unit_check_level</span>
<a name="ln-2135"></a><span class="k">use </span><span class="n">M_msg</span><span class="p">,</span>   <span class="k">only</span> <span class="p">:</span> <span class="n">str</span>
<a name="ln-2136"></a>
<a name="ln-2137"></a><span class="c">!! test constants</span>
<a name="ln-2138"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;pi&#39;</span><span class="p">,</span>      <span class="kt">real</span><span class="p">(</span><span class="n">PI</span><span class="p">)</span>      <span class="p">,</span>  <span class="kt">real</span><span class="p">(</span><span class="mf">3.141592653589793238462643383279500d0</span><span class="p">)</span>  <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2139"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span>       <span class="kt">real</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>       <span class="p">,</span>  <span class="kt">real</span><span class="p">(</span><span class="mf">2.718281828459045235360d0</span><span class="p">)</span>              <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2140"></a>   <span class="c">!!call testit_p(&#39;radian&#39;,  real(RADIAN)  ,  real(57.29577951310d0)                       ,message=&#39;&#39;)</span>
<a name="ln-2141"></a>   <span class="c">!!call testit_p(&#39;degree&#39;,  real(DEGREE)  ,  real(0.0174532925199430d0)                   ,message=&#39;&#39;)</span>
<a name="ln-2142"></a>
<a name="ln-2143"></a><span class="c">!! setup</span>
<a name="ln-2144"></a>   <span class="k">call </span><span class="n">test_acosd</span><span class="p">()</span>
<a name="ln-2145"></a>   <span class="k">call </span><span class="n">test_asind</span><span class="p">()</span>
<a name="ln-2146"></a>   <span class="k">call </span><span class="n">test_atan2d</span><span class="p">()</span>
<a name="ln-2147"></a>   <span class="k">call </span><span class="n">test_atand</span><span class="p">()</span>
<a name="ln-2148"></a>   <span class="k">call </span><span class="n">test_atomnum2symbol</span><span class="p">()</span>
<a name="ln-2149"></a>   <span class="k">call </span><span class="n">test_c2f</span><span class="p">()</span>
<a name="ln-2150"></a>   <span class="k">call </span><span class="n">test_cartesian_to_polar</span><span class="p">()</span>
<a name="ln-2151"></a>   <span class="k">call </span><span class="n">test_cartesian_to_spherical</span><span class="p">()</span>
<a name="ln-2152"></a>   <span class="k">call </span><span class="n">test_cosd</span><span class="p">()</span>
<a name="ln-2153"></a>   <span class="k">call </span><span class="n">test_d2r</span><span class="p">()</span>
<a name="ln-2154"></a>   <span class="k">call </span><span class="n">test_f2c</span><span class="p">()</span>
<a name="ln-2155"></a>   <span class="k">call </span><span class="n">test_feet_to_meters</span><span class="p">()</span>
<a name="ln-2156"></a>   <span class="k">call </span><span class="n">test_meters_to_feet</span><span class="p">()</span>
<a name="ln-2157"></a>   <span class="k">call </span><span class="n">test_norm_angle_deg_double</span><span class="p">()</span>
<a name="ln-2158"></a>   <span class="k">call </span><span class="n">test_norm_angle_deg_integer</span><span class="p">()</span>
<a name="ln-2159"></a>   <span class="k">call </span><span class="n">test_norm_angle_deg_real</span><span class="p">()</span>
<a name="ln-2160"></a>   <span class="k">call </span><span class="n">test_norm_angle_rad</span><span class="p">()</span>
<a name="ln-2161"></a>   <span class="k">call </span><span class="n">test_polar_to_cartesian</span><span class="p">()</span>
<a name="ln-2162"></a>   <span class="k">call </span><span class="n">test_pounds_to_kilograms</span><span class="p">()</span>
<a name="ln-2163"></a>   <span class="k">call </span><span class="n">test_r2d</span><span class="p">()</span>
<a name="ln-2164"></a>   <span class="k">call </span><span class="n">test_sind</span><span class="p">()</span>
<a name="ln-2165"></a>   <span class="k">call </span><span class="n">test_spherical_to_cartesian</span><span class="p">()</span>
<a name="ln-2166"></a>   <span class="k">call </span><span class="n">test_symbol2atomnum</span><span class="p">()</span>
<a name="ln-2167"></a>   <span class="k">call </span><span class="n">test_tand</span><span class="p">()</span>
<a name="ln-2168"></a>   <span class="k">call </span><span class="n">test_inf</span><span class="p">()</span>
<a name="ln-2169"></a>   <span class="k">call </span><span class="n">test_nan</span><span class="p">()</span>
<a name="ln-2170"></a>   <span class="k">call </span><span class="n">test_is_nan</span><span class="p">()</span>
<a name="ln-2171"></a>   <span class="k">call </span><span class="n">test_is_even</span><span class="p">()</span>
<a name="ln-2172"></a><span class="c">!! teardown</span>
<a name="ln-2173"></a><span class="k">contains</span>
<a name="ln-2174"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2175"></a><span class="k">subroutine </span><span class="n">testit_p</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">value1</span><span class="p">,</span><span class="n">value2</span><span class="p">,</span><span class="n">message</span><span class="p">)</span>
<a name="ln-2176"></a><span class="k">use </span><span class="n">M_anything</span><span class="p">,</span><span class="k">only</span> <span class="p">:</span> <span class="n">anyscalar_to_real</span><span class="p">,</span> <span class="n">anyscalar_to_double</span>
<a name="ln-2177"></a><span class="k">USE </span><span class="n">M_Compare_Float_Numbers</span>
<a name="ln-2178"></a><span class="k">use </span><span class="n">M_verify</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">accdig</span>
<a name="ln-2179"></a><span class="k">use </span><span class="n">M_verify</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">unit_check</span>
<a name="ln-2180"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">value1</span><span class="p">,</span> <span class="n">value2</span>
<a name="ln-2181"></a><span class="kt">real</span>                <span class="kd">::</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span>
<a name="ln-2182"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">label</span>
<a name="ln-2183"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">message</span>
<a name="ln-2184"></a><span class="kt">logical</span>             <span class="kd">::</span> <span class="nb">stat</span>
<a name="ln-2185"></a><span class="kt">real</span>                <span class="kd">::</span> <span class="n">significant_digits</span>
<a name="ln-2186"></a><span class="kt">integer</span>             <span class="kd">::</span> <span class="n">ind</span>
<a name="ln-2187"></a><span class="kt">real</span>                <span class="kd">::</span> <span class="n">acurcy</span>
<a name="ln-2188"></a>
<a name="ln-2189"></a>   <span class="n">v1</span><span class="o">=</span><span class="n">anyscalar_to_real</span><span class="p">(</span><span class="n">value1</span><span class="p">)</span>
<a name="ln-2190"></a>   <span class="n">v2</span><span class="o">=</span><span class="n">anyscalar_to_real</span><span class="p">(</span><span class="n">value2</span><span class="p">)</span>
<a name="ln-2191"></a>   <span class="nb">stat</span><span class="o">=</span><span class="n">v1</span> <span class="p">.</span><span class="n">EqualTo</span><span class="p">.</span> <span class="n">v2</span>
<a name="ln-2192"></a>
<a name="ln-2193"></a>   <span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">stat</span><span class="p">)</span><span class="k">then</span>
<a name="ln-2194"></a><span class="c">!     INPUT ...</span>
<a name="ln-2195"></a><span class="c">!     real,intent(in) :: x           ! First  of two real numbers to be compared.</span>
<a name="ln-2196"></a><span class="c">!     real,intent(in) :: y           ! Second of two real numbers to be compared.</span>
<a name="ln-2197"></a><span class="c">!     real,intent(in) :: digi0       ! Number of digits to be satisfied in relative tolerance.</span>
<a name="ln-2198"></a><span class="c">!     OUTPUT ...</span>
<a name="ln-2199"></a><span class="c">!     integer,intent(out) :: ind     ! = 0, If tolerance is     satisfied.</span>
<a name="ln-2200"></a><span class="c">!                                    ! = 1, If tolerance is not satisfied.</span>
<a name="ln-2201"></a><span class="c">!     real,intent(out) :: acurcy     ! = - LOG10 (ABS((X-Y)/Y)))</span>
<a name="ln-2202"></a>      <span class="n">significant_digits</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">log10</span><span class="p">(</span><span class="mf">2.0</span><span class="o">**</span><span class="nb">digits</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)))</span>     <span class="c">! MAXIMUM NUMBER OF SIGNIFICANT DIGITS IN A REAL NUMBER.</span>
<a name="ln-2203"></a>      <span class="k">call </span><span class="n">accdig</span> <span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">significant_digits</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">ACURCY</span><span class="p">,</span><span class="n">IND</span><span class="p">)</span>
<a name="ln-2204"></a>      <span class="k">if</span><span class="p">(</span><span class="n">ind</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="nb">stat</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2205"></a>   <span class="k">endif</span>
<a name="ln-2206"></a><span class="c">!-----------------------</span>
<a name="ln-2207"></a> <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="nb">stat</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">message</span><span class="p">),</span><span class="s1">&#39;accuracy=&#39;</span><span class="p">,</span><span class="n">acurcy</span><span class="p">,</span><span class="s1">&#39;asked for&#39;</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">significant_digits</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;digits&#39;</span><span class="p">)</span>
<a name="ln-2208"></a><span class="k">end subroutine </span><span class="n">testit_p</span>
<a name="ln-2209"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2210"></a><span class="k">subroutine </span><span class="n">test_nan</span><span class="p">()</span>
<a name="ln-2211"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span> <span class="n">real32</span><span class="p">,</span> <span class="n">real64</span><span class="p">,</span> <span class="n">real128</span>
<a name="ln-2212"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r32</span>
<a name="ln-2213"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r64</span>
<a name="ln-2214"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real128</span><span class="p">)</span> <span class="kd">::</span> <span class="n">r128</span>
<a name="ln-2215"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2216"></a>   <span class="c">! (if X is NaN the comparison with 0.0 is always false.)</span>
<a name="ln-2217"></a>   <span class="n">r32</span><span class="o">=</span><span class="n">nan</span><span class="p">(</span><span class="mf">0.0_real32</span><span class="p">)</span>
<a name="ln-2218"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,.</span><span class="nb">not</span><span class="p">.(</span><span class="n">r32</span><span class="o">&lt;=</span><span class="mf">0.0_real32</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">r32</span><span class="o">&gt;=</span><span class="mf">0.0_real32</span><span class="p">),</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;real32&#39;</span><span class="p">)</span>
<a name="ln-2219"></a>
<a name="ln-2220"></a>   <span class="n">r64</span><span class="o">=</span><span class="n">nan</span><span class="p">(</span><span class="mf">0.0_real64</span><span class="p">)</span>
<a name="ln-2221"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,.</span><span class="nb">not</span><span class="p">.(</span><span class="n">r64</span><span class="o">&lt;=</span><span class="mf">0.0_real64</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">r64</span><span class="o">&gt;=</span><span class="mf">0.0_real64</span><span class="p">),</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;real64&#39;</span><span class="p">)</span>
<a name="ln-2222"></a>
<a name="ln-2223"></a>   <span class="n">r128</span><span class="o">=</span><span class="n">nan</span><span class="p">(</span><span class="mf">0.0_real128</span><span class="p">)</span>
<a name="ln-2224"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,.</span><span class="nb">not</span><span class="p">.(</span><span class="n">r128</span><span class="o">&lt;=</span><span class="mf">0.0_real128</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">r128</span><span class="o">&gt;=</span><span class="mf">0.0_real128</span><span class="p">),</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;real128&#39;</span><span class="p">)</span>
<a name="ln-2225"></a>
<a name="ln-2226"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2227"></a><span class="k">end subroutine </span><span class="n">test_nan</span>
<a name="ln-2228"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2229"></a><span class="k">subroutine </span><span class="n">test_is_even</span><span class="p">()</span>
<a name="ln-2230"></a><span class="kt">logical</span><span class="p">,</span><span class="k">parameter</span>     <span class="kd">::</span> <span class="n">t</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2231"></a><span class="kt">logical</span><span class="p">,</span><span class="k">parameter</span>     <span class="kd">::</span> <span class="n">f</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2232"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;is_even&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2233"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;is_even&#39;</span><span class="p">,</span> <span class="k">all</span><span class="p">(</span><span class="n">is_even</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]).</span><span class="n">eqv</span><span class="p">.[</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">f</span><span class="p">]),</span> <span class="s1">&#39;-10, 0, 1, 2, 3&#39;</span><span class="p">)</span>
<a name="ln-2234"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;is_even&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2235"></a><span class="k">end subroutine </span><span class="n">test_is_even</span>
<a name="ln-2236"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2237"></a><span class="k">subroutine </span><span class="n">test_is_nan</span><span class="p">()</span>
<a name="ln-2238"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="k">save</span> <span class="kd">::</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;NaN&#39;</span>
<a name="ln-2239"></a><span class="kt">real</span>                  <span class="kd">::</span> <span class="n">x</span>
<a name="ln-2240"></a><span class="kt">logical</span><span class="p">,</span><span class="k">parameter</span>     <span class="kd">::</span> <span class="n">t</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2241"></a><span class="kt">logical</span><span class="p">,</span><span class="k">parameter</span>     <span class="kd">::</span> <span class="n">f</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2242"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;is_nan&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2243"></a>   <span class="k">read</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="n">x</span>
<a name="ln-2244"></a><span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;is_nan&#39;</span><span class="p">,</span> <span class="k">all</span><span class="p">(</span><span class="n">is_nan</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">10</span><span class="mf">0.0</span><span class="p">,</span><span class="nb">huge</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)]).</span><span class="n">eqv</span><span class="p">.[</span><span class="n">t</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">f</span><span class="p">]),</span>  <span class="p">&amp;</span>
<a name="ln-2245"></a>        <span class="p">&amp;</span> <span class="s1">&#39;checking&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">10</span><span class="mf">0.0</span><span class="p">,</span><span class="nb">huge</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
<a name="ln-2246"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;is_nan&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2247"></a><span class="k">end subroutine </span><span class="n">test_is_nan</span>
<a name="ln-2248"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2249"></a><span class="k">subroutine </span><span class="n">test_inf</span><span class="p">()</span>
<a name="ln-2250"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2251"></a>   <span class="c">!!call unit_check(&#39;inf&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2252"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2253"></a><span class="k">end subroutine </span><span class="n">test_inf</span>
<a name="ln-2254"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2255"></a><span class="k">subroutine </span><span class="n">test_acosd</span><span class="p">()</span>
<a name="ln-2256"></a>
<a name="ln-2257"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;acosd&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2258"></a>   <span class="c">!!call unit_check(&#39;acosd&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2259"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;acosd&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2260"></a><span class="k">end subroutine </span><span class="n">test_acosd</span>
<a name="ln-2261"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2262"></a><span class="k">subroutine </span><span class="n">test_asind</span><span class="p">()</span>
<a name="ln-2263"></a>
<a name="ln-2264"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;asind&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2265"></a>   <span class="c">!!call unit_check(&#39;asind&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2266"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;asind&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2267"></a><span class="k">end subroutine </span><span class="n">test_asind</span>
<a name="ln-2268"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2269"></a><span class="k">subroutine </span><span class="n">test_atan2d</span><span class="p">()</span>
<a name="ln-2270"></a>
<a name="ln-2271"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;atan2d&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2272"></a>   <span class="c">!!call unit_check(&#39;atan2d&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2273"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;atan2d&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2274"></a><span class="k">end subroutine </span><span class="n">test_atan2d</span>
<a name="ln-2275"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2276"></a><span class="k">subroutine </span><span class="n">test_atand</span><span class="p">()</span>
<a name="ln-2277"></a>
<a name="ln-2278"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;atand&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2279"></a>   <span class="c">!!call unit_check(&#39;atand&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2280"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;atand&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2281"></a><span class="k">end subroutine </span><span class="n">test_atand</span>
<a name="ln-2282"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2283"></a><span class="k">subroutine </span><span class="n">test_atomnum2symbol</span><span class="p">()</span>
<a name="ln-2284"></a>
<a name="ln-2285"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;atomnum2symbol&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2286"></a>   <span class="c">!!call unit_check(&#39;atomnum2symbol&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2287"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;atomnum2symbol&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2288"></a><span class="k">end subroutine </span><span class="n">test_atomnum2symbol</span>
<a name="ln-2289"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2290"></a><span class="k">subroutine </span><span class="n">test_c2f</span><span class="p">()</span>
<a name="ln-2291"></a>
<a name="ln-2292"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;c2f&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2293"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;c2f&#39;</span><span class="p">,</span>     <span class="n">c2f</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>   <span class="p">,</span>  <span class="mi">3</span><span class="mf">2.0</span><span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2294"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;c2f&#39;</span><span class="p">,</span>     <span class="n">c2f</span><span class="p">(</span><span class="mi">10</span><span class="mf">0.0</span><span class="p">)</span> <span class="p">,</span> <span class="mi">21</span><span class="mf">2.0</span><span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2295"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;c2f&#39;</span><span class="p">,</span>     <span class="n">c2f</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="mf">0.0</span><span class="p">)</span> <span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="mf">0.0</span><span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2296"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;c2f&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2297"></a><span class="k">end subroutine </span><span class="n">test_c2f</span>
<a name="ln-2298"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2299"></a><span class="k">subroutine </span><span class="n">test_cartesian_to_polar</span><span class="p">()</span>
<a name="ln-2300"></a>
<a name="ln-2301"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;cartesian_to_polar&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2302"></a>   <span class="c">!!call unit_check(&#39;cartesian_to_polar&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2303"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;cartesian_to_polar&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2304"></a><span class="k">end subroutine </span><span class="n">test_cartesian_to_polar</span>
<a name="ln-2305"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2306"></a><span class="k">subroutine </span><span class="n">test_cartesian_to_spherical</span><span class="p">()</span>
<a name="ln-2307"></a>
<a name="ln-2308"></a><span class="k">use </span><span class="n">M_verify</span><span class="p">,</span>  <span class="k">only</span> <span class="p">:</span> <span class="n">accdig</span>
<a name="ln-2309"></a><span class="k">implicit none</span>
<a name="ln-2310"></a><span class="kt">real</span>    <span class="kd">::</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.0</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.0</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.0</span>
<a name="ln-2311"></a><span class="kt">real</span>    <span class="kd">::</span> <span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">azimuth</span>
<a name="ln-2312"></a><span class="kt">real</span>    <span class="kd">::</span> <span class="n">acurcy</span>
<a name="ln-2313"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ind1</span><span class="p">,</span><span class="n">ind2</span><span class="p">,</span><span class="n">ind3</span>
<a name="ln-2314"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;cartesian_to_spherical&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2315"></a>
<a name="ln-2316"></a>   <span class="c">! 10,10,10 -&gt; 17.32, 0.9553, 0.7854</span>
<a name="ln-2317"></a>   <span class="k">call </span><span class="n">cartesian_to_spherical</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">azimuth</span><span class="p">)</span>
<a name="ln-2318"></a>   <span class="k">call </span><span class="n">accdig</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span>      <span class="mi">1</span><span class="mf">7.3205090</span><span class="p">,</span>   <span class="mf">5.0</span><span class="p">,</span><span class="n">acurcy</span><span class="p">,</span><span class="n">ind1</span><span class="p">)</span>
<a name="ln-2319"></a>   <span class="k">call </span><span class="n">accdig</span><span class="p">(</span><span class="n">inclination</span><span class="p">,</span>  <span class="mf">0.955316663</span> <span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="n">acurcy</span><span class="p">,</span><span class="n">ind2</span><span class="p">)</span>
<a name="ln-2320"></a>   <span class="k">call </span><span class="n">accdig</span><span class="p">(</span><span class="n">azimuth</span><span class="p">,</span>      <span class="mf">0.785398185</span> <span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="n">acurcy</span><span class="p">,</span><span class="n">ind3</span><span class="p">)</span>
<a name="ln-2321"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;cartesian_to_spherical&#39;</span><span class="p">,</span><span class="k">all</span><span class="p">([</span><span class="n">ind1</span><span class="p">,</span><span class="n">ind2</span><span class="p">,</span><span class="n">ind3</span><span class="p">].</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="s1">&#39;to&#39;</span><span class="p">,</span><span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">azimuth</span><span class="p">)</span>
<a name="ln-2322"></a>
<a name="ln-2323"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;cartesian_to_spherical&#39;</span><span class="p">)</span> <span class="c">! if got here without being stopped assume passed test</span>
<a name="ln-2324"></a><span class="k">end subroutine </span><span class="n">test_cartesian_to_spherical</span>
<a name="ln-2325"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2326"></a><span class="k">subroutine </span><span class="n">test_cosd</span><span class="p">()</span>
<a name="ln-2327"></a>
<a name="ln-2328"></a><span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">values</span><span class="p">(:)</span>
<a name="ln-2329"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">i</span>
<a name="ln-2330"></a><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">3</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">4</span><span class="mf">5.0</span><span class="p">,</span> <span class="mi">6</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">9</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">12</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">13</span><span class="mf">5.0</span><span class="p">,</span> <span class="mi">15</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">18</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">21</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">24</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">27</span><span class="mf">3.0</span><span class="p">,</span> <span class="mi">30</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">33</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">36</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="mf">5.0</span><span class="p">]</span>
<a name="ln-2331"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;cosd&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2332"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<a name="ln-2333"></a>      <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;cosd&#39;</span><span class="p">,</span> <span class="n">cosd</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span> <span class="nb">cos</span><span class="p">(</span><span class="n">d2r</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span><span class="n">message</span><span class="o">=</span><span class="n">str</span><span class="p">(</span><span class="s1">&#39;value=&#39;</span><span class="p">,</span><span class="n">values</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2334"></a>   <span class="k">enddo</span>
<a name="ln-2335"></a><span class="k">   call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;cosd&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2336"></a>
<a name="ln-2337"></a><span class="c">!  unit_check:       cosd  FAILED:cosd 6.12323426E-17 -4.37113883E-08 value= 90.0000000 accuracy= 0.00000000 asked for 6 digits</span>
<a name="ln-2338"></a><span class="c">!  unit_check:       cosd  FAILED:cosd -1.83697015E-16 1.19248806E-08 value= 270.000000 accuracy= 0.00000000 asked for 6 digits</span>
<a name="ln-2339"></a><span class="k">end subroutine </span><span class="n">test_cosd</span>
<a name="ln-2340"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2341"></a><span class="k">subroutine </span><span class="n">test_d2r</span><span class="p">()</span>
<a name="ln-2342"></a>
<a name="ln-2343"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2344"></a>
<a name="ln-2345"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>    <span class="mf">0.0</span><span class="p">)</span>    <span class="p">,</span> <span class="mf">0.0</span>       <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;real for 0&#39;</span><span class="p">)</span>
<a name="ln-2346"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>   <span class="mi">4</span><span class="mf">5.0</span><span class="p">)</span>    <span class="p">,</span> <span class="n">PI</span><span class="o">/</span><span class="mf">4.0</span>    <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;real for 45&#39;</span><span class="p">)</span>
<a name="ln-2347"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>  <span class="o">-</span><span class="mi">4</span><span class="mf">5.0</span><span class="p">)</span>    <span class="p">,</span> <span class="o">-</span><span class="n">PI</span><span class="o">/</span><span class="mf">4.0</span>   <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;real for -45&#39;</span><span class="p">)</span>
<a name="ln-2348"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>   <span class="mi">9</span><span class="mf">0.0</span><span class="p">)</span>    <span class="p">,</span> <span class="n">PI</span><span class="o">/</span><span class="mi">2</span>      <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;real for 90&#39;</span><span class="p">)</span>
<a name="ln-2349"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>  <span class="mi">18</span><span class="mf">0.0</span><span class="p">)</span>    <span class="p">,</span> <span class="n">PI</span>        <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;real for 180&#39;</span><span class="p">)</span>
<a name="ln-2350"></a>
<a name="ln-2351"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>  <span class="mf">0.0d0</span><span class="p">)</span>    <span class="p">,</span> <span class="mf">0.0d0</span>     <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;double for 0&#39;</span><span class="p">)</span>
<a name="ln-2352"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>  <span class="mi">4</span><span class="mf">5.0d0</span><span class="p">)</span>   <span class="p">,</span> <span class="n">PI</span><span class="o">/</span><span class="mf">4.0d0</span>  <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;double for 45&#39;</span><span class="p">)</span>
<a name="ln-2353"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>  <span class="o">-</span><span class="mi">4</span><span class="mf">5.0d0</span><span class="p">)</span>  <span class="p">,</span> <span class="o">-</span><span class="n">PI</span><span class="o">/</span><span class="mf">4.0d0</span> <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;double for -45&#39;</span><span class="p">)</span>
<a name="ln-2354"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>  <span class="mi">9</span><span class="mf">0.0d0</span><span class="p">)</span>   <span class="p">,</span> <span class="n">PI</span><span class="o">/</span><span class="mi">2</span><span class="n">d0</span>    <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;double for 90&#39;</span><span class="p">)</span>
<a name="ln-2355"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>  <span class="mi">18</span><span class="mf">0.0d0</span><span class="p">)</span>  <span class="p">,</span> <span class="n">PI</span>        <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;double for 180&#39;</span><span class="p">)</span>
<a name="ln-2356"></a>
<a name="ln-2357"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>      <span class="p">,</span> <span class="mf">0.0</span>       <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;integer for 0&#39;</span><span class="p">)</span>
<a name="ln-2358"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>   <span class="mi">45</span><span class="p">)</span>      <span class="p">,</span> <span class="n">PI</span><span class="o">/</span><span class="mf">4.0</span>    <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;integer for 45&#39;</span><span class="p">)</span>
<a name="ln-2359"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>  <span class="o">-</span><span class="mi">45</span><span class="p">)</span>      <span class="p">,</span> <span class="o">-</span><span class="n">PI</span><span class="o">/</span><span class="mf">4.0</span>   <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;integer for -45&#39;</span><span class="p">)</span>
<a name="ln-2360"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>   <span class="mi">90</span><span class="p">)</span>      <span class="p">,</span> <span class="n">PI</span><span class="o">/</span><span class="mi">2</span>      <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;integer for 90&#39;</span><span class="p">)</span>
<a name="ln-2361"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span> <span class="n">d2r</span><span class="p">(</span>  <span class="mi">180</span><span class="p">)</span>      <span class="p">,</span> <span class="n">PI</span>        <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;integer for 180&#39;</span><span class="p">)</span>
<a name="ln-2362"></a>
<a name="ln-2363"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;d2r&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2364"></a>
<a name="ln-2365"></a><span class="k">end subroutine </span><span class="n">test_d2r</span>
<a name="ln-2366"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2367"></a><span class="k">subroutine </span><span class="n">test_f2c</span><span class="p">()</span>
<a name="ln-2368"></a>
<a name="ln-2369"></a><span class="k">use </span><span class="n">M_verify</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">unit_check_start</span><span class="p">,</span><span class="n">unit_check</span><span class="p">,</span><span class="n">unit_check_done</span><span class="p">,</span><span class="n">unit_check_good</span><span class="p">,</span><span class="n">unit_check_bad</span><span class="p">,</span><span class="n">unit_check_msg</span>
<a name="ln-2370"></a><span class="k">use </span><span class="n">M_verify</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">unit_check_level</span>
<a name="ln-2371"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;f2c&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2372"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;f2c&#39;</span><span class="p">,</span>     <span class="n">f2c</span><span class="p">(</span><span class="mi">3</span><span class="mf">2.0</span><span class="p">)</span>  <span class="p">,</span>   <span class="mf">0.0</span><span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2373"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;f2c&#39;</span><span class="p">,</span>     <span class="n">f2c</span><span class="p">(</span><span class="mi">21</span><span class="mf">2.0</span><span class="p">)</span> <span class="p">,</span> <span class="mi">10</span><span class="mf">0.0</span><span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2374"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;f2c&#39;</span><span class="p">,</span>     <span class="n">f2c</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="mf">0.0</span><span class="p">)</span> <span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="mf">0.0</span><span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2375"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;f2c&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2376"></a><span class="k">end subroutine </span><span class="n">test_f2c</span>
<a name="ln-2377"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2378"></a><span class="k">subroutine </span><span class="n">test_feet_to_meters</span><span class="p">()</span>
<a name="ln-2379"></a><span class="n">doubleprecision</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">f2m</span><span class="o">=</span><span class="mf">0.3048d0</span>
<a name="ln-2380"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;feet_to_meters&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39; 0.3048&#39;</span><span class="p">)</span>
<a name="ln-2381"></a>
<a name="ln-2382"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;feet_to_meters&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2383"></a>      <span class="p">&amp;</span> <span class="k">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">feet_to_meters</span><span class="p">([</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">1</span><span class="mf">2.0</span><span class="p">])</span><span class="o">-</span> <span class="p">[</span><span class="o">-</span><span class="n">f2m</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">f2m</span><span class="p">,</span> <span class="mf">0.0254d0</span><span class="p">]).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.00001</span><span class="p">),</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<a name="ln-2384"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;feet_to_meters&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2385"></a>      <span class="p">&amp;</span> <span class="k">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">feet_to_meters</span><span class="p">([</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">1</span>   <span class="p">])</span><span class="o">-</span> <span class="p">[</span><span class="o">-</span><span class="n">f2m</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">f2m</span><span class="p">]).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.00001</span><span class="p">),</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>
<a name="ln-2386"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;feet_to_meters&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2387"></a>      <span class="p">&amp;</span> <span class="k">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">([</span><span class="n">feet_to_meters</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">),</span><span class="n">feet_to_meters</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">),</span><span class="n">feet_to_meters</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">)]</span><span class="o">-</span><span class="p">[</span><span class="o">-</span><span class="n">f2m</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">f2m</span><span class="p">]).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.00001</span><span class="p">),</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>
<a name="ln-2388"></a>
<a name="ln-2389"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;feet_to_meters&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2390"></a><span class="k">end subroutine </span><span class="n">test_feet_to_meters</span>
<a name="ln-2391"></a>
<a name="ln-2392"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2393"></a><span class="k">subroutine </span><span class="n">test_meters_to_feet</span><span class="p">()</span>
<a name="ln-2394"></a>   <span class="n">doubleprecision</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">m2f</span><span class="o">=</span><span class="mf">3.2808398950131233595d0</span>
<a name="ln-2395"></a>
<a name="ln-2396"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;meters_to_feet&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;3.2808398950131233595&#39;</span><span class="p">)</span>
<a name="ln-2397"></a>
<a name="ln-2398"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;meters_to_feet&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2399"></a>     <span class="p">&amp;</span> <span class="k">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">meters_to_feet</span><span class="p">([</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">])</span><span class="o">-</span><span class="p">[</span><span class="o">-</span><span class="n">m2f</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">m2f</span><span class="p">]).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.00001d0</span><span class="p">),</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<a name="ln-2400"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;meters_to_feet&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2401"></a>     <span class="p">&amp;</span> <span class="k">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">meters_to_feet</span><span class="p">([</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">1</span>   <span class="p">])</span><span class="o">-</span><span class="p">[</span><span class="o">-</span><span class="n">m2f</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">m2f</span><span class="p">]).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.00001d0</span><span class="p">)</span> <span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>
<a name="ln-2402"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;meters_to_feet&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2403"></a>     <span class="p">&amp;</span> <span class="k">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">([</span><span class="n">meters_to_feet</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">d0</span><span class="p">),</span><span class="n">meters_to_feet</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">),</span><span class="n">meters_to_feet</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">)]</span><span class="o">-</span><span class="p">[</span><span class="o">-</span><span class="n">m2f</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">m2f</span><span class="p">]).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.00001d0</span><span class="p">),</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>
<a name="ln-2404"></a>
<a name="ln-2405"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;meters_to_feet&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2406"></a><span class="k">end subroutine </span><span class="n">test_meters_to_feet</span>
<a name="ln-2407"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2408"></a><span class="k">subroutine </span><span class="n">test_norm_angle_deg_double</span><span class="p">()</span>
<a name="ln-2409"></a>
<a name="ln-2410"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;norm_angle_deg_double&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2411"></a>   <span class="c">!!call unit_check(&#39;norm_angle_deg_double&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2412"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;norm_angle_deg_double&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2413"></a><span class="k">end subroutine </span><span class="n">test_norm_angle_deg_double</span>
<a name="ln-2414"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2415"></a><span class="k">subroutine </span><span class="n">test_norm_angle_deg_integer</span><span class="p">()</span>
<a name="ln-2416"></a>
<a name="ln-2417"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;norm_angle_deg_integer&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2418"></a>   <span class="c">!!call unit_check(&#39;norm_angle_deg_integer&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2419"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;norm_angle_deg_integer&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2420"></a><span class="k">end subroutine </span><span class="n">test_norm_angle_deg_integer</span>
<a name="ln-2421"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2422"></a><span class="k">subroutine </span><span class="n">test_norm_angle_deg_real</span><span class="p">()</span>
<a name="ln-2423"></a>
<a name="ln-2424"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;norm_angle_deg_real&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2425"></a>   <span class="c">!!call unit_check(&#39;norm_angle_deg_real&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2426"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;norm_angle_deg_real&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2427"></a><span class="k">end subroutine </span><span class="n">test_norm_angle_deg_real</span>
<a name="ln-2428"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2429"></a><span class="k">subroutine </span><span class="n">test_norm_angle_rad</span><span class="p">()</span>
<a name="ln-2430"></a>
<a name="ln-2431"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;norm_angle_rad&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2432"></a>   <span class="c">!!call unit_check(&#39;norm_angle_rad&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2433"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;norm_angle_rad&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2434"></a><span class="k">end subroutine </span><span class="n">test_norm_angle_rad</span>
<a name="ln-2435"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2436"></a><span class="k">subroutine </span><span class="n">test_polar_to_cartesian</span><span class="p">()</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;polar_to_cartesian&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2439"></a>   <span class="c">!!call unit_check(&#39;polar_to_cartesian&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2440"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;polar_to_cartesian&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2441"></a><span class="k">end subroutine </span><span class="n">test_polar_to_cartesian</span>
<a name="ln-2442"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2443"></a><span class="k">subroutine </span><span class="n">test_pounds_to_kilograms</span><span class="p">()</span>
<a name="ln-2444"></a>
<a name="ln-2445"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;pounds_to_kilograms&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2446"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;pounds_to_kilograms&#39;</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">pounds_to_kilograms</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">-</span><span class="mf">0.45359237</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.00001</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<a name="ln-2447"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;pounds_to_kilograms&#39;</span><span class="p">,</span><span class="nb">any</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pounds_to_kilograms</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span> <span class="p">])</span><span class="o">-</span><span class="p">&amp;</span>
<a name="ln-2448"></a>      <span class="p">&amp;[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.45359237</span><span class="p">,</span> <span class="mi">4</span><span class="mf">5.359237</span><span class="p">,</span><span class="mi">9</span><span class="mf">0.718474</span><span class="p">]).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.00001</span><span class="p">),</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>
<a name="ln-2449"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;pounds_to_kilograms&#39;</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">pounds_to_kilograms</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">)</span><span class="o">-</span><span class="mf">0.45359237</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.00001</span><span class="p">,</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>
<a name="ln-2450"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;pounds_to_kilograms&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2451"></a><span class="k">end subroutine </span><span class="n">test_pounds_to_kilograms</span>
<a name="ln-2452"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2453"></a><span class="k">subroutine </span><span class="n">test_r2d</span><span class="p">()</span>
<a name="ln-2454"></a>
<a name="ln-2455"></a><span class="kt">real</span>              <span class="kd">::</span> <span class="n">x</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">PI</span><span class="p">)</span>
<a name="ln-2456"></a><span class="n">doubleprecision</span>   <span class="kd">::</span> <span class="n">d</span><span class="o">=</span><span class="n">PI</span>
<a name="ln-2457"></a>
<a name="ln-2458"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2459"></a>
<a name="ln-2460"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span>  <span class="mf">0.0</span><span class="p">)</span>      <span class="p">,</span>   <span class="mf">0.0</span>    <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<a name="ln-2461"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span>  <span class="n">x</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>      <span class="p">,</span>  <span class="mi">4</span><span class="mf">5.0</span>    <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<a name="ln-2462"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span> <span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>      <span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="mf">5.0</span>    <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<a name="ln-2463"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span>  <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>      <span class="p">,</span>  <span class="mi">9</span><span class="mf">0.0</span>    <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<a name="ln-2464"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span>  <span class="n">x</span><span class="p">)</span>        <span class="p">,</span> <span class="mi">18</span><span class="mf">0.0</span>    <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<a name="ln-2465"></a>
<a name="ln-2466"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span>  <span class="mf">0.0d0</span><span class="p">)</span>    <span class="p">,</span>   <span class="mf">0.0d0</span>  <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>
<a name="ln-2467"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span>  <span class="n">d</span><span class="o">/</span><span class="mf">4.0d0</span><span class="p">)</span>  <span class="p">,</span>  <span class="mi">4</span><span class="mf">5.0d0</span>  <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>
<a name="ln-2468"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span> <span class="o">-</span><span class="n">d</span><span class="o">/</span><span class="mf">4.0d0</span><span class="p">)</span>  <span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="mf">5.0d0</span>  <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>
<a name="ln-2469"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span>  <span class="n">d</span><span class="o">/</span><span class="mf">2.0d0</span><span class="p">)</span>  <span class="p">,</span>  <span class="mi">9</span><span class="mf">0.0d0</span>  <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>
<a name="ln-2470"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span>  <span class="n">d</span><span class="p">)</span>        <span class="p">,</span> <span class="mi">18</span><span class="mf">0.0d0</span>  <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>
<a name="ln-2471"></a>
<a name="ln-2472"></a>   <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span> <span class="n">r2d</span><span class="p">(</span>  <span class="mi">0</span><span class="p">)</span>        <span class="p">,</span>   <span class="mf">0.0</span>    <span class="p">,</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>
<a name="ln-2473"></a>
<a name="ln-2474"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;r2d&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2475"></a><span class="k">end subroutine </span><span class="n">test_r2d</span>
<a name="ln-2476"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2477"></a><span class="k">subroutine </span><span class="n">test_sind</span><span class="p">()</span>
<a name="ln-2478"></a>
<a name="ln-2479"></a><span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">values</span><span class="p">(:)</span>
<a name="ln-2480"></a><span class="kt">integer</span>           <span class="kd">::</span> <span class="n">i</span>
<a name="ln-2481"></a>   <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">3</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">4</span><span class="mf">5.0</span><span class="p">,</span> <span class="mi">6</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">9</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">12</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">13</span><span class="mf">5.0</span><span class="p">,</span> <span class="mi">15</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">18</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">21</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">24</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">27</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">30</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">33</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">36</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="mf">5.0</span><span class="p">]</span>
<a name="ln-2482"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;sind&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2483"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<a name="ln-2484"></a>      <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;sind&#39;</span><span class="p">,</span>   <span class="n">sind</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>             <span class="p">,</span>  <span class="nb">sin</span><span class="p">(</span><span class="n">d2r</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span><span class="n">message</span><span class="o">=</span><span class="n">str</span><span class="p">(</span><span class="s1">&#39;value=&#39;</span><span class="p">,</span><span class="n">values</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>  <span class="p">)</span>
<a name="ln-2485"></a>   <span class="k">enddo</span>
<a name="ln-2486"></a><span class="k">   call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;sind&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2487"></a><span class="c">! unit_check:       sind  FAILED:sind 1.22464685E-16 -8.74227766E-08 value= 180.000000 accuracy= 0.00000000 asked for 6 digits</span>
<a name="ln-2488"></a><span class="c">! unit_check:       sind  FAILED:sind -2.44929371E-16 1.74845553E-07 value= 360.000000 accuracy= 0.00000000 asked for 6 digits</span>
<a name="ln-2489"></a><span class="k">end subroutine </span><span class="n">test_sind</span>
<a name="ln-2490"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2491"></a><span class="k">subroutine </span><span class="n">test_spherical_to_cartesian</span><span class="p">()</span>
<a name="ln-2492"></a><span class="k">use </span><span class="n">M_verify</span><span class="p">,</span>  <span class="k">only</span> <span class="p">:</span> <span class="n">accdig</span>
<a name="ln-2493"></a><span class="k">implicit none</span>
<a name="ln-2494"></a><span class="kt">real</span>    <span class="kd">::</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span>
<a name="ln-2495"></a><span class="kt">real</span>    <span class="kd">::</span> <span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">azimuth</span>
<a name="ln-2496"></a><span class="kt">real</span>    <span class="kd">::</span> <span class="n">acurcy</span>
<a name="ln-2497"></a><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ind1</span><span class="p">,</span><span class="n">ind2</span><span class="p">,</span><span class="n">ind3</span>
<a name="ln-2498"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;spherical_to_cartesian&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2499"></a>
<a name="ln-2500"></a>   <span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="mf">7.32</span><span class="p">;</span> <span class="n">inclination</span><span class="o">=</span><span class="mf">0.9553</span><span class="p">;</span> <span class="n">azimuth</span><span class="o">=</span><span class="mf">0.7854</span>
<a name="ln-2501"></a>   <span class="n">x</span><span class="o">=-</span><span class="mi">9999</span><span class="p">;</span> <span class="n">y</span><span class="o">=-</span><span class="mi">9999</span><span class="p">;</span> <span class="n">z</span><span class="o">=-</span><span class="mi">9999</span><span class="p">;</span>
<a name="ln-2502"></a>   <span class="k">call </span><span class="n">spherical_to_cartesian</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">azimuth</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
<a name="ln-2503"></a>
<a name="ln-2504"></a>   <span class="k">call </span><span class="n">accdig</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="n">acurcy</span><span class="p">,</span><span class="n">ind1</span><span class="p">)</span>
<a name="ln-2505"></a>   <span class="k">call </span><span class="n">accdig</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="n">acurcy</span><span class="p">,</span><span class="n">ind2</span><span class="p">)</span>
<a name="ln-2506"></a>   <span class="k">call </span><span class="n">accdig</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="mi">1</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="n">acurcy</span><span class="p">,</span><span class="n">ind3</span><span class="p">)</span>
<a name="ln-2507"></a>
<a name="ln-2508"></a>   <span class="k">call </span><span class="n">unit_check</span><span class="p">(</span><span class="s1">&#39;spherical_to_cartesian&#39;</span><span class="p">,</span><span class="k">all</span><span class="p">([</span><span class="n">ind1</span><span class="p">,</span><span class="n">ind2</span><span class="p">,</span><span class="n">ind3</span><span class="p">].</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">),</span><span class="n">radius</span><span class="p">,</span><span class="n">inclination</span><span class="p">,</span><span class="n">azimuth</span><span class="p">,</span><span class="s1">&#39;to&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
<a name="ln-2509"></a>
<a name="ln-2510"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;spherical_to_cartesian&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2511"></a><span class="k">end subroutine </span><span class="n">test_spherical_to_cartesian</span>
<a name="ln-2512"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2513"></a><span class="k">subroutine </span><span class="n">test_symbol2atomnum</span><span class="p">()</span>
<a name="ln-2514"></a>
<a name="ln-2515"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;symbol2atomnum&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2516"></a>   <span class="c">!!call unit_check(&#39;symbol2atomnum&#39;, 0.eq.0, &#39;checking&#39;, 100)</span>
<a name="ln-2517"></a>   <span class="k">call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;symbol2atomnum&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2518"></a><span class="k">end subroutine </span><span class="n">test_symbol2atomnum</span>
<a name="ln-2519"></a><span class="c">!TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT</span>
<a name="ln-2520"></a><span class="k">subroutine </span><span class="n">test_tand</span><span class="p">()</span>
<a name="ln-2521"></a><span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">values</span><span class="p">(:)</span>
<a name="ln-2522"></a><span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">i</span>
<a name="ln-2523"></a>   <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">3</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">4</span><span class="mf">5.0</span><span class="p">,</span><span class="mi">6</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">9</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">12</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">13</span><span class="mf">5.0</span><span class="p">,</span><span class="mi">15</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">18</span><span class="mf">3.0</span><span class="p">,</span><span class="mi">21</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">24</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">27</span><span class="mf">3.0</span><span class="p">,</span><span class="mi">30</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">33</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">36</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="mf">5.0</span><span class="p">]</span>
<a name="ln-2524"></a>   <span class="k">call </span><span class="n">unit_check_start</span><span class="p">(</span><span class="s1">&#39;tand&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2525"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<a name="ln-2526"></a>      <span class="k">call </span><span class="n">testit_p</span><span class="p">(</span><span class="s1">&#39;tand&#39;</span><span class="p">,</span> <span class="n">tand</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span> <span class="nb">tan</span><span class="p">(</span><span class="n">d2r</span><span class="p">(</span><span class="n">values</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span><span class="n">message</span><span class="o">=</span><span class="n">str</span><span class="p">(</span><span class="s1">&#39;value=&#39;</span><span class="p">,</span><span class="n">values</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
<a name="ln-2527"></a>   <span class="k">enddo</span>
<a name="ln-2528"></a><span class="k">   call </span><span class="n">unit_check_done</span><span class="p">(</span><span class="s1">&#39;tand&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<a name="ln-2529"></a><span class="c">! unit_check:       tand  FAILED:tand 1.63312395E+16 -22877332.0 value= 90.0000000 accuracy= -8.85361290 asked for 6 digits</span>
<a name="ln-2530"></a><span class="c">! unit_check:       tand  FAILED:tand -1.22464685E-16 8.74227766E-08 value= 180.000000 accuracy= 0.00000000 asked for 6 digits</span>
<a name="ln-2531"></a><span class="c">! unit_check:       tand  FAILED:tand 5.44374649E+15 -83858280.0 value= 270.000000 accuracy= -7.81235218 asked for 6 digits</span>
<a name="ln-2532"></a><span class="c">! unit_check:       tand  FAILED:tand -2.44929371E-16 1.74845553E-07 value= 360.000000 accuracy= 0.00000000 asked for 6 digits</span>
<a name="ln-2533"></a><span class="k">end subroutine </span><span class="n">test_tand</span>
<a name="ln-2534"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2535"></a><span class="k">end subroutine </span><span class="n">test_suite_M_units</span>
<a name="ln-2536"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2537"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2538"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-2539"></a><span class="k">end module </span><span class="n">M_units</span>
<a name="ln-2540"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-2541"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-2542"></a><span class="c">!***********************************************************************************************************************************</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2022 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2022-05-04 21:45  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> M_units was developed by John S. Urban</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>