<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="collection of modules for unit testing and logging and messaging">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>M_framework.f90 &ndash; M_framework</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">M_framework </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/namelists.html">Namelists</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/programs.html">Programs</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>M_framework.f90
      <small>Source File</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 0.2% of total for source files.">9 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/M_framework.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
            <li class="breadcrumb-item active" aria-current="page">M_framework.f90</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
        <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#mods-0"
         aria-expanded="false" aria-controls="mods-0">
         <h4 class="card-header bg-primary text-white">Modules</h4>
      </a>
      <div id="mods-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/m_framework.html">M_framework</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/m_framework.f90.html#src">M_framework.f90</a>
      </div>
    </div>


  </div>

    </div>
    <div class="col-md-9" id='text'>
      <h2 id="name">NAME</h2>
<div class="codehilite"><pre><span></span><code>M_framework(3f) - [M_framework::INTRO] unit test framework
 (LICENSE:PD)
</code></pre></div>

<h2 id="synopsis">SYNOPSIS</h2>
<p>M_framework(3f) is an aggregate of Fortran modules brought together to
 provide unit testing for Fortran; and is particularly well suited for
 use with the Fortran Package Manager (fpm).</p>
<p>The support modules are useful for creating terminal messages, comparing
 expected values to results, writing logfiles and playback journals
 independent of unit testing as well.</p>
<p>Typically unit testing can be integrated seamlessly into the fpm(1) subcommand
 &ldquo;test&rdquo; making unit testing from github/gitlab CD/CI utilities as simple as
 &ldquo;fpm test&rdquo; in many cases.</p>
<p>BASIC TIMING IS INCLUDED
 As well as the expected <strong>pass/fail/skipped unit testing</strong> report.
 basic <strong>timing information</strong> can be produced by the unit testing module
 M_framework__verify(3f).</p>
<p>HOOKS ARE PROVIDED TO EXTERNAL LOCAL APPLICATIONS</p>
<p>M_framework(3f) comes with a unique hook that allows calling your own
 programs to integrate with local logging tools, report generators,
 spreadsheets or other local infrastructure. The example program
 &ldquo;bookkeeper&rdquo; is included that uses the hook to write example report
 data files:</p>
<ul>
<li><a href="https://urbanjost.github.io/M_framework/bookkeeper.csv">CSV</a>,</li>
<li><a href="https://urbanjost.github.io/M_framework/bookkeeper.html">HTML</a></li>
<li><a href="https://urbanjost.github.io/M_framework/bookkeeper.nml">NAMELIST</a></li>
</ul>
<p>The hook can call any local program with an interface similar to
 &ldquo;bookkeeper&rdquo;. This allows modifying the program for local needs such
 as sending e-mail alerts and so on without having to change the tests.</p>
<p>MESSAGES CAN BE COMPOSED ALMOST LIKE LIST-DIRECTED I/O
 Messages can be composed of up to twenty scalar intrinsic variables,
 allowing freedom in writing messages akin to that of list-directed I/O;
 but simultaneously to a list of output units. This easily lets messages
 go to stdout or stderr and a file of the user&rsquo;s choosing as well. Output
 can even be sent to a scratch file, essentially creating a quiet mode.</p>
<div class="codehilite"><pre><span></span><code><span class="nv">DESIGNED</span> <span class="k">FOR</span> <span class="nv">INTEGRATION</span> <span class="nv">WITH</span> <span class="nv">FPM</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span>
</code></pre></div>

<p>In conjunction with fpm(1) it is easy to run the tests with the &ndash;runner
 option, allowing for integration with other utilities as well such as
 the GNU debugger gdb(1), valgrind(1), and other tools.</p>
<div class="codehilite"><pre><span></span><code>PROGRAMS INCLUDED TO GENERATE SKELETON TEST PROGRAM
</code></pre></div>

<p>Example programs are provided to create unit test skeleton programs to
 ease usage.</p>
<div class="codehilite"><pre><span></span><code>EASILY USED WITH GITHUB CD/CI
</code></pre></div>

<p>Example CD/CI scripts that can be used with github are in the .github/
 directory that assume your tests can by run by using &ldquo;fpm test&rdquo;.</p>
<div class="codehilite"><pre><span></span><code>MOTIVATION
</code></pre></div>

<p>Including <strong>unit testing</strong> is strongly encouraged for any software package,
 but particularly when it is to be used in programming environments the
 package was not developed in.</p>
<p>This is the typical case for public fpm(1) packages on github.</p>
<p>Additionally the proposed rules for registered fpm(1) package repositories
 include requiring package candidates themselves only have external
 dependencies that are also registered repository packages ( of course
 wrappers of C libraries or other existing libraries cannot easily be
 conformed to this).</p>
<p>As a result &ndash; this project concentrates on tools for a procedural unit
 testing framework based on nothing but standard Fortran that specifically
 can be used as a remote fpm(1) dependency in fpm(1) packages that may
 reside in public github repositories.</p>
<p>That is, it is designed to be integrated with the fpm(1) &ldquo;test&rdquo; subcommand
 as an external dependency. It is intended to have little or no other
 dependencies and ultimately become a registered fpm(1) package to aid in
 the development of the fpm(1) repository.</p>
<p>That being said, it can be used standalone as well.</p>
<h2 id="description">DESCRIPTION</h2>
<p>Unit testing allows you to automatically confirm changes are acceptable
 so you can quickly and confidently make and release changes. But many of
 the operations required for testing are useful generically. So this
 project is broken down into small general-purpose modules and
 one unit-testing-specific one.</p>
<p>M_framework(3f) is composed of the following individual modules:</p>
<ul>
<li>
<p><strong>M_framework__msg</strong> is a small module that in particular
    can convert a list of variables of any of the common default types
    to a string.</p>
<p>It performs low-level operations that are often used by other larger
modules so it is its own module to prevent circular dependencies.</p>
</li>
<li>
<p><strong>M_framework__journal__</strong> allows for creating log and journal files</p>
</li>
<li>
<p><strong>M_framework__approx</strong> contains routines for rounding and comparing
    floating-point values.</p>
</li>
<li>
<p><strong>M_framework__help</strong> provides for creating a standard simple
    interactive help facility</p>
</li>
<li>
<p><strong>M_framework__verify</strong> is at the heart of the collection and
    handles virtually all the unit-test-specific operations.</p>
</li>
</ul>
<p>The procedures can be used in a variety of ways. After using them for
 a long time my typical usage has changed completely several times.</p>
<p>As part of private software there was little problem calling the
 procedures directly from within the modules where they resided; and even
 auto-detecting the routines (a naming convention of &ldquo;test_suite_$NAME&rdquo;
 was used). The routines were pre-installed on virtually all platforms
 so using them was no more a burden than say, calling an intrinsic.</p>
<p>Put autodetecting tools (at least the ones employed) are not generally
 portable; and with public packages there is a strong incentive to
 minimize the amount of infrastructure and external dependencies. It is
 generally imperative to make package use as simple and generic as possible.</p>
<p>So the suggested scheme is to create a small test program for each
 procedure or closely related procedures in the fpm test/ directory.</p>
<ul>
<li>make a subroutine for each component to be tested</li>
<li>in each test procedure start it with a call to UNIT_TEST_START(3f)</li>
<li>end each test procedure it with a call to UNIT_TEST_END(3f)</li>
<li>make multiple calls to UNIT_TEST(3f) in-between to generate
    test results</li>
<li>call each of those test routines from the main program</li>
<li>end the main program with a call to UNIT_TEST_STOP(3f)</li>
</ul>
<p>Optionally, before starting set preferred non-default modes.</p>
<p>Use the &lsquo;fpm test&rsquo; command to run specific tests; all tests (the default);
 a list of tests or test names using simple globbing.</p>
<p>As desired, command line options can be used to control various test
 behaviors.</p>
<p>As an example, we can create a skeleton program to test a few
 routines. Using</p>
<div class="codehilite"><pre><span></span><code>  fpm test_suite sqrt cos sin &gt; test/test_suite.f90
</code></pre></div>

<p>to create the skeleton program and then adding a few actual
 calls to unit_test_test(3f) results in</p>
<p>Sample program:</p>
<div class="codehilite"><pre><span></span><code><span class="n">program</span><span class="w"> </span><span class="n">M_test_suite_M_intrinsics</span><span class="w"></span>
<span class="n">use</span><span class="p">,</span><span class="n">intrinsic</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="w"></span>
<span class="o">&amp;</span><span class="w"> </span><span class="n">stderr</span><span class="o">=&gt;</span><span class="n">ERROR_UNIT</span><span class="p">,</span><span class="w"> </span><span class="n">stdin</span><span class="o">=&gt;</span><span class="n">INPUT_UNIT</span><span class="p">,</span><span class="w"> </span><span class="n">stdout</span><span class="o">=&gt;</span><span class="n">OUTPUT_UNIT</span><span class="w"></span>
<span class="o">!</span><span class="w"></span>
<span class="n">use</span><span class="w"> </span><span class="n">M_framework</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">unit_test_start</span><span class="p">,</span><span class="n">unit_test</span><span class="p">,</span><span class="n">unit_test_end</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="w"></span>
<span class="w">                 </span><span class="n">unit_test_mode</span><span class="p">,</span><span class="w"> </span><span class="n">unit_test_level</span><span class="p">,</span><span class="w"> </span><span class="n">unit_test_stop</span><span class="w"></span>
<span class="n">use</span><span class="w"> </span><span class="n">M_framework</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CHECK_PREFIX</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">messages</span><span class="w"></span>
<span class="o">!</span><span class="w"></span>
<span class="o">!</span><span class="n">use</span><span class="w"> </span><span class="n">M_mymodule</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">testing</span><span class="w"></span>
<span class="n">implicit</span><span class="w"> </span><span class="n">none</span><span class="w"></span>
<span class="n">double</span><span class="w"> </span><span class="n">precision</span><span class="p">,</span><span class="n">allocatable</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">expected</span><span class="p">(:),</span><span class="w"> </span><span class="n">answers</span><span class="p">(:),</span><span class="w"> </span><span class="n">input</span><span class="p">(:)</span><span class="w"></span>
<span class="n">double</span><span class="w"> </span><span class="n">precision</span><span class="p">,</span><span class="n">parameter</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="bp">PI</span><span class="o">=</span><span class="nb">atan</span><span class="p">(</span><span class="mf">1.0</span><span class="n">d0</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="w"></span>
<span class="o">!!</span><span class="w"> </span><span class="n">setup</span><span class="w"></span>
<span class="w">   </span><span class="o">!---------------------------------------------------</span><span class="w"></span>
<span class="w">   </span><span class="o">!</span><span class="n">OPTIONAL</span><span class="p">:</span><span class="w"></span>
<span class="w">   </span><span class="o">!</span><span class="w">  </span><span class="n">values</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">various</span><span class="w"> </span><span class="n">messages</span><span class="w"></span>
<span class="w">   </span><span class="o">!</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">basename</span><span class="w"> </span><span class="n">of</span><span class="w"></span>
<span class="w">   </span><span class="o">!</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">tests</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"></span>
<span class="w">   </span><span class="o">!</span><span class="w">  </span><span class="n">altered</span><span class="o">.</span><span class="w"> </span><span class="n">For</span><span class="w"> </span><span class="n">example</span><span class="p">:</span><span class="w"></span>
<span class="w">   </span><span class="n">CHECK_PREFIX</span><span class="o">=</span><span class="n">prefix</span><span class="p">(</span><span class="w">                  </span><span class="o">&amp;</span><span class="w"></span>
<span class="w">    </span><span class="n">test_MSG</span><span class="w">    </span><span class="o">=</span><span class="w">  </span><span class="s1">&#39;test_msg:   &#39;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="w"></span>
<span class="w">    </span><span class="n">test</span><span class="w">        </span><span class="o">=</span><span class="w">  </span><span class="s1">&#39;test:      &#39;</span><span class="p">,</span><span class="w">  </span><span class="o">&amp;</span><span class="w"></span>
<span class="w">    </span><span class="n">test_START</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="s1">&#39;test_start: &#39;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="w"></span>
<span class="w">    </span><span class="n">test_STOP</span><span class="w">   </span><span class="o">=</span><span class="w">  </span><span class="s1">&#39;test_stop:  &#39;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="w"></span>
<span class="w">    </span><span class="n">test_END</span><span class="w">    </span><span class="o">=</span><span class="w">  </span><span class="s1">&#39;test_end:   &#39;</span><span class="w">  </span><span class="o">&amp;</span><span class="w"></span>
<span class="w">   </span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="o">!---------------------------------------------------</span><span class="w"></span>
<span class="w">   </span><span class="o">!</span><span class="n">OPTIONAL</span><span class="p">:</span><span class="w"></span>
<span class="w">   </span><span class="o">!</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">run</span><span class="o">-</span><span class="n">time</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"></span>
<span class="w">   </span><span class="o">!</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="n">selected</span><span class="o">.</span><span class="w"> </span><span class="n">See</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="w">   </span><span class="o">!</span><span class="w"> </span><span class="n">man</span><span class="o">-</span><span class="n">page</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">procedure</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="o">.</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">unit_test_mode</span><span class="p">(</span><span class="w"></span>
<span class="w">     </span><span class="p">(</span><span class="w"> </span><span class="n">keep_going</span><span class="o">=.</span><span class="n">true</span><span class="o">.</span><span class="w"> </span><span class="p">,</span><span class="w"></span>
<span class="w">     </span><span class="n">flags</span><span class="o">=</span><span class="p">[</span><span class="n">character</span><span class="p">(</span><span class="n">len</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">::],</span><span class="w"></span>
<span class="w">     </span><span class="n">luns</span><span class="o">=</span><span class="p">[</span><span class="n">stdout</span><span class="p">],</span><span class="w"></span>
<span class="w">     </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="w"></span>
<span class="w">     </span><span class="n">brief</span><span class="o">=.</span><span class="n">false</span><span class="o">.</span><span class="w"> </span><span class="p">,</span><span class="w"></span>
<span class="w">     </span><span class="n">interactive</span><span class="o">=.</span><span class="n">false</span><span class="o">.</span><span class="w"> </span><span class="p">,</span><span class="w"></span>
<span class="w">     </span><span class="n">CMDLINE</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">     </span><span class="n">debug</span><span class="o">=.</span><span class="n">false</span><span class="o">.</span><span class="w"> </span><span class="p">,</span><span class="w"></span>
<span class="w">     </span><span class="k">match</span><span class="w"></span>
<span class="w">     </span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="o">!---------------------------------------------------</span><span class="w"></span>
<span class="o">!!</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">subroutine</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">test_sqrt</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">test_cos</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">test_sin</span><span class="p">()</span><span class="w"></span>
<span class="o">!!</span><span class="w"> </span><span class="n">teardown</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">unit_test_stop</span><span class="p">()</span><span class="w"></span>
<span class="n">contains</span><span class="w"></span>
<span class="n">subroutine</span><span class="w"> </span><span class="n">test_sqrt</span><span class="p">()</span><span class="w"></span>
<span class="n">integer</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">unit_test_start</span><span class="p">(</span><span class="s1">&#39;sqrt&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;calculate the square root&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">input</span><span class="w">   </span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="n">d0</span><span class="p">,</span><span class="mf">4.0</span><span class="n">d0</span><span class="p">,</span><span class="mf">9.0</span><span class="n">d0</span><span class="p">]</span><span class="w"></span>
<span class="w">   </span><span class="n">expected</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="n">d0</span><span class="p">,</span><span class="mf">2.0</span><span class="n">d0</span><span class="p">,</span><span class="mf">3.0</span><span class="n">d0</span><span class="p">]</span><span class="w"></span>
<span class="w">   </span><span class="n">answers</span><span class="o">=</span><span class="p">[(</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">input</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="n">input</span><span class="p">))]</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">unit_test</span><span class="p">(</span><span class="s1">&#39;sqrt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">eq</span><span class="o">.</span><span class="n">answers</span><span class="p">),</span><span class="o">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">&amp;</span><span class="w"> </span><span class="s1">&#39;check table of values&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">unit_test</span><span class="p">(</span><span class="s1">&#39;sqrt&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">25.0</span><span class="n">d0</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="o">.</span><span class="mf">5.0</span><span class="n">d0</span><span class="p">,</span><span class="o">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="o">&amp;</span><span class="w"> </span><span class="s1">&#39;got&#39;</span><span class="p">,</span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">25.0</span><span class="n">d0</span><span class="p">),</span><span class="s1">&#39;expected&#39;</span><span class="p">,</span><span class="mf">5.0</span><span class="n">d0</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">unit_test_end</span><span class="p">(</span><span class="s1">&#39;sqrt&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>
<span class="n">end</span><span class="w"> </span><span class="n">subroutine</span><span class="w"> </span><span class="n">test_sqrt</span><span class="w"></span>

<span class="n">subroutine</span><span class="w"> </span><span class="n">test_sin</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">unit_test_start</span><span class="p">(</span><span class="s1">&#39;sin&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;calculate the sine of a value&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">unit_test_end</span><span class="p">(</span><span class="s1">&#39;sin&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>
<span class="n">end</span><span class="w"> </span><span class="n">subroutine</span><span class="w"> </span><span class="n">test_sin</span><span class="w"></span>

<span class="n">subroutine</span><span class="w"> </span><span class="n">test_cos</span><span class="p">()</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">unit_test_start</span><span class="p">(</span><span class="s1">&#39;cos&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;calculate the cosine of a value&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="n">call</span><span class="w"> </span><span class="n">unit_test_end</span><span class="p">(</span><span class="s1">&#39;cos&#39;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>
<span class="n">end</span><span class="w"> </span><span class="n">subroutine</span><span class="w"> </span><span class="n">test_cos</span><span class="w"></span>

<span class="n">end</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">M_test_suite_M_intrinsics</span><span class="w"></span>
</code></pre></div>

<p>The output now looks like this (note if no calls to unit_test
 routines are made between unit_test_start(3f) and unit_test_end(3f)
 the procedure gets an &ldquo;UNTESTED&rdquo; entry to remind you to make
 some tests ..).</p>
<div class="codehilite"><pre><span></span><code>&gt; test:       sqrt   SUCCESS : check table of values
&gt; test:       sqrt   SUCCESS : got 5.0000000000000000 expected 5.0000000000000000
&gt; test_end:   sqrt   PASSED  : GOOD:        2 BAD:        0 DURATION:00000000012000:
&gt; test_end:   cos    UNTESTED: GOOD:        0 BAD:        0 DURATION:00000000000000:
&gt; test_end:   sin    UNTESTED: GOOD:        0 BAD:        0 DURATION:00000000000000:
&gt; test_stop:  TALLY  PASSED  : GOOD:        2 BAD:        0 DURATION:00000000000000
&gt; STOP 0
</code></pre></div>

<p>this is a model that works particularly well for basic numeric procedures.</p>
<p>Now it is just a matter of adding more calls to unit_test(3f). This is
 where procedures from the other modules become useful, as they provide
 methods for comparing float values, for example. Since Fortran has
 many powerful masking intrinsics usually just the unit_test(3f) procedure
 is required. In particular, be familiar with the ALL(3f), ANY(3f),
 and PACK(3f) procedures.</p>
<p>There are options to call a system command and use the initial string as
 options, to interactively pause after each check, and to change options
 like which output file to write on, what error level to use, and other
 things I will hopefully solidify and document here.</p>
<div class="codehilite"><pre><span></span><code><span class="n">RECOMMENDED</span> <span class="n">BASIC</span> <span class="n">USAGE</span>
</code></pre></div>

<p>So for an fpm(1) user a recommended process is to create and/or enter the
 test/ directory and use the &ldquo;unit_test&rdquo; program. It will make a test
 program called &ldquo;unit_test_$NAME.f90&rdquo; for each name given on the command
 line.</p>
<p>There is a case made for closely related groups of procedures to share
 a single test file that will be made a little bit later. For that, the
 command &ldquo;test_suite&rdquo; is used instead of &ldquo;unit_test&rdquo;.</p>
<p>For now lets assume we have or plan to have the procedures
 &ldquo;a&rdquo;,&rdquo;b&rdquo;, and &ldquo;c&rdquo; in our package, and that we want to create a test for
 each ( and that unit_test(1) has been installed in your path):</p>
<div class="codehilite"><pre><span></span><code> cd $TOP_OF_FPM_PACKAGE
 cd test
 unit_test a b c
</code></pre></div>

<p>If you then run &ldquo;fpm test&rdquo; the skeleton should run indicating the
 procedures are not tested. Change the routines to actually call the
 &ldquo;unit_test&rdquo; procedure and you have the beginnings of a unit test for
 your procedures.</p>
<p>The &ldquo;unit_test(3f)&rdquo; procedure in its simplest form takes a string that
 is usually the procedure name and a logical expression, along with up
 to twenty completely optional intrinsic scalar values which will be used
 to create an optional message.</p>
<p>The example programs also contain a placeholder call to unit_test_mode(3f).</p>
<div class="codehilite"><pre><span></span><code><span class="k">PROC</span><span class="nv">EDURAL</span><span class="w"> </span><span class="nv">AND</span><span class="w"> </span><span class="nv">COMMAND</span><span class="w"> </span><span class="nv">LINE</span><span class="w"> </span><span class="nv">MODE</span><span class="w"> </span><span class="nv">OPTIONS</span><span class="w"></span>
</code></pre></div>

<p>The dummy skeleton routines all start with a call to unix_test_mode(3f).
 Its documentation describes a few default modes you can change with the
 routine. Essentially the same options are available on the command line
 of the test program(s) as well.</p>
<div class="codehilite"><pre><span></span><code> # options may be specified in NAMELIST input format with no
 # extraneous spaces on the command line
 fpm test -- flags=100,200,300 keep_going=T
 # a little more Unix-like or MSWindows-like syntax is allowed, as
 # these are equivalent to the original command ...
 fpm test -- --flags=100,200,300 --keep_going
 fpm test -- /flags=100,200,300 /keep_going=T
</code></pre></div>

<p>M_framework(3f) uses a built-in command line parser instead of
 packages like M_CLI or M_CLI2 to minimize the number of dependencies
 required.</p>
<div class="codehilite"><pre><span></span><code>SUGGEST ONE TEST PER PROGRAM
</code></pre></div>

<p>There are advantages to each procedure being tested with a separate
 program.</p>
<p>A large number of individual test programs works well with fpm(1).
 fpm defaults to running all the tests, but can execute subgroups
 easily because it can execute a list of tests and the names can
 use simple globbing.</p>
<p>If you autogenerate a list of procedure names to test and call the
 sample program &ldquo;unit_test&rdquo; with the names of the procedures it will
 generate new names but skip existing files; allowing for a simple form
 of auto-generation assuming you have a way of listing all the procedure
 names to test.</p>
<p>individual procedure tests can be deleted or added or moved easily when
 each is in its own file.</p>
<p>It is easier to test with debuggers and other tools like gdb and valgrind
 on small units.</p>
<p>This is true with other tools that you can use with &ndash;runner as well.
 See &ldquo;fpm help runner&rdquo; or &ldquo;fpm manual &gt;manual.txt&rdquo; for more information.</p>
<div class="codehilite"><pre><span></span><code> <span class="n">TESTING</span> <span class="n">MANY</span> <span class="n">PROCEDURES</span> <span class="kr">IN</span> <span class="n">A</span> <span class="n">SINGLE</span> <span class="n">FILE</span>
</code></pre></div>

<p>If it is preferred, one program can test multiple procedures. The
 main disadvantage is that the complete test suite is always run unless
 conditional coding is added. One of the uses of the unit_test_flags(:)
 array is to allow integer values to be passed at execution time that
 can be tested to provide such conditional testing. When many tests are
 in one file the unit_test_start(3f) procedure includes a &ldquo;matched&rdquo; argument
 which can detect if a simple globbing expression that can be given on the
 command line matches the string composed of the test name and message.
 This allows you to optionally select specific groups of tests from a set.</p>
<h2 id="unique-features">UNIQUE FEATURES</h2>
<div class="codehilite"><pre><span></span><code>CALLING AN EXTERNAL PROGRAM
</code></pre></div>

<p>A unique feature of the M_framework(3f) test harness is a hook to call
 a custom program. You can ignore it is there, but it is a very powerful
 feature if you want to do bookkeeping on the test results or enter
 the results into a tracking tool. This allows you a way to sent alerts
 if something fails in automated tests, to create spreadsheets with the
 test results, to retain results in a database or SQLite3 file, or make
 a custom tool to convert the data to something else like TAP (Test Anywhere
 Protocol) reports.</p>
<p>An example program called &ldquo;bookkeeper&rdquo; is included that shows how to
 parse the information passed to the program that generates several files:</p>
<div class="codehilite"><pre><span></span><code>+ bookkeeper.csv
+ bookkeeper.html
+ bookkeeper.nml
+ bookkeeper\_clicks.csv
</code></pre></div>

<p>To use the defaults you simply enter</p>
<div class="codehilite"><pre><span></span><code> fpm test -- command=bookkeeper
</code></pre></div>

<p>The CSV files can typically be read directly into a spreadsheet program.</p>
<p>They can also be read using the SQLite3 tool. This is very powerful,
 letting you use SQL to select specific data, generate reports, and
 convert the subsequent results to HTML, CSV, flat text and other formats.</p>
<p>The NAMELIST output file is essentially a record of the harness calls
 using the standardized NAMELIST format that is almost trivial to read
 in with a custom Fortran program. This might be considered a metafile
 format for a test run. You can replay the data and do whatever you want
 with it including generating alternate output file types; plotting
 timing data and so on.</p>
<p>The HTML file is handy for importing into word processors or viewing
 via browsers. Example output files from an fpm(1) package that uses
 M_framemaker illustrate the different types of output that can be
 generated.
  + <a href="https://urbanjost.github.io/M_framework/bookkeeper.csv">CSV</a>.
    Generally. comma-separated files can be read directly into spreadsheet
    programs, sqlite3, and several common databases.
  + <a href="https://urbanjost.github.io/M_framework/bookkeeper_clicks.csv">CSV runtimes</a>
    Another CSV file that is a record of the runtimes between a
    unit test start and end.
  + <a href="https://urbanjost.github.io/M_framework/bookkeeper.html">HTML</a>
    An example of a formatted report that can be displayed in a browser.
  + <a href="https://urbanjost.github.io/M_framework/bookkeeper.nml">NAMELIST</a>.
    Essentially this is a metafile that records the unit test calls.
    It is very easy for a custom Fortran program to read back a NAMELIST
    file and generate custom outputs instead of modifying bookkeeper(1).</p>
<p>The bookkeeper(1) program is an example program that is expected to
 be customized. It provides for parsing the parameters passed to a
 M_framemaker external program.</p>
<div class="codehilite"><pre><span></span><code> IMPORTING INTO SQLLITE3
</code></pre></div>

<p>Here is an example SQLite3 Tool input file that if placed in &ldquo;test.sql&rdquo;
 can be run with</p>
<div class="codehilite"><pre><span></span><code>  sqlite3 -batch -init test.sql bookkeeper.db .quit
</code></pre></div>

<p>if you have sqlite3(1) installed.</p>
<div class="codehilite"><pre><span></span><code><span class="o">.</span><span class="n">mode</span> <span class="n">csv</span>
<span class="o">.</span><span class="kn">import</span> <span class="nn">bookkeeper.csv</span> <span class="n">unit_test</span>
<span class="o">.</span><span class="n">schema</span> <span class="n">unit_test</span>
<span class="o">---</span>
<span class="o">---</span> <span class="n">show</span> <span class="nb">all</span> <span class="n">data</span> <span class="n">to</span> <span class="n">show</span> <span class="n">it</span> <span class="n">worked</span>
<span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">unit_test</span><span class="p">;</span>
<span class="o">---</span>
<span class="o">---</span> <span class="n">example</span> <span class="n">lists</span> <span class="n">unique</span> <span class="n">names</span>
<span class="n">SELECT</span> <span class="n">name</span> <span class="n">FROM</span> <span class="n">unit_test</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">name</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="n">name</span> <span class="p">;</span>
<span class="o">---</span>
<span class="o">---</span> <span class="n">tally</span> <span class="n">up</span> <span class="n">passed</span><span class="p">,</span> <span class="n">failed</span><span class="p">,</span> <span class="n">skipped</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">text</span> <span class="n">table</span>
<span class="o">.</span><span class="n">header</span> <span class="n">on</span>
<span class="o">.</span><span class="n">mode</span> <span class="n">column</span> <span class="n">unit_test</span>
<span class="o">.</span><span class="n">width</span> <span class="mi">64</span> <span class="mi">9</span> <span class="mi">9</span> <span class="mi">9</span>
<span class="n">SELECT</span> <span class="n">name</span><span class="p">,</span>
<span class="o">---</span> <span class="n">depending</span> <span class="n">on</span> <span class="n">SQL</span> <span class="n">version</span> <span class="n">a</span> <span class="n">simpler</span> <span class="n">IIF</span><span class="o">/</span><span class="n">IF</span><span class="p">,</span> <span class="n">IFNULL</span><span class="p">,</span> <span class="ow">or</span> <span class="n">TOTAL</span> <span class="n">might</span> <span class="n">be</span> <span class="n">better</span> <span class="n">but</span> <span class="n">this</span> <span class="n">works</span> <span class="n">well</span>
<span class="o">---</span> <span class="ow">and</span> <span class="ow">is</span> <span class="n">relatively</span> <span class="s2">&quot;standard&quot;</span> <span class="k">as</span> <span class="n">much</span> <span class="k">as</span> <span class="n">something</span> <span class="n">like</span> <span class="n">a</span> <span class="n">standard</span> <span class="ow">is</span> <span class="n">actually</span> <span class="n">adhered</span> <span class="n">to</span> <span class="ow">in</span>
<span class="o">---</span> <span class="n">SQL</span><span class="o">-</span><span class="n">land</span><span class="o">.</span>
<span class="n">CASE</span>  <span class="nb">sum</span><span class="p">(</span> <span class="n">passed</span> <span class="o">==</span> <span class="s1">&#39;passed&#39;</span>  <span class="p">)</span> <span class="n">WHEN</span> <span class="n">NULL</span> <span class="n">THEN</span> <span class="mi">0</span> <span class="n">ELSE</span> <span class="nb">sum</span> <span class="p">(</span> <span class="n">passed</span> <span class="o">==</span> <span class="s1">&#39;passed&#39;</span><span class="p">)</span>  <span class="n">END</span>  <span class="n">AS</span> <span class="s1">&#39;ok&#39;</span><span class="p">,</span>
<span class="n">CASE</span>  <span class="nb">sum</span><span class="p">(</span> <span class="n">passed</span> <span class="o">==</span> <span class="s1">&#39;failed&#39;</span>  <span class="p">)</span> <span class="n">WHEN</span> <span class="n">NULL</span> <span class="n">THEN</span> <span class="mi">0</span> <span class="n">ELSE</span> <span class="nb">sum</span> <span class="p">(</span> <span class="n">passed</span> <span class="o">==</span> <span class="s1">&#39;failed&#39;</span><span class="p">)</span>  <span class="n">END</span>  <span class="n">AS</span> <span class="s1">&#39;not ok&#39;</span><span class="p">,</span>
<span class="n">CASE</span>  <span class="nb">sum</span><span class="p">(</span> <span class="n">passed</span> <span class="o">==</span> <span class="s1">&#39;skipped&#39;</span> <span class="p">)</span> <span class="n">WHEN</span> <span class="n">NULL</span> <span class="n">THEN</span> <span class="mi">0</span> <span class="n">ELSE</span> <span class="nb">sum</span> <span class="p">(</span> <span class="n">passed</span> <span class="o">==</span> <span class="s1">&#39;skipped&#39;</span><span class="p">)</span> <span class="n">END</span>  <span class="n">AS</span> <span class="s1">&#39;skip&#39;</span>
<span class="n">FROM</span> <span class="n">unit_test</span>
<span class="o">---</span> <span class="n">WHERE</span> <span class="n">condition</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="n">name</span>
<span class="n">ORDER</span> <span class="n">BY</span> <span class="n">name</span> <span class="p">;</span>
<span class="o">---</span>
<span class="o">---</span> <span class="n">If</span> <span class="n">the</span> <span class="n">table</span> <span class="n">already</span> <span class="n">exists</span><span class="p">,</span> <span class="n">the</span> <span class="n">sqlite3</span> <span class="n">tool</span> <span class="n">uses</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">rows</span><span class="p">,</span>
<span class="o">---</span> <span class="n">including</span> <span class="n">the</span> <span class="n">first</span> <span class="n">row</span><span class="p">,</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">CSV</span> <span class="n">file</span> <span class="k">as</span> <span class="n">the</span> <span class="n">actual</span> <span class="n">data</span> <span class="n">to</span> <span class="n">import</span><span class="o">.</span>
<span class="o">---</span> <span class="n">Therefore</span><span class="p">,</span> <span class="n">you</span> <span class="n">should</span> <span class="n">delete</span> <span class="n">the</span> <span class="n">first</span> <span class="n">row</span> <span class="n">of</span> <span class="n">the</span> <span class="n">CSV</span> <span class="n">file</span> <span class="k">with</span> <span class="n">the</span>
<span class="o">---</span> <span class="n">header</span> <span class="n">labels</span> <span class="k">if</span> <span class="n">adding</span> <span class="n">to</span> <span class="n">an</span> <span class="n">existing</span> <span class="n">table</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">creating</span>
<span class="n">DROP</span> <span class="n">TABLE</span> <span class="n">IF</span> <span class="n">EXISTS</span> <span class="n">unit_test</span><span class="p">;</span>
<span class="o">---</span> <span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">unit_test</span><span class="p">(</span>
<span class="o">---</span>   <span class="n">name</span>   <span class="n">TEXT</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
<span class="o">---</span>   <span class="n">date</span>   <span class="n">DATE</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
<span class="o">---</span>   <span class="n">passed</span> <span class="n">TEXT</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">,</span>
<span class="o">---</span>   <span class="n">msg</span>    <span class="n">TEXT</span>
<span class="o">---</span> <span class="p">);</span>
</code></pre></div>

<p>The last select generates a little tally table showing for all the runs
 in the input DataBaseFile the number of pass, fail, and skips of the test
 names. you could tally over a particular date range, only show failures,
 display the last test status, generating output in HTML or CSV or &hellip;
 See the SQLite3 Tool documentation for sqlite3(3f) for more information.</p>
<div class="codehilite"><pre><span></span><code>name                                          ok         not ok     skip
--------------------------------------------  ---------  ---------  ---------
accdig                                        3          0          0
almost                                        24         0          0
flush_trail                                   0          0          3
in_margin                                     30         0          0
round                                         0          0          3
set_stdout_lun                                0          0          3
significant                                   15         1          2
unit_test                                     0          0          3
unit_test_bad                                 0          0          3
unit_test_end                                 0          0          3
unit_test_good                                0          0          3
unit_test_start                               0          0          6
unit_test_stop                                0          0          3
where_write_message_all                       0          0          3
write_message_only                            4          2          4
</code></pre></div>

<h2 id="unique-features_1">UNIQUE FEATURES</h2>
<p>fpm(1), gdb(1), and M_framework(3f) work together</p>
<p>It is easy to debug an individual test in a debugger. For example to run
 a test called &ldquo;crash&rdquo; with gdb(1) use</p>
<div class="codehilite"><pre><span></span><code>  fpm test --target crash --runner &quot;gdb -ex run --quiet&quot;
</code></pre></div>

<p>A more elaborate example passing arguments to M_framework(3f) to change
 default behavior to for example write output to stdout instead of stderr
 and display compiler version and options and to run all the tests in
 the gdb(1) debugger (you can enter &ldquo;q&rdquo; after each test has run; or enter
 gdb commands at the prompt):</p>
<div class="codehilite"><pre><span></span><code> &gt; fpm test --target &#39;*&#39; --verbose \
 &gt; --runner &#39;gdb -ex &quot;list, 0&quot; -ex run --quiet --args&#39; \
 &gt; -- flags=9997,9998,9999 luns=6 level=3
</code></pre></div>

<p>This is long enough that an alias or script would facilitate its use,
 with one changing it to use one&rsquo;s favorite options.</p>
<div class="codehilite"><pre><span></span><code>EASILY CALLED BY STANDARDIZED CD/CI SCRIPTS
</code></pre></div>

<p>If a CD/CI github automated test script creates a Fortran
 environment including fpm and simply calls &ldquo;fpm test&rdquo; you can standardize
 your testing and use the same CD/CI scripts for any package. The testing
 framework is designed with just that scenario in mind.</p>
<p>The .github subdirectory in M_framework package contains examples of just
 such files that you can copy as-is into your fpm project. Activate test
 actions in your github repository after adding the .github directory and
 your package will be automatically tested on several different platforms
 by the scripts whenever a &ldquo;push&rdquo; to the repository occurs.</p>
<hr>
<h2 id="supports-fpm">SUPPORTS FPM</h2>
<p>The impatient can try this, assuming git(1) and fpm(1) are installed.</p>
<p>Download the github repository and build it with fpm(1)
 and create a test fpm(1) project:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># first you need to install a few example programs</span>
<span class="nb">cd</span> /tmp
git clone https://github.com/urbanjost/M_framework.git
<span class="nb">cd</span> M_framework
<span class="c1"># install the &quot;unit_test&quot;, &quot;bookkeeper&quot;, and &quot;test_suite&quot;</span>
<span class="c1"># example programs; assuming the default install puts</span>
<span class="c1"># them in your path:</span>
fpm install
<span class="c1"># &quot;fpm help install&quot; describes how to customize where the</span>
<span class="c1"># programs are installed.</span>
<span class="c1">#</span>
<span class="c1"># go to your fpm package test/ directory.</span>
<span class="c1"># here, we will make one up</span>
fpm new /tmp/tryit  <span class="c1"># create test project</span>
<span class="nb">cd</span> /tmp/tryit/test
<span class="c1"># so lets say you plan on adding procedures &quot;a&quot;,&quot;b&quot;,and &quot;c&quot; to your src/tryit.f90</span>
<span class="c1"># project code. Set up individual skeleton tests for each procedure.</span>
unit_test a b c                         <span class="c1"># a file for each test</span>
test_suite a b c &gt; test_suite_tryit.f90 <span class="c1"># or a single file</span>
<span class="nb">cd</span> ..  <span class="c1"># go to the top of the project</span>
<span class="c1"># add M_framework to the developer dependencies</span>
cat &gt;&gt; fpm.toml <span class="s">&lt;&lt;\EOF</span>
<span class="s">[dev-dependencies]</span>
<span class="s">M_framework    = { git = &quot;https://github.com/urbanjost/M_framework.git&quot; }</span>
<span class="s">EOF</span>
<span class="c1">#</span>
<span class="c1"># test the package</span>
fpm <span class="nb">test</span>
<span class="c1"># if will say the procedures are untested. Put real calls</span>
<span class="c1"># in to unit_test(3f) and see how the default report</span>
<span class="c1"># changes</span>
<span class="c1">#</span>
<span class="c1"># so now to run the default tests is as simple as</span>
fpm <span class="nb">test</span>
<span class="c1"># run just one test</span>
fpm <span class="nb">test</span> unit_test_a
<span class="c1"># run tests using globbing; eg. all tests beginning with &quot;unit\_&quot;</span>
fpm <span class="nb">test</span> <span class="s1">&#39;unit_*&#39;</span>
<span class="c1"># display help on the interactive command options</span>
fpm <span class="nb">test</span> -- --help

<span class="c1"># you can pass parameters and/or change the unit_test_mode(3f)</span>
<span class="c1"># calls to change some of the test behavior</span>
</code></pre></div></td></tr></table></div>

<p>So once you want to use this on your own projects, you would normally
 just add M_framework(3f) as a developer dependency
 in your fpm.toml project file and start making tests that call M_framework(3f).</p>
<p>The optional programs demonstrated (&ldquo;unit_test&rdquo;, &ldquo;test_suite&rdquo;) are just simple
 stand-alone programs that make skeleton programs to run tests that you can
 customize (and rename too to avoid confusion).</p>
<div class="codehilite"><pre><span></span><code># <span class="nv">some</span> <span class="nv">useful</span> <span class="nv">things</span> <span class="nv">to</span> <span class="nv">try</span>. <span class="nv">Check</span> <span class="nv">out</span> <span class="nv">the</span> <span class="nv">man</span><span class="o">-</span><span class="nv">pages</span> <span class="k">for</span> <span class="nv">all</span> <span class="nv">the</span> <span class="nv">unit_test_</span><span class="o">*</span><span class="ss">(</span><span class="mi">3</span><span class="nv">f</span><span class="ss">)</span>
# <span class="nv">procedures</span>.
# <span class="k">Then</span> <span class="nv">look</span> <span class="nv">at</span>
<span class="nv">unit_test</span> <span class="o">--</span><span class="nv">help</span>
<span class="nv">fpm</span> <span class="nv">test</span> <span class="o">--</span> <span class="nv">help</span>
# <span class="nv">run</span> <span class="nv">the</span> <span class="nv">demo</span> <span class="nv">bookkeeper</span> <span class="nv">script</span>
<span class="nv">fpm</span> <span class="nv">test</span> <span class="o">--</span> <span class="nv">command</span><span class="o">=</span><span class="nv">bookkeeper</span>
# <span class="nv">and</span> <span class="nv">look</span> <span class="nv">at</span> <span class="nv">the</span> <span class="nv">bookkeeper</span><span class="o">*</span>.<span class="o">*</span> <span class="nv">files</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">top</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">project</span>
</code></pre></div>

<h2 id="documentation">DOCUMENTATION</h2>
<p>USER</p>
<ul>
<li>
<p>An <a href="https://urbanjost.github.io/M_framework/man3.html">index</a> to HTML versions
    of the manpages</p>
</li>
<li>
<p>single pages that uses javascript to combine all the HTML descriptions
    of the man-pages is at</p>
<ul>
<li><a href="https://urbanjost.github.io/M_framework/BOOK_M_framework__verify.html">BOOK_M_framework__verify</a></li>
<li><a href="https://urbanjost.github.io/M_framework/BOOK_M_framework__approx.html">BOOK_M_framework__approx</a></li>
<li><a href="https://urbanjost.github.io/M_framework/BOOK_M_framework__journal.html">BOOK_M_framework__journal</a></li>
<li><a href="https://urbanjost.github.io/M_framework/BOOK_M_framework__msg.html">BOOK_M_framework__msg</a></li>
</ul>
</li>
<li>
<p>man-pages in</p>
<ul>
<li><a href="https://urbanjost.github.io/M_framework/manpages.zip">manpages.zip</a></li>
<li><a href="https://urbanjost.github.io/M_framework/manpages.tgz">manpages.tgz</a></li>
</ul>
<p>DEVELOPER
+ <a href="https://urbanjost.github.io/M_framework/fpm-ford/index.html">ford-generated developers&rsquo; document</a>
+ <a href="docs/STATUS.md">github action status</a></p>
</li>
</ul>
<h2 id="additional-directory-descriptions">ADDITIONAL DIRECTORY DESCRIPTIONS</h2>
<div class="codehilite"><pre><span></span><code><span class="o">-</span> <span class="nv">src</span><span class="o">/</span> <span class="nv">is</span> <span class="nv">where</span> <span class="nv">the</span> <span class="nv">source</span> <span class="k">for</span> <span class="nv">the</span> <span class="nv">M_framework</span><span class="ss">(</span><span class="mi">3</span><span class="nv">f</span><span class="ss">)</span> <span class="nv">module</span> <span class="nv">code</span> <span class="nv">resides</span>
<span class="o">-</span> <span class="nv">docs</span><span class="o">/</span> <span class="nv">contains</span> <span class="nv">HTML</span> <span class="nv">documentation</span> <span class="nv">and</span> <span class="nv">the</span> <span class="nv">manpage</span> <span class="nv">archives</span>
<span class="o">-</span> <span class="nv">test</span><span class="o">/</span> <span class="nv">contains</span> <span class="nv">simple</span> <span class="nv">test</span> <span class="nv">programs</span>
<span class="o">-</span> <span class="nv">example</span><span class="o">/</span> <span class="nv">has</span> <span class="nv">demos</span>
</code></pre></div>

<h2 id="references">REFERENCES</h2>
<ul>
<li>See the .github directory in <a href="https://github.com/urbanjost/easy">easy</a></li>
<li>for examples of CD/CI scripts that assume your package can be tested with an &ldquo;fpm test&rdquo; command.</li>
<li>
<p>examples that use M_framework in github fpm packages:</p>
<ul>
<li><a href="https://github.com/urbanjost/M_strings">M_strings</a></li>
<li><a href="https://github.com/urbanjost/M_process">M_process</a></li>
</ul>
<p>These packages used a different reincarnation of the testing harness and are in the process of
being changed to use M_framework(3f) more appropriately, but still contain some useful examples.</p>
</li>
<li>
<p><a href="https://github.com/fortran-lang/fpm">Fortran Package Manager</a></p>
</li>
<li><a href="https://github.com/fortran-lang/fpm-registry">fpm(1) registry</a></li>
<li><a href="https://fortranwiki.org/fortran/show/Unit+testing+frameworks">Fortran Wiki: unit testing list</a></li>
<li>
<p><a href="https://politicalphysicist.github.io/ford-fortran-documentation.html">ford(1)</a> for generating documentation for your projects</p>
<p>NOTE
 M_framework(3f) is subject to interface changes so the generally recommended
 practice of using a specific commit when using it an an external
 fpm(1) dependency is highly encouraged.</p>
</li>
</ul>
<p>Any feedback (features, performance, ease of use, &hellip;) is appreciated,
 particularly in the ongoing development phase.</p>
<h2 id="quote">QUOTE</h2>
<div class="codehilite"><pre><span></span><code><span class="n">Do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">let</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">victories</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">head</span><span class="p">,</span><span class="w"> </span><span class="n">nor</span><span class="w"> </span><span class="n">let</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">failures</span><span class="w"> </span><span class="k">go</span><span class="w"></span>
<span class="k">to</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">heart</span><span class="p">.</span><span class="w"></span>
</code></pre></div>

<h2 id="author">AUTHOR</h2>
<div class="codehilite"><pre><span></span><code>John S. Urban
</code></pre></div>

<h2 id="license">LICENSE</h2>
<div class="codehilite"><pre><span></span><code>Public Domain
</code></pre></div>
      <br>
<br>
      <section>
        <h2><span class="anchor" id="src"></span>Source Code</h2>
        <div class="hl codehilite"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="k">module </span><span class="n">M_framework</span><span class="w"></span>
<a id="ln-2" name="ln-2" href="#ln-2"></a><span class="k">use </span><span class="n">M_framework__journal</span><span class="w"></span>
<a id="ln-3" name="ln-3" href="#ln-3"></a><span class="k">use </span><span class="n">M_framework__msg</span><span class="w"></span>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="k">use </span><span class="n">M_framework__verify</span><span class="w"></span>
<a id="ln-5" name="ln-5" href="#ln-5"></a><span class="k">use </span><span class="n">M_framework__approx</span><span class="w"></span>
<a id="ln-6" name="ln-6" href="#ln-6"></a><span class="k">use </span><span class="n">M_framework__utility</span><span class="w"></span>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="k">use </span><span class="n">M_framework__timing</span><span class="w"></span>
<a id="ln-8" name="ln-8" href="#ln-8"></a><span class="c">!use M_framework__attr</span>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="k">implicit none</span><span class="p">(</span><span class="k">type</span><span class="p">,</span><span class="k">external</span><span class="p">)</span><span class="w"></span>
<a id="ln-10" name="ln-10" href="#ln-10"></a><span class="c">!private</span>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="c">! public ...</span>
<a id="ln-12" name="ln-12" href="#ln-12"></a><span class="c">!===================================================================================================================================</span>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="c">!===================================================================================================================================</span>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="c">!&gt;</span>
<a id="ln-16" name="ln-16" href="#ln-16"></a><span class="c">!!##NAME</span>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="c">!!    M_framework(3f) - [M_framework::INTRO] unit test framework</span>
<a id="ln-18" name="ln-18" href="#ln-18"></a><span class="c">!!     (LICENSE:PD)</span>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="c">!!##SYNOPSIS</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a><span class="c">!!</span>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="c">!!</span>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="c">!! M_framework(3f) is an aggregate of Fortran modules brought together to</span>
<a id="ln-23" name="ln-23" href="#ln-23"></a><span class="c">!! provide unit testing for Fortran; and is particularly well suited for</span>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="c">!! use with the Fortran Package Manager (fpm).</span>
<a id="ln-25" name="ln-25" href="#ln-25"></a><span class="c">!!</span>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="c">!! The support modules are useful for creating terminal messages, comparing</span>
<a id="ln-27" name="ln-27" href="#ln-27"></a><span class="c">!! expected values to results, writing logfiles and playback journals</span>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="c">!! independent of unit testing as well.</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="c">!!</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a><span class="c">!! Typically unit testing can be integrated seamlessly into the fpm(1) subcommand</span>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="c">!! &quot;test&quot; making unit testing from github/gitlab CD/CI utilities as simple as</span>
<a id="ln-32" name="ln-32" href="#ln-32"></a><span class="c">!! &quot;fpm test&quot; in many cases.</span>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="c">!!</span>
<a id="ln-34" name="ln-34" href="#ln-34"></a><span class="c">!!</span>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="c">!!  BASIC TIMING IS INCLUDED</span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="c">!! As well as the expected **pass/fail/skipped unit testing** report.</span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="c">!! basic **timing information** can be produced by the unit testing module</span>
<a id="ln-38" name="ln-38" href="#ln-38"></a><span class="c">!! M_framework__verify(3f).</span>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="c">!!</span>
<a id="ln-40" name="ln-40" href="#ln-40"></a><span class="c">!!  HOOKS ARE PROVIDED TO EXTERNAL LOCAL APPLICATIONS</span>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="c">!!</span>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="c">!! M_framework(3f) comes with a unique hook that allows calling your own</span>
<a id="ln-43" name="ln-43" href="#ln-43"></a><span class="c">!! programs to integrate with local logging tools, report generators,</span>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="c">!! spreadsheets or other local infrastructure. The example program</span>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="c">!! &quot;bookkeeper&quot; is included that uses the hook to write example report</span>
<a id="ln-46" name="ln-46" href="#ln-46"></a><span class="c">!! data files:</span>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="c">!!</span>
<a id="ln-48" name="ln-48" href="#ln-48"></a><span class="c">!!  + [CSV](https://urbanjost.github.io/M_framework/bookkeeper.csv),</span>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="c">!!  + [HTML](https://urbanjost.github.io/M_framework/bookkeeper.html)</span>
<a id="ln-50" name="ln-50" href="#ln-50"></a><span class="c">!!  + [NAMELIST](https://urbanjost.github.io/M_framework/bookkeeper.nml)</span>
<a id="ln-51" name="ln-51" href="#ln-51"></a><span class="c">!!</span>
<a id="ln-52" name="ln-52" href="#ln-52"></a><span class="c">!! The hook can call any local program with an interface similar to</span>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="c">!! &quot;bookkeeper&quot;. This allows modifying the program for local needs such</span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="c">!! as sending e-mail alerts and so on without having to change the tests.</span>
<a id="ln-55" name="ln-55" href="#ln-55"></a><span class="c">!!</span>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="c">!!   MESSAGES CAN BE COMPOSED ALMOST LIKE LIST-DIRECTED I/O</span>
<a id="ln-57" name="ln-57" href="#ln-57"></a><span class="c">!! Messages can be composed of up to twenty scalar intrinsic variables,</span>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="c">!! allowing freedom in writing messages akin to that of list-directed I/O;</span>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="c">!! but simultaneously to a list of output units. This easily lets messages</span>
<a id="ln-60" name="ln-60" href="#ln-60"></a><span class="c">!! go to stdout or stderr and a file of the user&#39;s choosing as well. Output</span>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="c">!! can even be sent to a scratch file, essentially creating a quiet mode.</span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="c">!!</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="c">!!    DESIGNED FOR INTEGRATION WITH FPM(1)</span>
<a id="ln-64" name="ln-64" href="#ln-64"></a><span class="c">!! In conjunction with fpm(1) it is easy to run the tests with the --runner</span>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="c">!! option, allowing for integration with other utilities as well such as</span>
<a id="ln-66" name="ln-66" href="#ln-66"></a><span class="c">!! the GNU debugger gdb(1), valgrind(1), and other tools.</span>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="c">!!</span>
<a id="ln-68" name="ln-68" href="#ln-68"></a><span class="c">!!    PROGRAMS INCLUDED TO GENERATE SKELETON TEST PROGRAM</span>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="c">!! Example programs are provided to create unit test skeleton programs to</span>
<a id="ln-70" name="ln-70" href="#ln-70"></a><span class="c">!! ease usage.</span>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="c">!!</span>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="c">!!    EASILY USED WITH GITHUB CD/CI</span>
<a id="ln-73" name="ln-73" href="#ln-73"></a><span class="c">!! Example CD/CI scripts that can be used with github are in the .github/</span>
<a id="ln-74" name="ln-74" href="#ln-74"></a><span class="c">!! directory that assume your tests can by run by using &quot;fpm test&quot;.</span>
<a id="ln-75" name="ln-75" href="#ln-75"></a><span class="c">!!</span>
<a id="ln-76" name="ln-76" href="#ln-76"></a><span class="c">!!    MOTIVATION</span>
<a id="ln-77" name="ln-77" href="#ln-77"></a><span class="c">!! Including **unit testing** is strongly encouraged for any software package,</span>
<a id="ln-78" name="ln-78" href="#ln-78"></a><span class="c">!! but particularly when it is to be used in programming environments the</span>
<a id="ln-79" name="ln-79" href="#ln-79"></a><span class="c">!! package was not developed in.</span>
<a id="ln-80" name="ln-80" href="#ln-80"></a><span class="c">!!</span>
<a id="ln-81" name="ln-81" href="#ln-81"></a><span class="c">!! This is the typical case for public fpm(1) packages on github.</span>
<a id="ln-82" name="ln-82" href="#ln-82"></a><span class="c">!!</span>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="c">!! Additionally the proposed rules for registered fpm(1) package repositories</span>
<a id="ln-84" name="ln-84" href="#ln-84"></a><span class="c">!! include requiring package candidates themselves only have external</span>
<a id="ln-85" name="ln-85" href="#ln-85"></a><span class="c">!! dependencies that are also registered repository packages ( of course</span>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="c">!! wrappers of C libraries or other existing libraries cannot easily be</span>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="c">!! conformed to this).</span>
<a id="ln-88" name="ln-88" href="#ln-88"></a><span class="c">!!</span>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="c">!! As a result -- this project concentrates on tools for a procedural unit</span>
<a id="ln-90" name="ln-90" href="#ln-90"></a><span class="c">!! testing framework based on nothing but standard Fortran that specifically</span>
<a id="ln-91" name="ln-91" href="#ln-91"></a><span class="c">!! can be used as a remote fpm(1) dependency in fpm(1) packages that may</span>
<a id="ln-92" name="ln-92" href="#ln-92"></a><span class="c">!! reside in public github repositories.</span>
<a id="ln-93" name="ln-93" href="#ln-93"></a><span class="c">!!</span>
<a id="ln-94" name="ln-94" href="#ln-94"></a><span class="c">!! That is, it is designed to be integrated with the fpm(1) &quot;test&quot; subcommand</span>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="c">!! as an external dependency. It is intended to have little or no other</span>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="c">!! dependencies and ultimately become a registered fpm(1) package to aid in</span>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="c">!! the development of the fpm(1) repository.</span>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="c">!!</span>
<a id="ln-99" name="ln-99" href="#ln-99"></a><span class="c">!! That being said, it can be used standalone as well.</span>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="c">!!</span>
<a id="ln-101" name="ln-101" href="#ln-101"></a><span class="c">!!##DESCRIPTION</span>
<a id="ln-102" name="ln-102" href="#ln-102"></a><span class="c">!!</span>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="c">!! Unit testing allows you to automatically confirm changes are acceptable</span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="c">!! so you can quickly and confidently make and release changes. But many of</span>
<a id="ln-105" name="ln-105" href="#ln-105"></a><span class="c">!! the operations required for testing are useful generically. So this</span>
<a id="ln-106" name="ln-106" href="#ln-106"></a><span class="c">!! project is broken down into small general-purpose modules and</span>
<a id="ln-107" name="ln-107" href="#ln-107"></a><span class="c">!! one unit-testing-specific one.</span>
<a id="ln-108" name="ln-108" href="#ln-108"></a><span class="c">!!</span>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="c">!! M_framework(3f) is composed of the following individual modules:</span>
<a id="ln-110" name="ln-110" href="#ln-110"></a><span class="c">!!</span>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="c">!!  + **M\_framework__msg** is a small module that in particular</span>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="c">!!    can convert a list of variables of any of the common default types</span>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="c">!!    to a string.</span>
<a id="ln-114" name="ln-114" href="#ln-114"></a><span class="c">!!</span>
<a id="ln-115" name="ln-115" href="#ln-115"></a><span class="c">!!    It performs low-level operations that are often used by other larger</span>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="c">!!    modules so it is its own module to prevent circular dependencies.</span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="c">!!</span>
<a id="ln-118" name="ln-118" href="#ln-118"></a><span class="c">!!  + **M\_framework__journal__** allows for creating log and journal files</span>
<a id="ln-119" name="ln-119" href="#ln-119"></a><span class="c">!!</span>
<a id="ln-120" name="ln-120" href="#ln-120"></a><span class="c">!!  + **M\_framework__approx** contains routines for rounding and comparing</span>
<a id="ln-121" name="ln-121" href="#ln-121"></a><span class="c">!!    floating-point values.</span>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="c">!!</span>
<a id="ln-123" name="ln-123" href="#ln-123"></a><span class="c">!!  + **M\_framework__help** provides for creating a standard simple</span>
<a id="ln-124" name="ln-124" href="#ln-124"></a><span class="c">!!    interactive help facility</span>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="c">!!</span>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="c">!!  + **M\_framework__verify** is at the heart of the collection and</span>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="c">!!    handles virtually all the unit-test-specific operations.</span>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="c">!!</span>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="c">!! The procedures can be used in a variety of ways. After using them for</span>
<a id="ln-130" name="ln-130" href="#ln-130"></a><span class="c">!! a long time my typical usage has changed completely several times.</span>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="c">!!</span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="c">!! As part of private software there was little problem calling the</span>
<a id="ln-133" name="ln-133" href="#ln-133"></a><span class="c">!! procedures directly from within the modules where they resided; and even</span>
<a id="ln-134" name="ln-134" href="#ln-134"></a><span class="c">!! auto-detecting the routines (a naming convention of &quot;test\_suite\_$NAME&quot;</span>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="c">!! was used). The routines were pre-installed on virtually all platforms</span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="c">!! so using them was no more a burden than say, calling an intrinsic.</span>
<a id="ln-137" name="ln-137" href="#ln-137"></a><span class="c">!!</span>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="c">!! Put autodetecting tools (at least the ones employed) are not generally</span>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="c">!! portable; and with public packages there is a strong incentive to</span>
<a id="ln-140" name="ln-140" href="#ln-140"></a><span class="c">!! minimize the amount of infrastructure and external dependencies. It is</span>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="c">!! generally imperative to make package use as simple and generic as possible.</span>
<a id="ln-142" name="ln-142" href="#ln-142"></a><span class="c">!!</span>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="c">!! So the suggested scheme is to create a small test program for each</span>
<a id="ln-144" name="ln-144" href="#ln-144"></a><span class="c">!! procedure or closely related procedures in the fpm test/ directory.</span>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="c">!!</span>
<a id="ln-146" name="ln-146" href="#ln-146"></a><span class="c">!!  + make a subroutine for each component to be tested</span>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="c">!!  + in each test procedure start it with a call to UNIT\_TEST\_START(3f)</span>
<a id="ln-148" name="ln-148" href="#ln-148"></a><span class="c">!!  + end each test procedure it with a call to UNIT\_TEST\_END(3f)</span>
<a id="ln-149" name="ln-149" href="#ln-149"></a><span class="c">!!  + make multiple calls to UNIT\_TEST(3f) in-between to generate</span>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="c">!!    test results</span>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="c">!!  + call each of those test routines from the main program</span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="c">!!  + end the main program with a call to UNIT\_TEST\_STOP(3f)</span>
<a id="ln-153" name="ln-153" href="#ln-153"></a><span class="c">!!</span>
<a id="ln-154" name="ln-154" href="#ln-154"></a><span class="c">!! Optionally, before starting set preferred non-default modes.</span>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="c">!!</span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="c">!! Use the &#39;fpm test&#39; command to run specific tests; all tests (the default);</span>
<a id="ln-157" name="ln-157" href="#ln-157"></a><span class="c">!! a list of tests or test names using simple globbing.</span>
<a id="ln-158" name="ln-158" href="#ln-158"></a><span class="c">!!</span>
<a id="ln-159" name="ln-159" href="#ln-159"></a><span class="c">!! As desired, command line options can be used to control various test</span>
<a id="ln-160" name="ln-160" href="#ln-160"></a><span class="c">!! behaviors.</span>
<a id="ln-161" name="ln-161" href="#ln-161"></a><span class="c">!!</span>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="c">!! As an example, we can create a skeleton program to test a few</span>
<a id="ln-163" name="ln-163" href="#ln-163"></a><span class="c">!! routines. Using</span>
<a id="ln-164" name="ln-164" href="#ln-164"></a><span class="c">!!</span>
<a id="ln-165" name="ln-165" href="#ln-165"></a><span class="c">!!      fpm test_suite sqrt cos sin &gt; test/test_suite.f90</span>
<a id="ln-166" name="ln-166" href="#ln-166"></a><span class="c">!!</span>
<a id="ln-167" name="ln-167" href="#ln-167"></a><span class="c">!! to create the skeleton program and then adding a few actual</span>
<a id="ln-168" name="ln-168" href="#ln-168"></a><span class="c">!! calls to unit\_test\_test(3f) results in</span>
<a id="ln-169" name="ln-169" href="#ln-169"></a><span class="c">!!</span>
<a id="ln-170" name="ln-170" href="#ln-170"></a><span class="c">!!   Sample program:</span>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="c">!!</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="c">!!    program M_test_suite_M_intrinsics</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a><span class="c">!!    use,intrinsic :: iso_fortran_env, only : &amp;</span>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="c">!!    &amp; stderr=&gt;ERROR_UNIT, stdin=&gt;INPUT_UNIT, stdout=&gt;OUTPUT_UNIT</span>
<a id="ln-175" name="ln-175" href="#ln-175"></a><span class="c">!!    !</span>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="c">!!    use M_framework, only : unit_test_start,unit_test,unit_test_end, &amp;</span>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="c">!!                     unit_test_mode, unit_test_level, unit_test_stop</span>
<a id="ln-178" name="ln-178" href="#ln-178"></a><span class="c">!!    use M_framework, only : CHECK_PREFIX ! change column one of messages</span>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="c">!!    !</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a><span class="c">!!    !use M_mymodule ! load any modules you will be testing</span>
<a id="ln-181" name="ln-181" href="#ln-181"></a><span class="c">!!    implicit none</span>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="c">!!    double precision,allocatable :: expected(:), answers(:), input(:)</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a><span class="c">!!    double precision,parameter :: PI=atan(1.0d0)*4</span>
<a id="ln-184" name="ln-184" href="#ln-184"></a><span class="c">!!    !! setup</span>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="c">!!       !---------------------------------------------------</span>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="c">!!       !OPTIONAL:</span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="c">!!       !  values used in prefix column for various messages</span>
<a id="ln-188" name="ln-188" href="#ln-188"></a><span class="c">!!       !  the default is to set them all to the basename of</span>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="c">!!       !  the executable running tests, but they can be</span>
<a id="ln-190" name="ln-190" href="#ln-190"></a><span class="c">!!       !  altered. For example:</span>
<a id="ln-191" name="ln-191" href="#ln-191"></a><span class="c">!!       CHECK_PREFIX=prefix(                  &amp;</span>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="c">!!        test_MSG    =  &#39;test_msg:   &#39;, &amp;</span>
<a id="ln-193" name="ln-193" href="#ln-193"></a><span class="c">!!        test        =  &#39;test:      &#39;,  &amp;</span>
<a id="ln-194" name="ln-194" href="#ln-194"></a><span class="c">!!        test_START  =  &#39;test_start: &#39;, &amp;</span>
<a id="ln-195" name="ln-195" href="#ln-195"></a><span class="c">!!        test_STOP   =  &#39;test_stop:  &#39;, &amp;</span>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="c">!!        test_END    =  &#39;test_end:   &#39;  &amp;</span>
<a id="ln-197" name="ln-197" href="#ln-197"></a><span class="c">!!       )</span>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="c">!!       !---------------------------------------------------</span>
<a id="ln-199" name="ln-199" href="#ln-199"></a><span class="c">!!       !OPTIONAL:</span>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="c">!!       ! the options available at run-time on the command</span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="c">!!       ! line can have their defaults selected. See the</span>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="c">!!       ! man-page for the procedure for details.</span>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="c">!!       call unit_test_mode(</span>
<a id="ln-204" name="ln-204" href="#ln-204"></a><span class="c">!!         ( keep_going=.true. ,</span>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="c">!!         flags=[character(len=0) ::],</span>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="c">!!         luns=[stdout],</span>
<a id="ln-207" name="ln-207" href="#ln-207"></a><span class="c">!!         command, &amp;</span>
<a id="ln-208" name="ln-208" href="#ln-208"></a><span class="c">!!         brief=.false. ,</span>
<a id="ln-209" name="ln-209" href="#ln-209"></a><span class="c">!!         interactive=.false. ,</span>
<a id="ln-210" name="ln-210" href="#ln-210"></a><span class="c">!!         CMDLINE=&#39;&#39;,</span>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="c">!!         debug=.false. ,</span>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="c">!!         match</span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="c">!!         )</span>
<a id="ln-214" name="ln-214" href="#ln-214"></a><span class="c">!!       !---------------------------------------------------</span>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="c">!!    !! test each subroutine</span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="c">!!       call test_sqrt()</span>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="c">!!       call test_cos()</span>
<a id="ln-218" name="ln-218" href="#ln-218"></a><span class="c">!!       call test_sin()</span>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="c">!!    !! teardown</span>
<a id="ln-220" name="ln-220" href="#ln-220"></a><span class="c">!!       call unit_test_stop()</span>
<a id="ln-221" name="ln-221" href="#ln-221"></a><span class="c">!!    contains</span>
<a id="ln-222" name="ln-222" href="#ln-222"></a><span class="c">!!    subroutine test_sqrt()</span>
<a id="ln-223" name="ln-223" href="#ln-223"></a><span class="c">!!    integer :: i</span>
<a id="ln-224" name="ln-224" href="#ln-224"></a><span class="c">!!       call unit_test_start(&#39;sqrt&#39;,msg=&#39;calculate the square root&#39;)</span>
<a id="ln-225" name="ln-225" href="#ln-225"></a><span class="c">!!       input   =[1.0d0,4.0d0,9.0d0]</span>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="c">!!       expected=[1.0d0,2.0d0,3.0d0]</span>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="c">!!       answers=[(sqrt(input(i)),i=1,size(input))]</span>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="c">!!       call unit_test(&#39;sqrt&#39;, all(expected.eq.answers),&amp;</span>
<a id="ln-229" name="ln-229" href="#ln-229"></a><span class="c">!!          &amp; &#39;check table of values&#39;)</span>
<a id="ln-230" name="ln-230" href="#ln-230"></a><span class="c">!!       call unit_test(&#39;sqrt&#39;, sqrt(25.0d0).eq.5.0d0,&amp;</span>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="c">!!          &amp; &#39;got&#39;,sqrt(25.0d0),&#39;expected&#39;,5.0d0)</span>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="c">!!       call unit_test_end(&#39;sqrt&#39;,msg=&#39;&#39;)</span>
<a id="ln-233" name="ln-233" href="#ln-233"></a><span class="c">!!    end subroutine test_sqrt</span>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="c">!!</span>
<a id="ln-235" name="ln-235" href="#ln-235"></a><span class="c">!!    subroutine test_sin()</span>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="c">!!       call unit_test_start(&#39;sin&#39;,msg=&#39;calculate the sine of a value&#39;)</span>
<a id="ln-237" name="ln-237" href="#ln-237"></a><span class="c">!!       call unit_test_end(&#39;sin&#39;,msg=&#39;&#39;)</span>
<a id="ln-238" name="ln-238" href="#ln-238"></a><span class="c">!!    end subroutine test_sin</span>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="c">!!</span>
<a id="ln-240" name="ln-240" href="#ln-240"></a><span class="c">!!    subroutine test_cos()</span>
<a id="ln-241" name="ln-241" href="#ln-241"></a><span class="c">!!       call unit_test_start(&#39;cos&#39;,msg=&#39;calculate the cosine of a value&#39;)</span>
<a id="ln-242" name="ln-242" href="#ln-242"></a><span class="c">!!       call unit_test_end(&#39;cos&#39;,msg=&#39;&#39;)</span>
<a id="ln-243" name="ln-243" href="#ln-243"></a><span class="c">!!    end subroutine test_cos</span>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="c">!!</span>
<a id="ln-245" name="ln-245" href="#ln-245"></a><span class="c">!!    end program M_test_suite_M_intrinsics</span>
<a id="ln-246" name="ln-246" href="#ln-246"></a><span class="c">!!</span>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="c">!! The output now looks like this (note if no calls to unit\_test</span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="c">!! routines are made between unit_test_start(3f) and unit_test_end(3f)</span>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="c">!! the procedure gets an &quot;UNTESTED&quot; entry to remind you to make</span>
<a id="ln-250" name="ln-250" href="#ln-250"></a><span class="c">!! some tests ..).</span>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="c">!!</span>
<a id="ln-252" name="ln-252" href="#ln-252"></a><span class="c">!!    &gt; test:       sqrt   SUCCESS : check table of values</span>
<a id="ln-253" name="ln-253" href="#ln-253"></a><span class="c">!!    &gt; test:       sqrt   SUCCESS : got 5.0000000000000000 expected 5.0000000000000000</span>
<a id="ln-254" name="ln-254" href="#ln-254"></a><span class="c">!!    &gt; test_end:   sqrt   PASSED  : GOOD:        2 BAD:        0 DURATION:00000000012000:</span>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="c">!!    &gt; test_end:   cos    UNTESTED: GOOD:        0 BAD:        0 DURATION:00000000000000:</span>
<a id="ln-256" name="ln-256" href="#ln-256"></a><span class="c">!!    &gt; test_end:   sin    UNTESTED: GOOD:        0 BAD:        0 DURATION:00000000000000:</span>
<a id="ln-257" name="ln-257" href="#ln-257"></a><span class="c">!!    &gt; test_stop:  TALLY  PASSED  : GOOD:        2 BAD:        0 DURATION:00000000000000</span>
<a id="ln-258" name="ln-258" href="#ln-258"></a><span class="c">!!    &gt; STOP 0</span>
<a id="ln-259" name="ln-259" href="#ln-259"></a><span class="c">!!</span>
<a id="ln-260" name="ln-260" href="#ln-260"></a><span class="c">!! this is a model that works particularly well for basic numeric procedures.</span>
<a id="ln-261" name="ln-261" href="#ln-261"></a><span class="c">!!</span>
<a id="ln-262" name="ln-262" href="#ln-262"></a><span class="c">!! Now it is just a matter of adding more calls to unit\_test(3f). This is</span>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="c">!! where procedures from the other modules become useful, as they provide</span>
<a id="ln-264" name="ln-264" href="#ln-264"></a><span class="c">!! methods for comparing float values, for example. Since Fortran has</span>
<a id="ln-265" name="ln-265" href="#ln-265"></a><span class="c">!! many powerful masking intrinsics usually just the unit\_test(3f) procedure</span>
<a id="ln-266" name="ln-266" href="#ln-266"></a><span class="c">!! is required. In particular, be familiar with the ALL(3f), ANY(3f),</span>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="c">!! and PACK(3f) procedures.</span>
<a id="ln-268" name="ln-268" href="#ln-268"></a><span class="c">!!</span>
<a id="ln-269" name="ln-269" href="#ln-269"></a><span class="c">!! There are options to call a system command and use the initial string as</span>
<a id="ln-270" name="ln-270" href="#ln-270"></a><span class="c">!! options, to interactively pause after each check, and to change options</span>
<a id="ln-271" name="ln-271" href="#ln-271"></a><span class="c">!! like which output file to write on, what error level to use, and other</span>
<a id="ln-272" name="ln-272" href="#ln-272"></a><span class="c">!! things I will hopefully solidify and document here.</span>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="c">!!</span>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="c">!!    RECOMMENDED BASIC USAGE</span>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="c">!!</span>
<a id="ln-276" name="ln-276" href="#ln-276"></a><span class="c">!! So for an fpm(1) user a recommended process is to create and/or enter the</span>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="c">!! test/ directory and use the &quot;unit\_test&quot; program. It will make a test</span>
<a id="ln-278" name="ln-278" href="#ln-278"></a><span class="c">!! program called &quot;unit\_test\_$NAME.f90&quot; for each name given on the command</span>
<a id="ln-279" name="ln-279" href="#ln-279"></a><span class="c">!! line.</span>
<a id="ln-280" name="ln-280" href="#ln-280"></a><span class="c">!!</span>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="c">!! There is a case made for closely related groups of procedures to share</span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="c">!! a single test file that will be made a little bit later. For that, the</span>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="c">!! command &quot;test\_suite&quot; is used instead of &quot;unit\_test&quot;.</span>
<a id="ln-284" name="ln-284" href="#ln-284"></a><span class="c">!!</span>
<a id="ln-285" name="ln-285" href="#ln-285"></a><span class="c">!! For now lets assume we have or plan to have the procedures</span>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="c">!! &quot;a&quot;,&quot;b&quot;, and &quot;c&quot; in our package, and that we want to create a test for</span>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="c">!! each ( and that unit\_test(1) has been installed in your path):</span>
<a id="ln-288" name="ln-288" href="#ln-288"></a><span class="c">!!</span>
<a id="ln-289" name="ln-289" href="#ln-289"></a><span class="c">!!     cd $TOP_OF_FPM_PACKAGE</span>
<a id="ln-290" name="ln-290" href="#ln-290"></a><span class="c">!!     cd test</span>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="c">!!     unit_test a b c</span>
<a id="ln-292" name="ln-292" href="#ln-292"></a><span class="c">!!</span>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="c">!! If you then run &quot;fpm test&quot; the skeleton should run indicating the</span>
<a id="ln-294" name="ln-294" href="#ln-294"></a><span class="c">!! procedures are not tested. Change the routines to actually call the</span>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="c">!! &quot;unit\_test&quot; procedure and you have the beginnings of a unit test for</span>
<a id="ln-296" name="ln-296" href="#ln-296"></a><span class="c">!! your procedures.</span>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="c">!!</span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="c">!! The &quot;unit\_test(3f)&quot; procedure in its simplest form takes a string that</span>
<a id="ln-299" name="ln-299" href="#ln-299"></a><span class="c">!! is usually the procedure name and a logical expression, along with up</span>
<a id="ln-300" name="ln-300" href="#ln-300"></a><span class="c">!! to twenty completely optional intrinsic scalar values which will be used</span>
<a id="ln-301" name="ln-301" href="#ln-301"></a><span class="c">!! to create an optional message.</span>
<a id="ln-302" name="ln-302" href="#ln-302"></a><span class="c">!!</span>
<a id="ln-303" name="ln-303" href="#ln-303"></a><span class="c">!! The example programs also contain a placeholder call to unit\_test\_mode(3f).</span>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="c">!!</span>
<a id="ln-305" name="ln-305" href="#ln-305"></a><span class="c">!!    PROCEDURAL AND COMMAND LINE MODE OPTIONS</span>
<a id="ln-306" name="ln-306" href="#ln-306"></a><span class="c">!! The dummy skeleton routines all start with a call to unix\_test\_mode(3f).</span>
<a id="ln-307" name="ln-307" href="#ln-307"></a><span class="c">!! Its documentation describes a few default modes you can change with the</span>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="c">!! routine. Essentially the same options are available on the command line</span>
<a id="ln-309" name="ln-309" href="#ln-309"></a><span class="c">!! of the test program(s) as well.</span>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="c">!!</span>
<a id="ln-311" name="ln-311" href="#ln-311"></a><span class="c">!!     # options may be specified in NAMELIST input format with no</span>
<a id="ln-312" name="ln-312" href="#ln-312"></a><span class="c">!!     # extraneous spaces on the command line</span>
<a id="ln-313" name="ln-313" href="#ln-313"></a><span class="c">!!     fpm test -- flags=100,200,300 keep_going=T</span>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="c">!!     # a little more Unix-like or MSWindows-like syntax is allowed, as</span>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="c">!!     # these are equivalent to the original command ...</span>
<a id="ln-316" name="ln-316" href="#ln-316"></a><span class="c">!!     fpm test -- --flags=100,200,300 --keep_going</span>
<a id="ln-317" name="ln-317" href="#ln-317"></a><span class="c">!!     fpm test -- /flags=100,200,300 /keep_going=T</span>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="c">!!</span>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="c">!! M_framework(3f) uses a built-in command line parser instead of</span>
<a id="ln-320" name="ln-320" href="#ln-320"></a><span class="c">!! packages like M\_CLI or M\_CLI2 to minimize the number of dependencies</span>
<a id="ln-321" name="ln-321" href="#ln-321"></a><span class="c">!! required.</span>
<a id="ln-322" name="ln-322" href="#ln-322"></a><span class="c">!!</span>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="c">!!    SUGGEST ONE TEST PER PROGRAM</span>
<a id="ln-324" name="ln-324" href="#ln-324"></a><span class="c">!!</span>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="c">!! There are advantages to each procedure being tested with a separate</span>
<a id="ln-326" name="ln-326" href="#ln-326"></a><span class="c">!! program.</span>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="c">!!</span>
<a id="ln-328" name="ln-328" href="#ln-328"></a><span class="c">!! A large number of individual test programs works well with fpm(1).</span>
<a id="ln-329" name="ln-329" href="#ln-329"></a><span class="c">!! fpm defaults to running all the tests, but can execute subgroups</span>
<a id="ln-330" name="ln-330" href="#ln-330"></a><span class="c">!! easily because it can execute a list of tests and the names can</span>
<a id="ln-331" name="ln-331" href="#ln-331"></a><span class="c">!! use simple globbing.</span>
<a id="ln-332" name="ln-332" href="#ln-332"></a><span class="c">!!</span>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="c">!! If you autogenerate a list of procedure names to test and call the</span>
<a id="ln-334" name="ln-334" href="#ln-334"></a><span class="c">!! sample program &quot;unit_test&quot; with the names of the procedures it will</span>
<a id="ln-335" name="ln-335" href="#ln-335"></a><span class="c">!! generate new names but skip existing files; allowing for a simple form</span>
<a id="ln-336" name="ln-336" href="#ln-336"></a><span class="c">!! of auto-generation assuming you have a way of listing all the procedure</span>
<a id="ln-337" name="ln-337" href="#ln-337"></a><span class="c">!! names to test.</span>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="c">!!</span>
<a id="ln-339" name="ln-339" href="#ln-339"></a><span class="c">!! individual procedure tests can be deleted or added or moved easily when</span>
<a id="ln-340" name="ln-340" href="#ln-340"></a><span class="c">!! each is in its own file.</span>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="c">!!</span>
<a id="ln-342" name="ln-342" href="#ln-342"></a><span class="c">!! It is easier to test with debuggers and other tools like gdb and valgrind</span>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="c">!! on small units.</span>
<a id="ln-344" name="ln-344" href="#ln-344"></a><span class="c">!!</span>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="c">!! This is true with other tools that you can use with --runner as well.</span>
<a id="ln-346" name="ln-346" href="#ln-346"></a><span class="c">!! See &quot;fpm help runner&quot; or &quot;fpm manual \&gt;manual.txt&quot; for more information.</span>
<a id="ln-347" name="ln-347" href="#ln-347"></a><span class="c">!!</span>
<a id="ln-348" name="ln-348" href="#ln-348"></a><span class="c">!!     TESTING MANY PROCEDURES IN A SINGLE FILE</span>
<a id="ln-349" name="ln-349" href="#ln-349"></a><span class="c">!!</span>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="c">!! If it is preferred, one program can test multiple procedures. The</span>
<a id="ln-351" name="ln-351" href="#ln-351"></a><span class="c">!! main disadvantage is that the complete test suite is always run unless</span>
<a id="ln-352" name="ln-352" href="#ln-352"></a><span class="c">!! conditional coding is added. One of the uses of the unit\_test\_flags(:)</span>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="c">!! array is to allow integer values to be passed at execution time that</span>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="c">!! can be tested to provide such conditional testing. When many tests are</span>
<a id="ln-355" name="ln-355" href="#ln-355"></a><span class="c">!! in one file the unit_test_start(3f) procedure includes a &quot;matched&quot; argument</span>
<a id="ln-356" name="ln-356" href="#ln-356"></a><span class="c">!! which can detect if a simple globbing expression that can be given on the</span>
<a id="ln-357" name="ln-357" href="#ln-357"></a><span class="c">!! command line matches the string composed of the test name and message.</span>
<a id="ln-358" name="ln-358" href="#ln-358"></a><span class="c">!! This allows you to optionally select specific groups of tests from a set.</span>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="c">!!</span>
<a id="ln-360" name="ln-360" href="#ln-360"></a><span class="c">!!##UNIQUE FEATURES</span>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="c">!!</span>
<a id="ln-362" name="ln-362" href="#ln-362"></a><span class="c">!!    CALLING AN EXTERNAL PROGRAM</span>
<a id="ln-363" name="ln-363" href="#ln-363"></a><span class="c">!!</span>
<a id="ln-364" name="ln-364" href="#ln-364"></a><span class="c">!! A unique feature of the M\_framework(3f) test harness is a hook to call</span>
<a id="ln-365" name="ln-365" href="#ln-365"></a><span class="c">!! a custom program. You can ignore it is there, but it is a very powerful</span>
<a id="ln-366" name="ln-366" href="#ln-366"></a><span class="c">!! feature if you want to do bookkeeping on the test results or enter</span>
<a id="ln-367" name="ln-367" href="#ln-367"></a><span class="c">!! the results into a tracking tool. This allows you a way to sent alerts</span>
<a id="ln-368" name="ln-368" href="#ln-368"></a><span class="c">!! if something fails in automated tests, to create spreadsheets with the</span>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="c">!! test results, to retain results in a database or SQLite3 file, or make</span>
<a id="ln-370" name="ln-370" href="#ln-370"></a><span class="c">!! a custom tool to convert the data to something else like TAP (Test Anywhere</span>
<a id="ln-371" name="ln-371" href="#ln-371"></a><span class="c">!! Protocol) reports.</span>
<a id="ln-372" name="ln-372" href="#ln-372"></a><span class="c">!!</span>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="c">!! An example program called &quot;bookkeeper&quot; is included that shows how to</span>
<a id="ln-374" name="ln-374" href="#ln-374"></a><span class="c">!! parse the information passed to the program that generates several files:</span>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="c">!!</span>
<a id="ln-376" name="ln-376" href="#ln-376"></a><span class="c">!!    + bookkeeper.csv</span>
<a id="ln-377" name="ln-377" href="#ln-377"></a><span class="c">!!    + bookkeeper.html</span>
<a id="ln-378" name="ln-378" href="#ln-378"></a><span class="c">!!    + bookkeeper.nml</span>
<a id="ln-379" name="ln-379" href="#ln-379"></a><span class="c">!!    + bookkeeper\_clicks.csv</span>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="c">!!</span>
<a id="ln-381" name="ln-381" href="#ln-381"></a><span class="c">!! To use the defaults you simply enter</span>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="c">!!</span>
<a id="ln-383" name="ln-383" href="#ln-383"></a><span class="c">!!     fpm test -- command=bookkeeper</span>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="c">!!</span>
<a id="ln-385" name="ln-385" href="#ln-385"></a><span class="c">!! The CSV files can typically be read directly into a spreadsheet program.</span>
<a id="ln-386" name="ln-386" href="#ln-386"></a><span class="c">!!</span>
<a id="ln-387" name="ln-387" href="#ln-387"></a><span class="c">!! They can also be read using the SQLite3 tool. This is very powerful,</span>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="c">!! letting you use SQL to select specific data, generate reports, and</span>
<a id="ln-389" name="ln-389" href="#ln-389"></a><span class="c">!! convert the subsequent results to HTML, CSV, flat text and other formats.</span>
<a id="ln-390" name="ln-390" href="#ln-390"></a><span class="c">!!</span>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="c">!! The NAMELIST output file is essentially a record of the harness calls</span>
<a id="ln-392" name="ln-392" href="#ln-392"></a><span class="c">!! using the standardized NAMELIST format that is almost trivial to read</span>
<a id="ln-393" name="ln-393" href="#ln-393"></a><span class="c">!! in with a custom Fortran program. This might be considered a metafile</span>
<a id="ln-394" name="ln-394" href="#ln-394"></a><span class="c">!! format for a test run. You can replay the data and do whatever you want</span>
<a id="ln-395" name="ln-395" href="#ln-395"></a><span class="c">!! with it including generating alternate output file types; plotting</span>
<a id="ln-396" name="ln-396" href="#ln-396"></a><span class="c">!! timing data and so on.</span>
<a id="ln-397" name="ln-397" href="#ln-397"></a><span class="c">!!</span>
<a id="ln-398" name="ln-398" href="#ln-398"></a><span class="c">!! The HTML file is handy for importing into word processors or viewing</span>
<a id="ln-399" name="ln-399" href="#ln-399"></a><span class="c">!! via browsers. Example output files from an fpm(1) package that uses</span>
<a id="ln-400" name="ln-400" href="#ln-400"></a><span class="c">!! M_framemaker illustrate the different types of output that can be</span>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="c">!! generated.</span>
<a id="ln-402" name="ln-402" href="#ln-402"></a><span class="c">!!  + [CSV](https://urbanjost.github.io/M_framework/bookkeeper.csv).</span>
<a id="ln-403" name="ln-403" href="#ln-403"></a><span class="c">!!    Generally. comma-separated files can be read directly into spreadsheet</span>
<a id="ln-404" name="ln-404" href="#ln-404"></a><span class="c">!!    programs, sqlite3, and several common databases.</span>
<a id="ln-405" name="ln-405" href="#ln-405"></a><span class="c">!!  + [CSV runtimes](https://urbanjost.github.io/M_framework/bookkeeper_clicks.csv)</span>
<a id="ln-406" name="ln-406" href="#ln-406"></a><span class="c">!!    Another CSV file that is a record of the runtimes between a</span>
<a id="ln-407" name="ln-407" href="#ln-407"></a><span class="c">!!    unit test start and end.</span>
<a id="ln-408" name="ln-408" href="#ln-408"></a><span class="c">!!  + [HTML](https://urbanjost.github.io/M_framework/bookkeeper.html)</span>
<a id="ln-409" name="ln-409" href="#ln-409"></a><span class="c">!!    An example of a formatted report that can be displayed in a browser.</span>
<a id="ln-410" name="ln-410" href="#ln-410"></a><span class="c">!!  + [NAMELIST](https://urbanjost.github.io/M_framework/bookkeeper.nml).</span>
<a id="ln-411" name="ln-411" href="#ln-411"></a><span class="c">!!    Essentially this is a metafile that records the unit test calls.</span>
<a id="ln-412" name="ln-412" href="#ln-412"></a><span class="c">!!    It is very easy for a custom Fortran program to read back a NAMELIST</span>
<a id="ln-413" name="ln-413" href="#ln-413"></a><span class="c">!!    file and generate custom outputs instead of modifying bookkeeper(1).</span>
<a id="ln-414" name="ln-414" href="#ln-414"></a><span class="c">!!</span>
<a id="ln-415" name="ln-415" href="#ln-415"></a><span class="c">!! The bookkeeper(1) program is an example program that is expected to</span>
<a id="ln-416" name="ln-416" href="#ln-416"></a><span class="c">!! be customized. It provides for parsing the parameters passed to a</span>
<a id="ln-417" name="ln-417" href="#ln-417"></a><span class="c">!! M_framemaker external program.</span>
<a id="ln-418" name="ln-418" href="#ln-418"></a><span class="c">!!</span>
<a id="ln-419" name="ln-419" href="#ln-419"></a><span class="c">!!     IMPORTING INTO SQLLITE3</span>
<a id="ln-420" name="ln-420" href="#ln-420"></a><span class="c">!! Here is an example SQLite3 Tool input file that if placed in &quot;test.sql&quot;</span>
<a id="ln-421" name="ln-421" href="#ln-421"></a><span class="c">!! can be run with</span>
<a id="ln-422" name="ln-422" href="#ln-422"></a><span class="c">!!</span>
<a id="ln-423" name="ln-423" href="#ln-423"></a><span class="c">!!      sqlite3 -batch -init test.sql bookkeeper.db .quit</span>
<a id="ln-424" name="ln-424" href="#ln-424"></a><span class="c">!!</span>
<a id="ln-425" name="ln-425" href="#ln-425"></a><span class="c">!! if you have sqlite3(1) installed.</span>
<a id="ln-426" name="ln-426" href="#ln-426"></a><span class="c">!!</span>
<a id="ln-427" name="ln-427" href="#ln-427"></a><span class="c">!!    .mode csv</span>
<a id="ln-428" name="ln-428" href="#ln-428"></a><span class="c">!!    .import bookkeeper.csv unit_test</span>
<a id="ln-429" name="ln-429" href="#ln-429"></a><span class="c">!!    .schema unit_test</span>
<a id="ln-430" name="ln-430" href="#ln-430"></a><span class="c">!!    ---</span>
<a id="ln-431" name="ln-431" href="#ln-431"></a><span class="c">!!    --- show all data to show it worked</span>
<a id="ln-432" name="ln-432" href="#ln-432"></a><span class="c">!!    SELECT * FROM unit_test;</span>
<a id="ln-433" name="ln-433" href="#ln-433"></a><span class="c">!!    ---</span>
<a id="ln-434" name="ln-434" href="#ln-434"></a><span class="c">!!    --- example lists unique names</span>
<a id="ln-435" name="ln-435" href="#ln-435"></a><span class="c">!!    SELECT name FROM unit_test GROUP BY name ORDER BY name ;</span>
<a id="ln-436" name="ln-436" href="#ln-436"></a><span class="c">!!    ---</span>
<a id="ln-437" name="ln-437" href="#ln-437"></a><span class="c">!!    --- tally up passed, failed, skipped in a text table</span>
<a id="ln-438" name="ln-438" href="#ln-438"></a><span class="c">!!    .header on</span>
<a id="ln-439" name="ln-439" href="#ln-439"></a><span class="c">!!    .mode column unit_test</span>
<a id="ln-440" name="ln-440" href="#ln-440"></a><span class="c">!!    .width 64 9 9 9</span>
<a id="ln-441" name="ln-441" href="#ln-441"></a><span class="c">!!    SELECT name,</span>
<a id="ln-442" name="ln-442" href="#ln-442"></a><span class="c">!!    --- depending on SQL version a simpler IIF/IF, IFNULL, or TOTAL might be better but this works well</span>
<a id="ln-443" name="ln-443" href="#ln-443"></a><span class="c">!!    --- and is relatively &quot;standard&quot; as much as something like a standard is actually adhered to in</span>
<a id="ln-444" name="ln-444" href="#ln-444"></a><span class="c">!!    --- SQL-land.</span>
<a id="ln-445" name="ln-445" href="#ln-445"></a><span class="c">!!    CASE  sum( passed == &#39;passed&#39;  ) WHEN NULL THEN 0 ELSE sum ( passed == &#39;passed&#39;)  END  AS &#39;ok&#39;,</span>
<a id="ln-446" name="ln-446" href="#ln-446"></a><span class="c">!!    CASE  sum( passed == &#39;failed&#39;  ) WHEN NULL THEN 0 ELSE sum ( passed == &#39;failed&#39;)  END  AS &#39;not ok&#39;,</span>
<a id="ln-447" name="ln-447" href="#ln-447"></a><span class="c">!!    CASE  sum( passed == &#39;skipped&#39; ) WHEN NULL THEN 0 ELSE sum ( passed == &#39;skipped&#39;) END  AS &#39;skip&#39;</span>
<a id="ln-448" name="ln-448" href="#ln-448"></a><span class="c">!!    FROM unit_test</span>
<a id="ln-449" name="ln-449" href="#ln-449"></a><span class="c">!!    --- WHERE condition</span>
<a id="ln-450" name="ln-450" href="#ln-450"></a><span class="c">!!    GROUP BY name</span>
<a id="ln-451" name="ln-451" href="#ln-451"></a><span class="c">!!    ORDER BY name ;</span>
<a id="ln-452" name="ln-452" href="#ln-452"></a><span class="c">!!    ---</span>
<a id="ln-453" name="ln-453" href="#ln-453"></a><span class="c">!!    --- If the table already exists, the sqlite3 tool uses all the rows,</span>
<a id="ln-454" name="ln-454" href="#ln-454"></a><span class="c">!!    --- including the first row, in the CSV file as the actual data to import.</span>
<a id="ln-455" name="ln-455" href="#ln-455"></a><span class="c">!!    --- Therefore, you should delete the first row of the CSV file with the</span>
<a id="ln-456" name="ln-456" href="#ln-456"></a><span class="c">!!    --- header labels if adding to an existing table instead of creating</span>
<a id="ln-457" name="ln-457" href="#ln-457"></a><span class="c">!!    DROP TABLE IF EXISTS unit_test;</span>
<a id="ln-458" name="ln-458" href="#ln-458"></a><span class="c">!!    --- CREATE TABLE unit_test(</span>
<a id="ln-459" name="ln-459" href="#ln-459"></a><span class="c">!!    ---   name   TEXT NOT NULL,</span>
<a id="ln-460" name="ln-460" href="#ln-460"></a><span class="c">!!    ---   date   DATE NOT NULL,</span>
<a id="ln-461" name="ln-461" href="#ln-461"></a><span class="c">!!    ---   passed TEXT NOT NULL,</span>
<a id="ln-462" name="ln-462" href="#ln-462"></a><span class="c">!!    ---   msg    TEXT</span>
<a id="ln-463" name="ln-463" href="#ln-463"></a><span class="c">!!    --- );</span>
<a id="ln-464" name="ln-464" href="#ln-464"></a><span class="c">!!</span>
<a id="ln-465" name="ln-465" href="#ln-465"></a><span class="c">!! The last select generates a little tally table showing for all the runs</span>
<a id="ln-466" name="ln-466" href="#ln-466"></a><span class="c">!! in the input DataBaseFile the number of pass, fail, and skips of the test</span>
<a id="ln-467" name="ln-467" href="#ln-467"></a><span class="c">!! names. you could tally over a particular date range, only show failures,</span>
<a id="ln-468" name="ln-468" href="#ln-468"></a><span class="c">!! display the last test status, generating output in HTML or CSV or ...</span>
<a id="ln-469" name="ln-469" href="#ln-469"></a><span class="c">!! See the SQLite3 Tool documentation for sqlite3(3f) for more information.</span>
<a id="ln-470" name="ln-470" href="#ln-470"></a><span class="c">!!</span>
<a id="ln-471" name="ln-471" href="#ln-471"></a><span class="c">!!    name                                          ok         not ok     skip</span>
<a id="ln-472" name="ln-472" href="#ln-472"></a><span class="c">!!    --------------------------------------------  ---------  ---------  ---------</span>
<a id="ln-473" name="ln-473" href="#ln-473"></a><span class="c">!!    accdig                                        3          0          0</span>
<a id="ln-474" name="ln-474" href="#ln-474"></a><span class="c">!!    almost                                        24         0          0</span>
<a id="ln-475" name="ln-475" href="#ln-475"></a><span class="c">!!    flush_trail                                   0          0          3</span>
<a id="ln-476" name="ln-476" href="#ln-476"></a><span class="c">!!    in_margin                                     30         0          0</span>
<a id="ln-477" name="ln-477" href="#ln-477"></a><span class="c">!!    round                                         0          0          3</span>
<a id="ln-478" name="ln-478" href="#ln-478"></a><span class="c">!!    set_stdout_lun                                0          0          3</span>
<a id="ln-479" name="ln-479" href="#ln-479"></a><span class="c">!!    significant                                   15         1          2</span>
<a id="ln-480" name="ln-480" href="#ln-480"></a><span class="c">!!    unit_test                                     0          0          3</span>
<a id="ln-481" name="ln-481" href="#ln-481"></a><span class="c">!!    unit_test_bad                                 0          0          3</span>
<a id="ln-482" name="ln-482" href="#ln-482"></a><span class="c">!!    unit_test_end                                 0          0          3</span>
<a id="ln-483" name="ln-483" href="#ln-483"></a><span class="c">!!    unit_test_good                                0          0          3</span>
<a id="ln-484" name="ln-484" href="#ln-484"></a><span class="c">!!    unit_test_start                               0          0          6</span>
<a id="ln-485" name="ln-485" href="#ln-485"></a><span class="c">!!    unit_test_stop                                0          0          3</span>
<a id="ln-486" name="ln-486" href="#ln-486"></a><span class="c">!!    where_write_message_all                       0          0          3</span>
<a id="ln-487" name="ln-487" href="#ln-487"></a><span class="c">!!    write_message_only                            4          2          4</span>
<a id="ln-488" name="ln-488" href="#ln-488"></a><span class="c">!!</span>
<a id="ln-489" name="ln-489" href="#ln-489"></a><span class="c">!!##UNIQUE FEATURES</span>
<a id="ln-490" name="ln-490" href="#ln-490"></a><span class="c">!!</span>
<a id="ln-491" name="ln-491" href="#ln-491"></a><span class="c">!! fpm(1), gdb(1), and M\_framework(3f) work together</span>
<a id="ln-492" name="ln-492" href="#ln-492"></a><span class="c">!!</span>
<a id="ln-493" name="ln-493" href="#ln-493"></a><span class="c">!! It is easy to debug an individual test in a debugger. For example to run</span>
<a id="ln-494" name="ln-494" href="#ln-494"></a><span class="c">!! a test called &quot;crash&quot; with gdb(1) use</span>
<a id="ln-495" name="ln-495" href="#ln-495"></a><span class="c">!!</span>
<a id="ln-496" name="ln-496" href="#ln-496"></a><span class="c">!!      fpm test --target crash --runner &quot;gdb -ex run --quiet&quot;</span>
<a id="ln-497" name="ln-497" href="#ln-497"></a><span class="c">!!</span>
<a id="ln-498" name="ln-498" href="#ln-498"></a><span class="c">!! A more elaborate example passing arguments to M\_framework(3f) to change</span>
<a id="ln-499" name="ln-499" href="#ln-499"></a><span class="c">!! default behavior to for example write output to stdout instead of stderr</span>
<a id="ln-500" name="ln-500" href="#ln-500"></a><span class="c">!! and display compiler version and options and to run all the tests in</span>
<a id="ln-501" name="ln-501" href="#ln-501"></a><span class="c">!! the gdb(1) debugger (you can enter &quot;q&quot; after each test has run; or enter</span>
<a id="ln-502" name="ln-502" href="#ln-502"></a><span class="c">!! gdb commands at the prompt):</span>
<a id="ln-503" name="ln-503" href="#ln-503"></a><span class="c">!!</span>
<a id="ln-504" name="ln-504" href="#ln-504"></a><span class="c">!!     &gt; fpm test --target &#39;*&#39; --verbose \</span>
<a id="ln-505" name="ln-505" href="#ln-505"></a><span class="c">!!     &gt; --runner &#39;gdb -ex &quot;list, 0&quot; -ex run --quiet --args&#39; \</span>
<a id="ln-506" name="ln-506" href="#ln-506"></a><span class="c">!!     &gt; -- flags=9997,9998,9999 luns=6 level=3</span>
<a id="ln-507" name="ln-507" href="#ln-507"></a><span class="c">!!</span>
<a id="ln-508" name="ln-508" href="#ln-508"></a><span class="c">!! This is long enough that an alias or script would facilitate its use,</span>
<a id="ln-509" name="ln-509" href="#ln-509"></a><span class="c">!! with one changing it to use one&#39;s favorite options.</span>
<a id="ln-510" name="ln-510" href="#ln-510"></a><span class="c">!!</span>
<a id="ln-511" name="ln-511" href="#ln-511"></a><span class="c">!!    EASILY CALLED BY STANDARDIZED CD/CI SCRIPTS</span>
<a id="ln-512" name="ln-512" href="#ln-512"></a><span class="c">!!</span>
<a id="ln-513" name="ln-513" href="#ln-513"></a><span class="c">!! If a CD/CI github automated test script creates a Fortran</span>
<a id="ln-514" name="ln-514" href="#ln-514"></a><span class="c">!! environment including fpm and simply calls &quot;fpm test&quot; you can standardize</span>
<a id="ln-515" name="ln-515" href="#ln-515"></a><span class="c">!! your testing and use the same CD/CI scripts for any package. The testing</span>
<a id="ln-516" name="ln-516" href="#ln-516"></a><span class="c">!! framework is designed with just that scenario in mind.</span>
<a id="ln-517" name="ln-517" href="#ln-517"></a><span class="c">!!</span>
<a id="ln-518" name="ln-518" href="#ln-518"></a><span class="c">!! The .github subdirectory in M\_framework package contains examples of just</span>
<a id="ln-519" name="ln-519" href="#ln-519"></a><span class="c">!! such files that you can copy as-is into your fpm project. Activate test</span>
<a id="ln-520" name="ln-520" href="#ln-520"></a><span class="c">!! actions in your github repository after adding the .github directory and</span>
<a id="ln-521" name="ln-521" href="#ln-521"></a><span class="c">!! your package will be automatically tested on several different platforms</span>
<a id="ln-522" name="ln-522" href="#ln-522"></a><span class="c">!! by the scripts whenever a &quot;push&quot; to the repository occurs.</span>
<a id="ln-523" name="ln-523" href="#ln-523"></a><span class="c">!!</span>
<a id="ln-524" name="ln-524" href="#ln-524"></a><span class="c">!! ------------------------------------------------------------------------------------------</span>
<a id="ln-525" name="ln-525" href="#ln-525"></a><span class="c">!!</span>
<a id="ln-526" name="ln-526" href="#ln-526"></a><span class="c">!!##SUPPORTS FPM</span>
<a id="ln-527" name="ln-527" href="#ln-527"></a><span class="c">!!</span>
<a id="ln-528" name="ln-528" href="#ln-528"></a><span class="c">!! The impatient can try this, assuming git(1) and fpm(1) are installed.</span>
<a id="ln-529" name="ln-529" href="#ln-529"></a><span class="c">!!</span>
<a id="ln-530" name="ln-530" href="#ln-530"></a><span class="c">!! Download the github repository and build it with fpm(1)</span>
<a id="ln-531" name="ln-531" href="#ln-531"></a><span class="c">!! and create a test fpm(1) project:</span>
<a id="ln-532" name="ln-532" href="#ln-532"></a><span class="c">!!</span>
<a id="ln-533" name="ln-533" href="#ln-533"></a><span class="c">!!    #!/bin/bash</span>
<a id="ln-534" name="ln-534" href="#ln-534"></a><span class="c">!!    # first you need to install a few example programs</span>
<a id="ln-535" name="ln-535" href="#ln-535"></a><span class="c">!!    cd /tmp</span>
<a id="ln-536" name="ln-536" href="#ln-536"></a><span class="c">!!    git clone https://github.com/urbanjost/M_framework.git</span>
<a id="ln-537" name="ln-537" href="#ln-537"></a><span class="c">!!    cd M_framework</span>
<a id="ln-538" name="ln-538" href="#ln-538"></a><span class="c">!!    # install the &quot;unit_test&quot;, &quot;bookkeeper&quot;, and &quot;test_suite&quot;</span>
<a id="ln-539" name="ln-539" href="#ln-539"></a><span class="c">!!    # example programs; assuming the default install puts</span>
<a id="ln-540" name="ln-540" href="#ln-540"></a><span class="c">!!    # them in your path:</span>
<a id="ln-541" name="ln-541" href="#ln-541"></a><span class="c">!!    fpm install</span>
<a id="ln-542" name="ln-542" href="#ln-542"></a><span class="c">!!    # &quot;fpm help install&quot; describes how to customize where the</span>
<a id="ln-543" name="ln-543" href="#ln-543"></a><span class="c">!!    # programs are installed.</span>
<a id="ln-544" name="ln-544" href="#ln-544"></a><span class="c">!!    #</span>
<a id="ln-545" name="ln-545" href="#ln-545"></a><span class="c">!!    # go to your fpm package test/ directory.</span>
<a id="ln-546" name="ln-546" href="#ln-546"></a><span class="c">!!    # here, we will make one up</span>
<a id="ln-547" name="ln-547" href="#ln-547"></a><span class="c">!!    fpm new /tmp/tryit  # create test project</span>
<a id="ln-548" name="ln-548" href="#ln-548"></a><span class="c">!!    cd /tmp/tryit/test</span>
<a id="ln-549" name="ln-549" href="#ln-549"></a><span class="c">!!    # so lets say you plan on adding procedures &quot;a&quot;,&quot;b&quot;,and &quot;c&quot; to your src/tryit.f90</span>
<a id="ln-550" name="ln-550" href="#ln-550"></a><span class="c">!!    # project code. Set up individual skeleton tests for each procedure.</span>
<a id="ln-551" name="ln-551" href="#ln-551"></a><span class="c">!!    unit_test a b c                         # a file for each test</span>
<a id="ln-552" name="ln-552" href="#ln-552"></a><span class="c">!!    test_suite a b c &gt; test_suite_tryit.f90 # or a single file</span>
<a id="ln-553" name="ln-553" href="#ln-553"></a><span class="c">!!    cd ..  # go to the top of the project</span>
<a id="ln-554" name="ln-554" href="#ln-554"></a><span class="c">!!    # add M_framework to the developer dependencies</span>
<a id="ln-555" name="ln-555" href="#ln-555"></a><span class="c">!!    cat &gt;&gt; fpm.toml &lt;&lt;\EOF</span>
<a id="ln-556" name="ln-556" href="#ln-556"></a><span class="c">!!    [dev-dependencies]</span>
<a id="ln-557" name="ln-557" href="#ln-557"></a><span class="c">!!    M_framework    = { git = &quot;https://github.com/urbanjost/M_framework.git&quot; }</span>
<a id="ln-558" name="ln-558" href="#ln-558"></a><span class="c">!!    EOF</span>
<a id="ln-559" name="ln-559" href="#ln-559"></a><span class="c">!!    #</span>
<a id="ln-560" name="ln-560" href="#ln-560"></a><span class="c">!!    # test the package</span>
<a id="ln-561" name="ln-561" href="#ln-561"></a><span class="c">!!    fpm test</span>
<a id="ln-562" name="ln-562" href="#ln-562"></a><span class="c">!!    # if will say the procedures are untested. Put real calls</span>
<a id="ln-563" name="ln-563" href="#ln-563"></a><span class="c">!!    # in to unit_test(3f) and see how the default report</span>
<a id="ln-564" name="ln-564" href="#ln-564"></a><span class="c">!!    # changes</span>
<a id="ln-565" name="ln-565" href="#ln-565"></a><span class="c">!!    #</span>
<a id="ln-566" name="ln-566" href="#ln-566"></a><span class="c">!!    # so now to run the default tests is as simple as</span>
<a id="ln-567" name="ln-567" href="#ln-567"></a><span class="c">!!    fpm test</span>
<a id="ln-568" name="ln-568" href="#ln-568"></a><span class="c">!!    # run just one test</span>
<a id="ln-569" name="ln-569" href="#ln-569"></a><span class="c">!!    fpm test unit_test_a</span>
<a id="ln-570" name="ln-570" href="#ln-570"></a><span class="c">!!    # run tests using globbing; eg. all tests beginning with &quot;unit\_&quot;</span>
<a id="ln-571" name="ln-571" href="#ln-571"></a><span class="c">!!    fpm test &#39;unit_*&#39;</span>
<a id="ln-572" name="ln-572" href="#ln-572"></a><span class="c">!!    # display help on the interactive command options</span>
<a id="ln-573" name="ln-573" href="#ln-573"></a><span class="c">!!    fpm test -- --help</span>
<a id="ln-574" name="ln-574" href="#ln-574"></a><span class="c">!!</span>
<a id="ln-575" name="ln-575" href="#ln-575"></a><span class="c">!!    # you can pass parameters and/or change the unit_test_mode(3f)</span>
<a id="ln-576" name="ln-576" href="#ln-576"></a><span class="c">!!    # calls to change some of the test behavior</span>
<a id="ln-577" name="ln-577" href="#ln-577"></a><span class="c">!!</span>
<a id="ln-578" name="ln-578" href="#ln-578"></a><span class="c">!! So once you want to use this on your own projects, you would normally</span>
<a id="ln-579" name="ln-579" href="#ln-579"></a><span class="c">!! just add M\_framework(3f) as a developer dependency</span>
<a id="ln-580" name="ln-580" href="#ln-580"></a><span class="c">!! in your fpm.toml project file and start making tests that call M\_framework(3f).</span>
<a id="ln-581" name="ln-581" href="#ln-581"></a><span class="c">!!</span>
<a id="ln-582" name="ln-582" href="#ln-582"></a><span class="c">!! The optional programs demonstrated (&quot;unit\_test&quot;, &quot;test\_suite&quot;) are just simple</span>
<a id="ln-583" name="ln-583" href="#ln-583"></a><span class="c">!! stand-alone programs that make skeleton programs to run tests that you can</span>
<a id="ln-584" name="ln-584" href="#ln-584"></a><span class="c">!! customize (and rename too to avoid confusion).</span>
<a id="ln-585" name="ln-585" href="#ln-585"></a><span class="c">!!</span>
<a id="ln-586" name="ln-586" href="#ln-586"></a><span class="c">!!    # some useful things to try. Check out the man-pages for all the unit_test_*(3f)</span>
<a id="ln-587" name="ln-587" href="#ln-587"></a><span class="c">!!    # procedures.</span>
<a id="ln-588" name="ln-588" href="#ln-588"></a><span class="c">!!    # Then look at</span>
<a id="ln-589" name="ln-589" href="#ln-589"></a><span class="c">!!    unit_test --help</span>
<a id="ln-590" name="ln-590" href="#ln-590"></a><span class="c">!!    fpm test -- help</span>
<a id="ln-591" name="ln-591" href="#ln-591"></a><span class="c">!!    # run the demo bookkeeper script</span>
<a id="ln-592" name="ln-592" href="#ln-592"></a><span class="c">!!    fpm test -- command=bookkeeper</span>
<a id="ln-593" name="ln-593" href="#ln-593"></a><span class="c">!!    # and look at the bookkeeper*.* files in the top of the project</span>
<a id="ln-594" name="ln-594" href="#ln-594"></a><span class="c">!!</span>
<a id="ln-595" name="ln-595" href="#ln-595"></a><span class="c">!!##DOCUMENTATION</span>
<a id="ln-596" name="ln-596" href="#ln-596"></a><span class="c">!!</span>
<a id="ln-597" name="ln-597" href="#ln-597"></a><span class="c">!!   USER</span>
<a id="ln-598" name="ln-598" href="#ln-598"></a><span class="c">!!</span>
<a id="ln-599" name="ln-599" href="#ln-599"></a><span class="c">!!  - An [index](https://urbanjost.github.io/M_framework/man3.html) to HTML versions</span>
<a id="ln-600" name="ln-600" href="#ln-600"></a><span class="c">!!    of the manpages</span>
<a id="ln-601" name="ln-601" href="#ln-601"></a><span class="c">!!</span>
<a id="ln-602" name="ln-602" href="#ln-602"></a><span class="c">!!  - single pages that uses javascript to combine all the HTML descriptions</span>
<a id="ln-603" name="ln-603" href="#ln-603"></a><span class="c">!!    of the man-pages is at</span>
<a id="ln-604" name="ln-604" href="#ln-604"></a><span class="c">!!     + [BOOK_M_framework__verify](https://urbanjost.github.io/M_framework/BOOK_M_framework__verify.html)</span>
<a id="ln-605" name="ln-605" href="#ln-605"></a><span class="c">!!     + [BOOK_M_framework__approx](https://urbanjost.github.io/M_framework/BOOK_M_framework__approx.html)</span>
<a id="ln-606" name="ln-606" href="#ln-606"></a><span class="c">!!     + [BOOK_M_framework__journal](https://urbanjost.github.io/M_framework/BOOK_M_framework__journal.html)</span>
<a id="ln-607" name="ln-607" href="#ln-607"></a><span class="c">!!     + [BOOK_M_framework__msg](https://urbanjost.github.io/M_framework/BOOK_M_framework__msg.html)</span>
<a id="ln-608" name="ln-608" href="#ln-608"></a><span class="c">!!</span>
<a id="ln-609" name="ln-609" href="#ln-609"></a><span class="c">!!  - man-pages in</span>
<a id="ln-610" name="ln-610" href="#ln-610"></a><span class="c">!!     + [manpages.zip](https://urbanjost.github.io/M_framework/manpages.zip)</span>
<a id="ln-611" name="ln-611" href="#ln-611"></a><span class="c">!!     + [manpages.tgz](https://urbanjost.github.io/M_framework/manpages.tgz)</span>
<a id="ln-612" name="ln-612" href="#ln-612"></a><span class="c">!!</span>
<a id="ln-613" name="ln-613" href="#ln-613"></a><span class="c">!!    DEVELOPER</span>
<a id="ln-614" name="ln-614" href="#ln-614"></a><span class="c">!!    + [ford-generated developers&#39; document](https://urbanjost.github.io/M_framework/fpm-ford/index.html)</span>
<a id="ln-615" name="ln-615" href="#ln-615"></a><span class="c">!!    + [github action status](docs/STATUS.md)</span>
<a id="ln-616" name="ln-616" href="#ln-616"></a><span class="c">!!</span>
<a id="ln-617" name="ln-617" href="#ln-617"></a><span class="c">!!##ADDITIONAL DIRECTORY DESCRIPTIONS</span>
<a id="ln-618" name="ln-618" href="#ln-618"></a><span class="c">!!</span>
<a id="ln-619" name="ln-619" href="#ln-619"></a><span class="c">!!    - src/ is where the source for the M_framework(3f) module code resides</span>
<a id="ln-620" name="ln-620" href="#ln-620"></a><span class="c">!!    - docs/ contains HTML documentation and the manpage archives</span>
<a id="ln-621" name="ln-621" href="#ln-621"></a><span class="c">!!    - test/ contains simple test programs</span>
<a id="ln-622" name="ln-622" href="#ln-622"></a><span class="c">!!    - example/ has demos</span>
<a id="ln-623" name="ln-623" href="#ln-623"></a><span class="c">!!</span>
<a id="ln-624" name="ln-624" href="#ln-624"></a><span class="c">!!##REFERENCES</span>
<a id="ln-625" name="ln-625" href="#ln-625"></a><span class="c">!!  + See the .github directory in [easy](https://github.com/urbanjost/easy)</span>
<a id="ln-626" name="ln-626" href="#ln-626"></a><span class="c">!!  + for examples of CD/CI scripts that assume your package can be tested with an &quot;fpm test&quot; command.</span>
<a id="ln-627" name="ln-627" href="#ln-627"></a><span class="c">!!  + examples that use M_framework in github fpm packages:</span>
<a id="ln-628" name="ln-628" href="#ln-628"></a><span class="c">!!      * [M_strings](https://github.com/urbanjost/M_strings)</span>
<a id="ln-629" name="ln-629" href="#ln-629"></a><span class="c">!!      * [M_process](https://github.com/urbanjost/M_process)</span>
<a id="ln-630" name="ln-630" href="#ln-630"></a><span class="c">!!</span>
<a id="ln-631" name="ln-631" href="#ln-631"></a><span class="c">!!    These packages used a different reincarnation of the testing harness and are in the process of</span>
<a id="ln-632" name="ln-632" href="#ln-632"></a><span class="c">!!    being changed to use M_framework(3f) more appropriately, but still contain some useful examples.</span>
<a id="ln-633" name="ln-633" href="#ln-633"></a><span class="c">!!</span>
<a id="ln-634" name="ln-634" href="#ln-634"></a><span class="c">!!  + [Fortran Package Manager](https://github.com/fortran-lang/fpm)</span>
<a id="ln-635" name="ln-635" href="#ln-635"></a><span class="c">!!  + [fpm(1) registry](https://github.com/fortran-lang/fpm-registry)</span>
<a id="ln-636" name="ln-636" href="#ln-636"></a><span class="c">!!  + [Fortran Wiki: unit testing list](https://fortranwiki.org/fortran/show/Unit+testing+frameworks)</span>
<a id="ln-637" name="ln-637" href="#ln-637"></a><span class="c">!!  + [ford(1)](https://politicalphysicist.github.io/ford-fortran-documentation.html) for generating documentation for your projects</span>
<a id="ln-638" name="ln-638" href="#ln-638"></a><span class="c">!!</span>
<a id="ln-639" name="ln-639" href="#ln-639"></a><span class="c">!!    NOTE</span>
<a id="ln-640" name="ln-640" href="#ln-640"></a><span class="c">!! M_framework(3f) is subject to interface changes so the generally recommended</span>
<a id="ln-641" name="ln-641" href="#ln-641"></a><span class="c">!! practice of using a specific commit when using it an an external</span>
<a id="ln-642" name="ln-642" href="#ln-642"></a><span class="c">!! fpm(1) dependency is highly encouraged.</span>
<a id="ln-643" name="ln-643" href="#ln-643"></a><span class="c">!!</span>
<a id="ln-644" name="ln-644" href="#ln-644"></a><span class="c">!! Any feedback (features, performance, ease of use, ...) is appreciated,</span>
<a id="ln-645" name="ln-645" href="#ln-645"></a><span class="c">!! particularly in the ongoing development phase.</span>
<a id="ln-646" name="ln-646" href="#ln-646"></a><span class="c">!!</span>
<a id="ln-647" name="ln-647" href="#ln-647"></a><span class="c">!!</span>
<a id="ln-648" name="ln-648" href="#ln-648"></a><span class="c">!!##QUOTE</span>
<a id="ln-649" name="ln-649" href="#ln-649"></a><span class="c">!!    Do not let your victories go to your head, nor let your failures go</span>
<a id="ln-650" name="ln-650" href="#ln-650"></a><span class="c">!!    to your heart.</span>
<a id="ln-651" name="ln-651" href="#ln-651"></a><span class="c">!!</span>
<a id="ln-652" name="ln-652" href="#ln-652"></a><span class="c">!!##AUTHOR</span>
<a id="ln-653" name="ln-653" href="#ln-653"></a><span class="c">!!    John S. Urban</span>
<a id="ln-654" name="ln-654" href="#ln-654"></a><span class="c">!!##LICENSE</span>
<a id="ln-655" name="ln-655" href="#ln-655"></a><span class="c">!!    Public Domain</span>
<a id="ln-656" name="ln-656" href="#ln-656"></a><span class="c">!===================================================================================================================================</span>
<a id="ln-657" name="ln-657" href="#ln-657"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a id="ln-658" name="ln-658" href="#ln-658"></a><span class="c">!===================================================================================================================================</span>
<a id="ln-659" name="ln-659" href="#ln-659"></a><span class="k">end module </span><span class="n">M_framework</span><span class="w"></span>
</pre></div>

      </section>
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              M_framework
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-07-11 12:50 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>